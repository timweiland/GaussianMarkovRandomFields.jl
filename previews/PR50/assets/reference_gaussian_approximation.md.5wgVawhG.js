import{_ as l,C as p,c as h,o as r,aA as n,j as i,G as t,a as k,w as e}from"./chunks/framework.CPOtCi-X.js";const C=JSON.parse('{"title":"Gaussian Approximation","description":"","frontmatter":{},"headers":[],"relativePath":"reference/gaussian_approximation.md","filePath":"reference/gaussian_approximation.md","lastUpdated":null}'),o={name:"reference/gaussian_approximation.md"},d={class:"jldocstring custom-block",open:""};function g(E,s,c,y,u,m){const a=p("Badge");return r(),h("div",null,[s[6]||(s[6]=n(`<h1 id="Gaussian-Approximation" tabindex="-1">Gaussian Approximation <a class="header-anchor" href="#Gaussian-Approximation" aria-label="Permalink to &quot;Gaussian Approximation {#Gaussian-Approximation}&quot;">​</a></h1><p>When using non-Gaussian observation models (Poisson, Bernoulli, etc.) with GMRF priors, the posterior distribution p(x|y) is no longer Gaussian. Gaussian approximation finds the &quot;best&quot; Gaussian distribution that approximates this intractable posterior, enabling efficient inference using the full power of GMRF machinery.</p><p>The <code>gaussian_approximation</code> function constructs this approximation by finding the posterior mode and using the curvature at the mode to define a Gaussian with matching first and second moments. This unlocks fast sampling, marginal variance computation, and further conditioning operations.</p><h2 id="Conjugate-vs-Non-Conjugate-Cases" tabindex="-1">Conjugate vs Non-Conjugate Cases <a class="header-anchor" href="#Conjugate-vs-Non-Conjugate-Cases" aria-label="Permalink to &quot;Conjugate vs Non-Conjugate Cases {#Conjugate-vs-Non-Conjugate-Cases}&quot;">​</a></h2><p>The package automatically detects two fundamentally different cases:</p><p><strong>Conjugate Case (Exact)</strong>: Normal observations with identity link result in a Gaussian posterior that can be computed exactly using linear conditioning. No approximation is needed.</p><p><strong>Non-Conjugate Case (Approximate)</strong>: All other observation models require iterative optimization using Fisher scoring to find the mode and Hessian of the log-posterior.</p><h2 id="Basic-Usage-Pattern" tabindex="-1">Basic Usage Pattern <a class="header-anchor" href="#Basic-Usage-Pattern" aria-label="Permalink to &quot;Basic Usage Pattern {#Basic-Usage-Pattern}&quot;">​</a></h2><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Step 1: Set up prior GMRF</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">prior_gmrf </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> GMRF</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(μ_prior, Q_prior)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Step 2: Set up observation model and materialize likelihood</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">obs_model </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ExponentialFamily</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Poisson)  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># or Normal, Bernoulli, etc.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">obs_lik </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> obs_model</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(y_data; hyperparameters</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Step 3: Find Gaussian approximation to posterior</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">posterior_gmrf </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> gaussian_approximation</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(prior_gmrf, obs_lik)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Step 4: Use like any other GMRF</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sample </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> rand</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(posterior_gmrf)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">posterior_mean </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> mean</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(posterior_gmrf)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">marginal_stds </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> std</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(posterior_gmrf)</span></span></code></pre></div><h2 id="Examples" tabindex="-1">Examples <a class="header-anchor" href="#Examples" aria-label="Permalink to &quot;Examples {#Examples}&quot;">​</a></h2><h3 id="Conjugate-Case:-Normal-Observations" tabindex="-1">Conjugate Case: Normal Observations <a class="header-anchor" href="#Conjugate-Case:-Normal-Observations" aria-label="Permalink to &quot;Conjugate Case: Normal Observations {#Conjugate-Case:-Normal-Observations}&quot;">​</a></h3><p>For Normal observations with identity link, the posterior is exactly Gaussian:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> GaussianMarkovRandomFields, Distributions, LinearAlgebra</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Prior: zero mean, unit precision</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">n </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 10</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">prior_gmrf </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> GMRF</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">zeros</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(n), </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Diagonal</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ones</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(n)))</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Normal observations: y ~ N(x, σ²I) </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">obs_model </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ExponentialFamily</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Normal)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">y </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> randn</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(n)  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Some observed data</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">obs_lik </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> obs_model</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(y; σ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Exact posterior (no iteration needed!)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">posterior_gmrf </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> gaussian_approximation</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(prior_gmrf, obs_lik)</span></span></code></pre></div><p>This is mathematically equivalent to Bayesian linear regression and is computed exactly using the conjugate prior relationship.</p><h3 id="Non-Conjugate-Case:-Poisson-GLM" tabindex="-1">Non-Conjugate Case: Poisson GLM <a class="header-anchor" href="#Non-Conjugate-Case:-Poisson-GLM" aria-label="Permalink to &quot;Non-Conjugate Case: Poisson GLM {#Non-Conjugate-Case:-Poisson-GLM}&quot;">​</a></h3><p>For count data with log-link, we get an approximate Gaussian posterior:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Prior for log-intensities</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">prior_gmrf </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> GMRF</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">zeros</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(n), </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Diagonal</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ones</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(n)))</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Poisson observations: y ~ Poisson(exp(x))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">obs_model </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ExponentialFamily</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Poisson)  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Uses LogLink by default</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">y_counts </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">6</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Count data</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">obs_lik </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> obs_model</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(y_counts)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Approximate Gaussian posterior via Fisher scoring</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">posterior_gmrf </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> gaussian_approximation</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(prior_gmrf, obs_lik)</span></span></code></pre></div><p>The approximation quality depends on how &quot;Gaussian-like&quot; the true posterior is. For moderate counts and reasonable prior precision, the approximation is typically excellent.</p><h3 id="Design-Matrices:-Still-Conjugate" tabindex="-1">Design Matrices: Still Conjugate <a class="header-anchor" href="#Design-Matrices:-Still-Conjugate" aria-label="Permalink to &quot;Design Matrices: Still Conjugate {#Design-Matrices:-Still-Conjugate}&quot;">​</a></h3><p>Even with linear transformations, Normal observations remain conjugate:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># GLM-style design matrix: intercept + covariate</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">X </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2.1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 3.4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1.8</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 4.2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 4 obs, 2 coefficients</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">n_coef </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Prior on coefficients [β₀, β₁]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">prior_gmrf </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> GMRF</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">zeros</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(n_coef), </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Diagonal</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ones</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(n_coef)))</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Normal observations with design matrix</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">base_model </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ExponentialFamily</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Normal)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">obs_model </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> LinearlyTransformedObservationModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(base_model, X)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">y </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2.3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3.8</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4.5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Response data</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">obs_lik </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> obs_model</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(y; σ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Still exact! Uses linear conditioning internally</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">posterior_gmrf </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> gaussian_approximation</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(prior_gmrf, obs_lik)</span></span></code></pre></div><p>This covers standard GLM scenarios while maintaining computational efficiency.</p><h2 id="Performance-Notes" tabindex="-1">Performance Notes <a class="header-anchor" href="#Performance-Notes" aria-label="Permalink to &quot;Performance Notes {#Performance-Notes}&quot;">​</a></h2><p>The package includes significant performance optimizations:</p><ul><li><p><strong>Conjugate cases</strong> are detected automatically and use exact linear conditioning instead of iterative optimization, providing both speed and numerical accuracy benefits</p></li><li><p><strong>Non-conjugate cases</strong> use efficient Fisher scoring with good initial guesses from the prior mean</p></li><li><p><strong>MetaGMRF support</strong> preserves metadata through the approximation process</p></li><li><p><strong>Type consistency</strong> ensures optimal memory usage and dispatch efficiency</p></li></ul><h2 id="API-Reference" tabindex="-1">API Reference <a class="header-anchor" href="#API-Reference" aria-label="Permalink to &quot;API Reference {#API-Reference}&quot;">​</a></h2>`,26)),i("details",d,[i("summary",null,[s[0]||(s[0]=i("a",{id:"GaussianMarkovRandomFields.gaussian_approximation",href:"#GaussianMarkovRandomFields.gaussian_approximation"},[i("span",{class:"jlbinding"},"GaussianMarkovRandomFields.gaussian_approximation")],-1)),s[1]||(s[1]=k()),t(a,{type:"info",class:"jlObjectType jlFunction",text:"Function"})]),s[4]||(s[4]=n(`<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">gaussian_approximation</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(prior_gmrf, obs_lik) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> AbstractGMRF</span></span></code></pre></div><p>Find Gaussian approximation to the posterior using Fisher scoring.</p><p>This function finds the mode of the posterior distribution and constructs a Gaussian approximation around it using Fisher scoring (Newton-Raphson with Fisher information matrix).</p><p><strong>Arguments</strong></p><ul><li><p><code>prior_gmrf</code>: Prior GMRF distribution for the latent field</p></li><li><p><code>obs_lik</code>: Materialized observation likelihood (contains data and hyperparameters)</p></li></ul><p><strong>Returns</strong></p><ul><li><code>posterior_gmrf::GMRF</code>: Gaussian approximation to the posterior p(x | θ, y)</li></ul><p><strong>Example</strong></p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Set up components (done at higher level)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">prior_gmrf </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> GMRF</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(μ_prior, Q_prior)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">obs_model </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ExponentialFamily</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Poisson)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">obs_lik </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> obs_model</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(y)  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Materialized once</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Find Gaussian approximation - returns a GMRF</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">posterior_gmrf </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> gaussian_approximation</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(prior_gmrf, obs_lik)</span></span></code></pre></div>`,9)),t(a,{type:"info",class:"source-link",text:"source"},{default:e(()=>[...s[2]||(s[2]=[i("a",{href:"https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/34faa2ab20dc98963353d922ce8d160cb7adfcc9/src/arithmetic/condition/gaussian_approximation.jl#L20-L45",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1}),s[5]||(s[5]=n('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">gaussian_approximation</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(prior_constrained</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ConstrainedGMRF</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, obs_lik</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ObservationLikelihood</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; kwargs</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Find Gaussian approximation to the constrained posterior using Newton optimization with constraint projection.</p><p>Alternates between Newton/Fisher scoring steps and projecting onto the constraint manifold, which is mathematically equivalent to using Schur complements in the KKT approach for constrained Newton optimization.</p><p><strong>Arguments</strong></p><ul><li><p><code>prior_constrained::ConstrainedGMRF</code>: Prior constrained GMRF distribution</p></li><li><p><code>obs_lik::ObservationLikelihood</code>: Materialized observation likelihood</p></li></ul><p><strong>Keyword Arguments</strong></p><ul><li><p><code>max_iter::Int=50</code>: Maximum number of Newton iterations</p></li><li><p><code>mean_change_tol::Real=1e-4</code>: Convergence tolerance for mean change</p></li><li><p><code>newton_dec_tol::Real=1e-5</code>: Newton decrement convergence tolerance</p></li><li><p><code>verbose::Bool=false</code>: Print iteration information</p></li></ul><p><strong>Returns</strong></p><ul><li><code>posterior_constrained::ConstrainedGMRF</code>: Constrained Gaussian approximation to posterior</li></ul>',9)),t(a,{type:"info",class:"source-link",text:"source"},{default:e(()=>[...s[3]||(s[3]=[i("a",{href:"https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/34faa2ab20dc98963353d922ce8d160cb7adfcc9/src/arithmetic/condition/gaussian_approximation.jl#L152-L173",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})])])}const b=l(o,[["render",g]]);export{C as __pageData,b as default};
