import{_ as p,C as h,c as r,o as k,aA as t,j as i,G as e,a as n,w as l}from"./chunks/framework.C_CPL4_m.js";const x=JSON.parse('{"title":"Latent Models","description":"","frontmatter":{},"headers":[],"relativePath":"reference/latent_models.md","filePath":"reference/latent_models.md","lastUpdated":null}'),d={name:"reference/latent_models.md"},o={class:"jldocstring custom-block",open:""},g={class:"jldocstring custom-block",open:""},E={class:"jldocstring custom-block",open:""},c={class:"jldocstring custom-block",open:""},y={class:"jldocstring custom-block",open:""},m={class:"jldocstring custom-block",open:""},u={class:"jldocstring custom-block",open:""},F={class:"jldocstring custom-block",open:""},C={class:"jldocstring custom-block",open:""},b={class:"jldocstring custom-block",open:""},f={class:"jldocstring custom-block",open:""},A={class:"jldocstring custom-block",open:""},v={class:"jldocstring custom-block",open:""};function M(D,s,_,B,R,T){const a=h("Badge");return k(),r("div",null,[s[52]||(s[52]=t(`<h1 id="Latent-Models" tabindex="-1">Latent Models <a class="header-anchor" href="#Latent-Models" aria-label="Permalink to &quot;Latent Models {#Latent-Models}&quot;">​</a></h1><p>Latent models provide a structured way to define commonly used Gaussian Markov Random Fields (GMRFs) by specifying their key components: hyperparameters, precision matrices, mean vectors, and constraints. This abstraction enables easy construction and combination of standard models used in spatial statistics, time series analysis, and Bayesian modeling.</p><h2 id="Overview" tabindex="-1">Overview <a class="header-anchor" href="#Overview" aria-label="Permalink to &quot;Overview {#Overview}&quot;">​</a></h2><p>The <code>LatentModel</code> interface standardizes GMRF construction through a simple pattern:</p><ol><li><p><strong>Define the model structure</strong> (e.g., temporal, spatial, independence)</p></li><li><p><strong>Specify hyperparameters</strong> and their validation</p></li><li><p><strong>Construct GMRFs</strong> with automatic constraint handling</p></li></ol><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> GaussianMarkovRandomFields</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Define a temporal AR1 model</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ar1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> AR1Model</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">hyperparameters</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ar1)  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># (τ = Real, ρ = Real)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Construct GMRF with specific parameters</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">gmrf </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ar1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(τ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, ρ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.8</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Returns GMRF or ConstrainedGMRF automatically</span></span></code></pre></div><h2 id="LatentModel-Interface" tabindex="-1">LatentModel Interface <a class="header-anchor" href="#LatentModel-Interface" aria-label="Permalink to &quot;LatentModel Interface {#LatentModel-Interface}&quot;">​</a></h2>`,7)),i("details",o,[i("summary",null,[s[0]||(s[0]=i("a",{id:"GaussianMarkovRandomFields.LatentModel",href:"#GaussianMarkovRandomFields.LatentModel"},[i("span",{class:"jlbinding"},"GaussianMarkovRandomFields.LatentModel")],-1)),s[1]||(s[1]=n()),e(a,{type:"info",class:"jlObjectType jlType",text:"Type"})]),s[3]||(s[3]=t(`<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">LatentModel</span></span></code></pre></div><p>Abstract type for latent variable models that can be used to construct GMRFs.</p><p>A LatentModel provides a structured way to define commonly used GMRFs such as AR1, RW1, and other temporal/spatial models by specifying:</p><ol><li><p>The hyperparameters of the model</p></li><li><p>How to construct the precision matrix from hyperparameters</p></li><li><p>How to construct the mean vector from hyperparameters</p></li><li><p>Any linear constraints that should be applied</p></li></ol><p><strong>Interface</strong></p><p>Each concrete subtype must implement:</p><ul><li><p><code>length(model)</code>: Return the size/dimension of the latent process</p></li><li><p><code>hyperparameters(model)</code>: Return a NamedTuple describing the hyperparameters</p></li><li><p><code>precision_matrix(model; kwargs...)</code>: Construct precision matrix from hyperparameter values</p></li><li><p><code>mean(model; kwargs...)</code>: Construct mean vector from hyperparameter values</p></li><li><p><code>constraints(model; kwargs...)</code>: Return constraint information or <code>nothing</code></p></li><li><p><code>model_name(model)</code>: Return a Symbol representing the preferred name for this model type</p></li><li><p><code>(model)(; kwargs...)</code>: Instantiate a concrete GMRF from hyperparameter values</p></li></ul><p><strong>Usage</strong></p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Define a model</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">model </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> SomeLatentModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(n</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Get hyperparameter specification</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">params </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> hyperparameters</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(model)  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># e.g. (τ=Real, ρ=Real)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Instantiate GMRF with specific parameter values</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">gmrf </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> model</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(τ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, ρ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.8</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Returns GMRF or ConstrainedGMRF</span></span></code></pre></div>`,9)),e(a,{type:"info",class:"source-link",text:"source"},{default:l(()=>[...s[2]||(s[2]=[i("a",{href:"https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/883fe2db02bc3051529c3b308ea4b6eb50dfb6b7/src/latent_models/latent_model.jl#L3-L39",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),i("details",g,[i("summary",null,[s[4]||(s[4]=i("a",{id:"GaussianMarkovRandomFields.hyperparameters-Tuple{LatentModel}",href:"#GaussianMarkovRandomFields.hyperparameters-Tuple{LatentModel}"},[i("span",{class:"jlbinding"},"GaussianMarkovRandomFields.hyperparameters")],-1)),s[5]||(s[5]=n()),e(a,{type:"info",class:"jlObjectType jlMethod",text:"Method"})]),s[7]||(s[7]=t('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">hyperparameters</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(model</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">LatentModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Return a NamedTuple describing the hyperparameters and their types for the model.</p><p><strong>Returns</strong></p><p>A NamedTuple where keys are parameter names and values are their expected types.</p>',4)),e(a,{type:"info",class:"source-link",text:"source"},{default:l(()=>[...s[6]||(s[6]=[i("a",{href:"https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/883fe2db02bc3051529c3b308ea4b6eb50dfb6b7/src/latent_models/latent_model.jl#L54-L61",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),i("details",E,[i("summary",null,[s[8]||(s[8]=i("a",{id:"GaussianMarkovRandomFields.precision_matrix-Tuple{LatentModel}",href:"#GaussianMarkovRandomFields.precision_matrix-Tuple{LatentModel}"},[i("span",{class:"jlbinding"},"GaussianMarkovRandomFields.precision_matrix")],-1)),s[9]||(s[9]=n()),e(a,{type:"info",class:"jlObjectType jlMethod",text:"Method"})]),s[11]||(s[11]=t('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">precision_matrix</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(model</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">LatentModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; kwargs</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Construct the precision matrix for the model given hyperparameter values.</p><p><strong>Arguments</strong></p><ul><li><p><code>model</code>: The LatentModel instance</p></li><li><p><code>kwargs...</code>: Hyperparameter values as keyword arguments</p></li></ul><p><strong>Returns</strong></p><p>A precision matrix (AbstractMatrix or LinearMap) for use in GMRF construction.</p>',6)),e(a,{type:"info",class:"source-link",text:"source"},{default:l(()=>[...s[10]||(s[10]=[i("a",{href:"https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/883fe2db02bc3051529c3b308ea4b6eb50dfb6b7/src/latent_models/latent_model.jl#L66-L77",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),i("details",c,[i("summary",null,[s[12]||(s[12]=i("a",{id:"Statistics.mean",href:"#Statistics.mean"},[i("span",{class:"jlbinding"},"Statistics.mean")],-1)),s[13]||(s[13]=n()),e(a,{type:"info",class:"jlObjectType jlFunction",text:"Function"})]),s[15]||(s[15]=t('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">mean</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(model</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">LatentModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; kwargs</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Construct the mean vector for the model given hyperparameter values.</p><p><strong>Arguments</strong></p><ul><li><p><code>model</code>: The LatentModel instance</p></li><li><p><code>kwargs...</code>: Hyperparameter values as keyword arguments</p></li></ul><p><strong>Returns</strong></p><p>A mean vector (AbstractVector) for use in GMRF construction.</p>',6)),e(a,{type:"info",class:"source-link",text:"source"},{default:l(()=>[...s[14]||(s[14]=[i("a",{href:"https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/883fe2db02bc3051529c3b308ea4b6eb50dfb6b7/src/latent_models/latent_model.jl#L82-L93",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),i("details",y,[i("summary",null,[s[16]||(s[16]=i("a",{id:"GaussianMarkovRandomFields.constraints",href:"#GaussianMarkovRandomFields.constraints"},[i("span",{class:"jlbinding"},"GaussianMarkovRandomFields.constraints")],-1)),s[17]||(s[17]=n()),e(a,{type:"info",class:"jlObjectType jlFunction",text:"Function"})]),s[19]||(s[19]=t('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">constraints</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(model</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">LatentModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; kwargs</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Return constraint information for the model given hyperparameter values.</p><p><strong>Arguments</strong></p><ul><li><p><code>model</code>: The LatentModel instance</p></li><li><p><code>kwargs...</code>: Hyperparameter values as keyword arguments</p></li></ul><p><strong>Returns</strong></p><p>Either <code>nothing</code> if no constraints, or a tuple <code>(A, e)</code> where <code>A</code> is the constraint matrix and <code>e</code> is the constraint vector such that <code>Ax = e</code>.</p>',6)),e(a,{type:"info",class:"source-link",text:"source"},{default:l(()=>[...s[18]||(s[18]=[i("a",{href:"https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/883fe2db02bc3051529c3b308ea4b6eb50dfb6b7/src/latent_models/latent_model.jl#L98-L110",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),i("details",m,[i("summary",null,[s[20]||(s[20]=i("a",{id:"GaussianMarkovRandomFields.model_name",href:"#GaussianMarkovRandomFields.model_name"},[i("span",{class:"jlbinding"},"GaussianMarkovRandomFields.model_name")],-1)),s[21]||(s[21]=n()),e(a,{type:"info",class:"jlObjectType jlFunction",text:"Function"})]),s[23]||(s[23]=t('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">model_name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(model</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">LatentModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Return a Symbol representing the preferred name for this model type.</p><p>This name is used for parameter prefixing in CombinedModel to avoid conflicts. For example, if two models both have a τ parameter, they become τ_ar1, τ_besag, etc.</p><p><strong>Returns</strong></p><p>A Symbol that will be used as the suffix in parameter names.</p>',5)),e(a,{type:"info",class:"source-link",text:"source"},{default:l(()=>[...s[22]||(s[22]=[i("a",{href:"https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/883fe2db02bc3051529c3b308ea4b6eb50dfb6b7/src/latent_models/latent_model.jl#L115-L125",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),s[53]||(s[53]=i("h2",{id:"Available-Models",tabindex:"-1"},[n("Available Models "),i("a",{class:"header-anchor",href:"#Available-Models","aria-label":'Permalink to "Available Models {#Available-Models}"'},"​")],-1)),s[54]||(s[54]=i("h3",{id:"Temporal-Models",tabindex:"-1"},[n("Temporal Models "),i("a",{class:"header-anchor",href:"#Temporal-Models","aria-label":'Permalink to "Temporal Models {#Temporal-Models}"'},"​")],-1)),i("details",u,[i("summary",null,[s[24]||(s[24]=i("a",{id:"GaussianMarkovRandomFields.AR1Model",href:"#GaussianMarkovRandomFields.AR1Model"},[i("span",{class:"jlbinding"},"GaussianMarkovRandomFields.AR1Model")],-1)),s[25]||(s[25]=n()),e(a,{type:"info",class:"jlObjectType jlType",text:"Type"})]),s[27]||(s[27]=t(`<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">AR1Model</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(n</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>A first-order autoregressive (AR1) latent model for constructing AR1 GMRFs.</p><p>The AR1 model represents a temporal process where each observation depends on the previous observation with some correlation ρ and precision τ.</p><p><strong>Mathematical Description</strong></p><p>For n observations, the AR1 process has:</p><ul><li><p>Zero mean: μ = 0</p></li><li><p>Precision matrix Q with tridiagonal structure:</p><ul><li><p>Q[1,1] = τ</p></li><li><p>Q[i,i] = (1 + ρ²)τ for i = 2,...,n-1</p></li><li><p>Q[n,n] = τ</p></li><li><p>Q[i,i+1] = Q[i+1,i] = -ρτ for i = 1,...,n-1</p></li></ul></li></ul><p><strong>Hyperparameters</strong></p><ul><li><p><code>τ</code>: Precision parameter (τ &gt; 0)</p></li><li><p><code>ρ</code>: Correlation parameter (|ρ| &lt; 1)</p></li></ul><p><strong>Fields</strong></p><ul><li><code>n::Int</code>: Length of the AR1 process</li></ul><p><strong>Example</strong></p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">model </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> AR1Model</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">gmrf </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> model</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(τ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, ρ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.8</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Construct AR1 GMRF</span></span></code></pre></div>`,12)),e(a,{type:"info",class:"source-link",text:"source"},{default:l(()=>[...s[26]||(s[26]=[i("a",{href:"https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/883fe2db02bc3051529c3b308ea4b6eb50dfb6b7/src/latent_models/ar1.jl#L6-L36",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),i("details",F,[i("summary",null,[s[28]||(s[28]=i("a",{id:"GaussianMarkovRandomFields.RW1Model",href:"#GaussianMarkovRandomFields.RW1Model"},[i("span",{class:"jlbinding"},"GaussianMarkovRandomFields.RW1Model")],-1)),s[29]||(s[29]=n()),e(a,{type:"info",class:"jlObjectType jlType",text:"Type"})]),s[31]||(s[31]=t(`<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">RW1Model</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(n</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>A first-order random walk (RW1) latent model for constructing intrinsic GMRFs.</p><p>The RW1 model represents a non-stationary temporal process where each observation is the previous observation plus Gaussian noise. This creates a smooth trend model that&#39;s popular for temporal smoothing and time-varying effects.</p><p><strong>Mathematical Description</strong></p><p>The RW1 process defines increments: x[i+1] - x[i] ~ N(0, τ⁻¹) for i = 1,...,n-1. This leads to a singular precision matrix with the tridiagonal structure:</p><ul><li><p>Q[1,1] = 1, Q[n,n] = 1</p></li><li><p>Q[i,i] = 2 for i = 2,...,n-1</p></li><li><p>Q[i,i+1] = Q[i+1,i] = -1 for i = 1,...,n-1</p></li></ul><p>Since this matrix is singular (rank n-1), we handle it as an intrinsic GMRF by:</p><ol><li><p>Scaling by τ first, then adding small regularization (1e-5) to diagonal for numerical stability</p></li><li><p>Adding sum-to-zero constraint: sum(x) = 0</p></li></ol><p><strong>Hyperparameters</strong></p><ul><li><code>τ</code>: Precision parameter (τ &gt; 0)</li></ul><p><strong>Fields</strong></p><ul><li><p><code>n::Int</code>: Length of the RW1 process</p></li><li><p><code>regularization::Float64</code>: Small value added to diagonal after scaling (default 1e-5)</p></li></ul><p><strong>Example</strong></p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">model </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> RW1Model</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">gmrf </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> model</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(τ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Returns ConstrainedGMRF with sum-to-zero constraint</span></span></code></pre></div>`,14)),e(a,{type:"info",class:"source-link",text:"source"},{default:l(()=>[...s[30]||(s[30]=[i("a",{href:"https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/883fe2db02bc3051529c3b308ea4b6eb50dfb6b7/src/latent_models/rw1.jl#L6-L39",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),s[55]||(s[55]=i("h3",{id:"Spatial-Models",tabindex:"-1"},[n("Spatial Models "),i("a",{class:"header-anchor",href:"#Spatial-Models","aria-label":'Permalink to "Spatial Models {#Spatial-Models}"'},"​")],-1)),i("details",C,[i("summary",null,[s[32]||(s[32]=i("a",{id:"GaussianMarkovRandomFields.MaternModel",href:"#GaussianMarkovRandomFields.MaternModel"},[i("span",{class:"jlbinding"},"GaussianMarkovRandomFields.MaternModel")],-1)),s[33]||(s[33]=n()),e(a,{type:"info",class:"jlObjectType jlType",text:"Type"})]),s[35]||(s[35]=t(`<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">MaternModel{F&lt;:FEMDiscretization,S&lt;:Integer}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(discretization</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">F</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, smoothness</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">S</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>A Matérn latent model for constructing spatial GMRFs from discretized Matérn SPDEs.</p><p>The MaternModel provides a structured way to define Matérn Gaussian Markov Random Fields by discretizing the Matérn SPDE using finite element methods. The model stores the discretization and smoothness parameter, while the range parameter is provided at GMRF construction time.</p><p><strong>Mathematical Description</strong></p><p>The Matérn SPDE is given by: (κ² - Δ)^(α/2) u(x) = W(x), where α = ν + d/2</p><p>This leads to a Matérn covariance function with range and smoothness parameters.</p><p><strong>Two Construction Modes</strong></p><ol><li><p><strong>Direct construction</strong>: Pass a pre-built <code>FEMDiscretization</code></p></li><li><p><strong>Automatic construction</strong>: Pass points, automatically creates convex hull mesh</p></li></ol><p><strong>Hyperparameters</strong></p><ul><li><code>range</code>: Range parameter (range &gt; 0) - controls spatial correlation distance</li></ul><p><strong>Fields</strong></p><ul><li><p><code>discretization::F</code>: The finite element discretization</p></li><li><p><code>smoothness::S</code>: The smoothness parameter (Integer, controls differentiability)</p></li></ul><p><strong>Examples</strong></p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Direct construction</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">disc </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> FEMDiscretization</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(grid, interpolation, quadrature)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">model </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> MaternModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(disc; smoothness </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">gmrf </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> model</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(range</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Automatic construction from points</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">points </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.5</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># N×2 matrix</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">model </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> MaternModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(points; smoothness </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, element_order </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">gmrf </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> model</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(range</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div>`,14)),e(a,{type:"info",class:"source-link",text:"source"},{default:l(()=>[...s[34]||(s[34]=[i("a",{href:"https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/883fe2db02bc3051529c3b308ea4b6eb50dfb6b7/src/latent_models/matern.jl#L6-L47",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),i("details",b,[i("summary",null,[s[36]||(s[36]=i("a",{id:"GaussianMarkovRandomFields.BesagModel",href:"#GaussianMarkovRandomFields.BesagModel"},[i("span",{class:"jlbinding"},"GaussianMarkovRandomFields.BesagModel")],-1)),s[37]||(s[37]=n()),e(a,{type:"info",class:"jlObjectType jlType",text:"Type"})]),s[39]||(s[39]=t(`<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">BesagModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(adjacency</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">AbstractMatrix</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; regularization</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Float64</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1e-5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, normalize_var</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Bool</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, singleton_policy</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Symbol</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :gaussian</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>A Besag model for spatial latent effects on graphs using intrinsic Conditional Autoregressive (CAR) structure.</p><p>The Besag model represents spatial dependence where each node&#39;s precision depends on its graph neighbors. This creates a graph Laplacian precision structure that&#39;s widely used for spatial smoothing on irregular lattices.</p><p><strong>Mathematical Description</strong></p><p>For a graph with adjacency matrix W, the precision matrix follows:</p><ul><li><p>Q[i,j] = -τ if nodes i and j are neighbors (W[i,j] = 1)</p></li><li><p>Q[i,i] = τ * degree[i] where degree[i] = sum(W[i,:])</p></li><li><p>All other entries are 0</p></li></ul><p>Since this matrix is singular (rank n-1), we handle it as an intrinsic GMRF by:</p><ol><li><p>Scaling by τ first, then adding small regularization (1e-5) to diagonal for numerical stability</p></li><li><p>Adding sum-to-zero constraint: sum(x) = 0</p></li></ol><p><strong>Hyperparameters</strong></p><ul><li><code>τ</code>: Precision parameter (τ &gt; 0)</li></ul><p><strong>Fields</strong></p><ul><li><p><code>adjacency::M</code>: Adjacency matrix W (preserves input structure - sparse, SymTridiagonal, etc.)</p></li><li><p><code>regularization::Float64</code>: Small value added to diagonal after scaling (default 1e-5)</p></li></ul><p><strong>Example</strong></p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 4-node cycle graph - can use sparse, SymTridiagonal, or Matrix</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">W </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> sparse</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Bool[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">model </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> BesagModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(W)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">gmrf </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> model</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(τ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Returns ConstrainedGMRF with sum-to-zero constraint</span></span></code></pre></div>`,14)),e(a,{type:"info",class:"source-link",text:"source"},{default:l(()=>[...s[38]||(s[38]=[i("a",{href:"https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/883fe2db02bc3051529c3b308ea4b6eb50dfb6b7/src/latent_models/besag.jl#L8-L41",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),s[56]||(s[56]=i("h3",{id:"Independence-Models",tabindex:"-1"},[n("Independence Models "),i("a",{class:"header-anchor",href:"#Independence-Models","aria-label":'Permalink to "Independence Models {#Independence-Models}"'},"​")],-1)),i("details",f,[i("summary",null,[s[40]||(s[40]=i("a",{id:"GaussianMarkovRandomFields.IIDModel",href:"#GaussianMarkovRandomFields.IIDModel"},[i("span",{class:"jlbinding"},"GaussianMarkovRandomFields.IIDModel")],-1)),s[41]||(s[41]=n()),e(a,{type:"info",class:"jlObjectType jlType",text:"Type"})]),s[43]||(s[43]=t(`<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">IIDModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(n</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>An independent and identically distributed (IID) latent model for constructing simple diagonal GMRFs.</p><p>The IID model represents independent Gaussian random variables with identical precision τ. This is the simplest possible latent model, equivalent to a scaled identity precision matrix.</p><p><strong>Mathematical Description</strong></p><p>Each element is independent: x[i] ~ N(0, τ⁻¹) for i = 1,...,n. The precision matrix is simply: Q = τ * I(n)</p><p>This model is useful for:</p><ul><li><p>Modeling independent effects or noise</p></li><li><p>Baseline comparisons with structured models</p></li><li><p>Teaching/demonstration purposes</p></li></ul><p><strong>Hyperparameters</strong></p><ul><li><code>τ</code>: Precision parameter (τ &gt; 0)</li></ul><p><strong>Fields</strong></p><ul><li><code>n::Int</code>: Length of the IID process</li></ul><p><strong>Example</strong></p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">model </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> IIDModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">gmrf </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> model</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(τ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Returns GMRF with precision 2.0 * I(100)</span></span></code></pre></div>`,13)),e(a,{type:"info",class:"source-link",text:"source"},{default:l(()=>[...s[42]||(s[42]=[i("a",{href:"https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/883fe2db02bc3051529c3b308ea4b6eb50dfb6b7/src/latent_models/iid.jl#L6-L35",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),i("details",A,[i("summary",null,[s[44]||(s[44]=i("a",{id:"GaussianMarkovRandomFields.FixedEffectsModel",href:"#GaussianMarkovRandomFields.FixedEffectsModel"},[i("span",{class:"jlbinding"},"GaussianMarkovRandomFields.FixedEffectsModel")],-1)),s[45]||(s[45]=n()),e(a,{type:"info",class:"jlObjectType jlType",text:"Type"})]),s[47]||(s[47]=t('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">FixedEffectsModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(n</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; λ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Real</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1e-6</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Weakly regularized fixed-effects latent component.</p><p>Encodes standard GLM-style fixed effects inside the latent vector with a small ridge precision <code>λ * I(n)</code>.</p><ul><li><p>No hyperparameters (returns <code>NamedTuple()</code>)</p></li><li><p>No constraints</p></li><li><p>Name: <code>:fixed</code> (used for parameter prefixing in <code>CombinedModel</code>)</p></li></ul>',4)),e(a,{type:"info",class:"source-link",text:"source"},{default:l(()=>[...s[46]||(s[46]=[i("a",{href:"https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/883fe2db02bc3051529c3b308ea4b6eb50dfb6b7/src/latent_models/fixed_effects.jl#L5-L16",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),s[57]||(s[57]=i("h3",{id:"Model-Composition",tabindex:"-1"},[n("Model Composition "),i("a",{class:"header-anchor",href:"#Model-Composition","aria-label":'Permalink to "Model Composition {#Model-Composition}"'},"​")],-1)),i("details",v,[i("summary",null,[s[48]||(s[48]=i("a",{id:"GaussianMarkovRandomFields.CombinedModel",href:"#GaussianMarkovRandomFields.CombinedModel"},[i("span",{class:"jlbinding"},"GaussianMarkovRandomFields.CombinedModel")],-1)),s[49]||(s[49]=n()),e(a,{type:"info",class:"jlObjectType jlType",text:"Type"})]),s[51]||(s[51]=t(`<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">CombinedModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(components</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Vector{&lt;:LatentModel}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>A combination of multiple LatentModel instances into a single block-structured GMRF.</p><p>This enables modeling with multiple latent components, such as the popular BYM model (Besag-York-Mollié) which combines spatial (Besag) and independent (IID) effects.</p><p><strong>Mathematical Description</strong></p><p>Given k component models with sizes n₁, n₂, ..., nₖ:</p><ul><li><p>Combined precision matrix: Q = blockdiag(Q₁, Q₂, ..., Qₖ)</p></li><li><p>Combined mean vector: μ = vcat(μ₁, μ₂, ..., μₖ)</p></li><li><p>Combined constraints: Block-diagonal constraint structure preserving individual constraints</p></li></ul><p><strong>Parameter Naming</strong></p><p>To avoid conflicts when multiple models have the same hyperparameters (e.g., multiple τ), parameters are automatically prefixed with model names:</p><ul><li><p>Single occurrence: τ_besag, ρ_ar1</p></li><li><p>Multiple occurrences: τ_besag, τ_besag_2, τ_besag_3</p></li></ul><p><strong>Fields</strong></p><ul><li><p><code>components::Vector{&lt;:LatentModel}</code>: The individual latent models</p></li><li><p><code>component_sizes::Vector{Int}</code>: Cached sizes of each component</p></li><li><p><code>total_size::Int</code>: Total size of the combined model</p></li></ul><p><strong>Example - BYM Model</strong></p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># BYM model: spatial Besag + independent IID effects</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">W </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> sparse</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(adjacency_matrix)  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Spatial adjacency</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">besag </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> BesagModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(W)         </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Spatial component  </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">iid </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> IIDModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(n)            </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Independent component</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Vector constructor</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">bym </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> CombinedModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">([besag, iid])</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Or variadic constructor (syntactic sugar)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">bym </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> CombinedModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(besag, iid)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Usage with automatically prefixed parameters</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">gmrf </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> bym</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(τ_besag</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, τ_iid</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div>`,13)),e(a,{type:"info",class:"source-link",text:"source"},{default:l(()=>[...s[50]||(s[50]=[i("a",{href:"https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/883fe2db02bc3051529c3b308ea4b6eb50dfb6b7/src/latent_models/combined.jl#L6-L48",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),s[58]||(s[58]=t(`<h2 id="Usage-Examples" tabindex="-1">Usage Examples <a class="header-anchor" href="#Usage-Examples" aria-label="Permalink to &quot;Usage Examples {#Usage-Examples}&quot;">​</a></h2><h3 id="Basic-Model-Construction" tabindex="-1">Basic Model Construction <a class="header-anchor" href="#Basic-Model-Construction" aria-label="Permalink to &quot;Basic Model Construction {#Basic-Model-Construction}&quot;">​</a></h3><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Temporal AR1 process</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ar1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> AR1Model</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">gmrf </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ar1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(τ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, ρ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.8</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Spatial Matérn model from points</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">points </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.5</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># N×2 matrix</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">matern </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> MaternModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(points; smoothness </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">gmrf </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> matern</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(range</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Spatial Besag model</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">W </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sparse_adjacency_matrix</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">besag </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> BesagModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(W)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">gmrf </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> besag</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(τ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Returns ConstrainedGMRF with sum-to-zero constraint</span></span></code></pre></div><h3 id="Model-Composition-2" tabindex="-1">Model Composition <a class="header-anchor" href="#Model-Composition-2" aria-label="Permalink to &quot;Model Composition {#Model-Composition-2}&quot;">​</a></h3><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Classic BYM model: spatial + independent effects  </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">W </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> spatial_adjacency_matrix</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">bym </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> CombinedModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">BesagModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(W), </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">IIDModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(n))</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Check combined hyperparameters</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">hyperparameters</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(bym)  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># (τ_besag = Real, τ_iid = Real)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Construct combined GMRF</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">gmrf </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> bym</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(τ_besag</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, τ_iid</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Continuous spatial field + independent effects</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">points </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> generate_observation_points</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">spatial_matern </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> MaternModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(points; smoothness </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">independent_effects </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> IIDModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">length</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(points))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">combined </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> CombinedModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(spatial_matern, independent_effects)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">gmrf </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> combined</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(range</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, τ_iid</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><h3 id="Smart-Parameter-Naming" tabindex="-1">Smart Parameter Naming <a class="header-anchor" href="#Smart-Parameter-Naming" aria-label="Permalink to &quot;Smart Parameter Naming {#Smart-Parameter-Naming}&quot;">​</a></h3><p>CombinedModel automatically handles parameter naming conflicts:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Single occurrence: no suffix</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">CombinedModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">AR1Model</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">BesagModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(W))  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># τ_ar1, ρ_ar1, τ_besag</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Multiple occurrences: numbered suffixes  </span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">CombinedModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">IIDModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">IIDModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">IIDModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">15</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># τ_iid, τ_iid_2, τ_iid_3</span></span></code></pre></div><h3 id="Advanced-Compositions" tabindex="-1">Advanced Compositions <a class="header-anchor" href="#Advanced-Compositions" aria-label="Permalink to &quot;Advanced Compositions {#Advanced-Compositions}&quot;">​</a></h3><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Spatiotemporal model with three components</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">W </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> spatial_adjacency</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(n_regions)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">model </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> CombinedModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    BesagModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(W),           </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Spatial structure</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    RW1Model</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(n_time),        </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Temporal trend  </span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    IIDModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(n_regions </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> n_time)  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Independent effects</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">gmrf </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> model</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(τ_besag</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, τ_rw1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, τ_iid</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><h2 id="Key-Features" tabindex="-1">Key Features <a class="header-anchor" href="#Key-Features" aria-label="Permalink to &quot;Key Features {#Key-Features}&quot;">​</a></h2><h3 id="Automatic-Constraint-Handling" tabindex="-1">Automatic Constraint Handling <a class="header-anchor" href="#Automatic-Constraint-Handling" aria-label="Permalink to &quot;Automatic Constraint Handling {#Automatic-Constraint-Handling}&quot;">​</a></h3><p>Models automatically determine GMRF type based on constraints:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ar1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> AR1Model</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)     </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># No constraints → GMRF</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">rw1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> RW1Model</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)     </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Sum-to-zero constraint → ConstrainedGMRF</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">mixed </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> CombinedModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ar1, rw1)  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Inherits constraints → ConstrainedGMRF</span></span></code></pre></div><h3 id="Parameter-Validation" tabindex="-1">Parameter Validation <a class="header-anchor" href="#Parameter-Validation" aria-label="Permalink to &quot;Parameter Validation {#Parameter-Validation}&quot;">​</a></h3><p>All models include built-in parameter validation:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ar1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> AR1Model</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ar1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(τ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, ρ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.8</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)   </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ArgumentError: τ must be positive</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ar1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(τ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, ρ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)    </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ArgumentError: |ρ| must be &lt; 1</span></span></code></pre></div><h3 id="Efficient-Sparse-Operations" tabindex="-1">Efficient Sparse Operations <a class="header-anchor" href="#Efficient-Sparse-Operations" aria-label="Permalink to &quot;Efficient Sparse Operations {#Efficient-Sparse-Operations}&quot;">​</a></h3><ul><li><p>Block-diagonal precision matrices are always sparse</p></li><li><p>Input matrix structures (sparse, SymTridiagonal) are preserved</p></li><li><p>Minimal memory allocations through size caching</p></li></ul><h2 id="See-Also" tabindex="-1">See Also <a class="header-anchor" href="#See-Also" aria-label="Permalink to &quot;See Also {#See-Also}&quot;">​</a></h2><ul><li><p><a href="/GaussianMarkovRandomFields.jl/previews/PR51/reference/gmrfs#GaussianMarkovRandomFields.GMRF"><code>GMRF</code></a> and <a href="/GaussianMarkovRandomFields.jl/previews/PR51/reference/hard_constraints#GaussianMarkovRandomFields.ConstrainedGMRF"><code>ConstrainedGMRF</code></a> for the underlying GMRF types</p></li><li><p><a href="/GaussianMarkovRandomFields.jl/previews/PR51/reference/hard_constraints#Hard-Constraints">Hard Constraints</a> for constraint handling details</p></li><li><p><a href="/GaussianMarkovRandomFields.jl/previews/PR51/reference/observation_models#Observation-Models">Observation Models</a> for linking GMRFs to data</p></li></ul><h2 id="Formula-Terms" tabindex="-1">Formula Terms <a class="header-anchor" href="#Formula-Terms" aria-label="Permalink to &quot;Formula Terms {#Formula-Terms}&quot;">​</a></h2><p>Prefer writing models with formulas? The latent components discussed here can be constructed via formula terms and assembled automatically into a combined model and design matrix. See the Formula Interface reference for details:</p><ul><li><p><a href="/GaussianMarkovRandomFields.jl/previews/PR51/reference/formula#Formula-Interface">Formula Interface</a> — terms (<code>IID</code>, <code>RandomWalk</code>, <code>AR1</code>, <code>Besag</code>) and <code>build_formula_components</code>.</p></li><li><p>For a worked example combining Besag + IID + fixed effects under a Poisson likelihood with offset, see the tutorial: <a href="/GaussianMarkovRandomFields.jl/previews/PR51/tutorials/bym_scotland_lip_cancer#Advanced-GMRF-modelling-for-disease-mapping">Advanced GMRF modelling for disease mapping</a></p></li></ul>`,24))])}const G=p(d,[["render",M]]);export{x as __pageData,G as default};
