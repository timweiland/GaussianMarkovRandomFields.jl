<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Spatial Modelling with SPDEs | GMRFs.jl</title>
    <meta name="description" content="Documentation for GaussianMarkovRandomFields.jl">
    <meta name="generator" content="VitePress v1.6.4">
    <link rel="preload stylesheet" href="/GaussianMarkovRandomFields.jl/v0.9/assets/style.JtDf2VQ0.css" as="style">
    <link rel="preload stylesheet" href="/GaussianMarkovRandomFields.jl/v0.9/vp-icons.css" as="style">
    
    <script type="module" src="/GaussianMarkovRandomFields.jl/v0.9/assets/app.BszUBcEg.js"></script>
    <link rel="preload" href="/GaussianMarkovRandomFields.jl/v0.9/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/GaussianMarkovRandomFields.jl/v0.9/assets/chunks/theme.0PwisCM0.js">
    <link rel="modulepreload" href="/GaussianMarkovRandomFields.jl/v0.9/assets/chunks/framework.D1ZhhpGH.js">
    <link rel="modulepreload" href="/GaussianMarkovRandomFields.jl/v0.9/assets/tutorials_spatial_modelling_spdes.md.C6KEEXr9.lean.js">
    <script src="/GaussianMarkovRandomFields.jl/versions.js"></script>
    <script src="/GaussianMarkovRandomFields.jl/v0.9/siteinfo.js"></script>
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-a9a9e638><!--[--><!--]--><!--[--><span tabindex="-1" data-v-492508fc></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-492508fc>Skip to content</a><!--]--><!----><header class="VPNav" data-v-a9a9e638 data-v-f1e365da><div class="VPNavBar" data-v-f1e365da data-v-822684d1><div class="wrapper" data-v-822684d1><div class="container" data-v-822684d1><div class="title" data-v-822684d1><div class="VPNavBarTitle has-sidebar" data-v-822684d1 data-v-0f4f798b><a class="title" href="/GaussianMarkovRandomFields.jl/v0.9/" data-v-0f4f798b><!--[--><!--]--><!--[--><img class="VPImage logo" src="/GaussianMarkovRandomFields.jl/v0.9/logo.svg" width="24" height="24" alt data-v-35a7d0b8><!--]--><span data-v-0f4f798b>GMRFs.jl</span><!--[--><!--]--></a></div></div><div class="content" data-v-822684d1><div class="content-body" data-v-822684d1><!--[--><!--]--><div class="VPNavBarSearch search" data-v-822684d1><!--[--><!----><div id="local-search"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><span class="vp-icon DocSearch-Search-Icon"></span><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-822684d1 data-v-e6d46098><span id="main-nav-aria-label" class="visually-hidden" data-v-e6d46098> Main Navigation </span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/GaussianMarkovRandomFields.jl/v0.9/index" tabindex="0" data-v-e6d46098 data-v-956ec74c><!--[--><span data-v-956ec74c>Home</span><!--]--></a><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup active" data-v-e6d46098 data-v-04f5c5e9><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-04f5c5e9><span class="text" data-v-04f5c5e9><!----><span data-v-04f5c5e9>Tutorials</span><span class="vpi-chevron-down text-icon" data-v-04f5c5e9></span></span></button><div class="menu" data-v-04f5c5e9><div class="VPMenu" data-v-04f5c5e9 data-v-7dd3104a><div class="items" data-v-7dd3104a><!--[--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/GaussianMarkovRandomFields.jl/v0.9/tutorials/index" data-v-acbfed09><!--[--><span data-v-acbfed09>Overview</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/GaussianMarkovRandomFields.jl/v0.9/tutorials/autoregressive_models" data-v-acbfed09><!--[--><span data-v-acbfed09>Building autoregressive models</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link active" href="/GaussianMarkovRandomFields.jl/v0.9/tutorials/spatial_modelling_spdes" data-v-acbfed09><!--[--><span data-v-acbfed09>Spatial Modelling with SPDEs</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/GaussianMarkovRandomFields.jl/v0.9/tutorials/spatiotemporal_modelling" data-v-acbfed09><!--[--><span data-v-acbfed09>Spatiotemporal Modelling with SPDEs</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/GaussianMarkovRandomFields.jl/v0.9/tutorials/boundary_conditions" data-v-acbfed09><!--[--><span data-v-acbfed09>Boundary Conditions for SPDEs</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/GaussianMarkovRandomFields.jl/v0.9/tutorials/bernoulli_spatial_classification" data-v-acbfed09><!--[--><span data-v-acbfed09>Bernoulli Spatial Classification with a Matérn Field</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/GaussianMarkovRandomFields.jl/v0.9/tutorials/bym_scotland_lip_cancer" data-v-acbfed09><!--[--><span data-v-acbfed09>Advanced GMRF modelling for disease mapping</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/GaussianMarkovRandomFields.jl/v0.9/tutorials/kl_approximation" data-v-acbfed09><!--[--><span data-v-acbfed09>KL-minimizing Sparse GMRF Approximations to Gaussian Processes</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/GaussianMarkovRandomFields.jl/v0.9/tutorials/automatic_differentiation" data-v-acbfed09><!--[--><span data-v-acbfed09>Automatic Differentiation for GMRF Hyperparameters</span><!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-e6d46098 data-v-04f5c5e9><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-04f5c5e9><span class="text" data-v-04f5c5e9><!----><span data-v-04f5c5e9>API Reference</span><span class="vpi-chevron-down text-icon" data-v-04f5c5e9></span></span></button><div class="menu" data-v-04f5c5e9><div class="VPMenu" data-v-04f5c5e9 data-v-7dd3104a><div class="items" data-v-7dd3104a><!--[--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/GaussianMarkovRandomFields.jl/v0.9/reference/index" data-v-acbfed09><!--[--><span data-v-acbfed09>Overview</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/GaussianMarkovRandomFields.jl/v0.9/reference/gmrfs" data-v-acbfed09><!--[--><span data-v-acbfed09>GMRFs</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/GaussianMarkovRandomFields.jl/v0.9/reference/latent_models" data-v-acbfed09><!--[--><span data-v-acbfed09>Latent Models</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/GaussianMarkovRandomFields.jl/v0.9/reference/observation_models" data-v-acbfed09><!--[--><span data-v-acbfed09>Observation Models</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/GaussianMarkovRandomFields.jl/v0.9/reference/gaussian_approximation" data-v-acbfed09><!--[--><span data-v-acbfed09>Gaussian Approximation</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/GaussianMarkovRandomFields.jl/v0.9/reference/hard_constraints" data-v-acbfed09><!--[--><span data-v-acbfed09>Hard Constraints</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/GaussianMarkovRandomFields.jl/v0.9/reference/autodiff" data-v-acbfed09><!--[--><span data-v-acbfed09>Automatic Differentiation</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/GaussianMarkovRandomFields.jl/v0.9/reference/kl_approximation" data-v-acbfed09><!--[--><span data-v-acbfed09>KL Approximations</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/GaussianMarkovRandomFields.jl/v0.9/reference/spdes" data-v-acbfed09><!--[--><span data-v-acbfed09>SPDEs</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/GaussianMarkovRandomFields.jl/v0.9/reference/discretizations" data-v-acbfed09><!--[--><span data-v-acbfed09>Discretizations</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/GaussianMarkovRandomFields.jl/v0.9/reference/meshes" data-v-acbfed09><!--[--><span data-v-acbfed09>Meshes</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/GaussianMarkovRandomFields.jl/v0.9/reference/plotting" data-v-acbfed09><!--[--><span data-v-acbfed09>Plotting</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/GaussianMarkovRandomFields.jl/v0.9/reference/solvers" data-v-acbfed09><!--[--><span data-v-acbfed09>Solvers</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/GaussianMarkovRandomFields.jl/v0.9/reference/autoregressive" data-v-acbfed09><!--[--><span data-v-acbfed09>Autoregressive Models</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/GaussianMarkovRandomFields.jl/v0.9/reference/linear_maps" data-v-acbfed09><!--[--><span data-v-acbfed09>Linear maps</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/GaussianMarkovRandomFields.jl/v0.9/reference/preconditioners" data-v-acbfed09><!--[--><span data-v-acbfed09>Preconditioners</span><!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/GaussianMarkovRandomFields.jl/v0.9/bibliography" tabindex="0" data-v-e6d46098 data-v-956ec74c><!--[--><span data-v-956ec74c>Bibliography</span><!--]--></a><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-e6d46098 data-v-04f5c5e9><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-04f5c5e9><span class="text" data-v-04f5c5e9><!----><span data-v-04f5c5e9>Developer Documentation</span><span class="vpi-chevron-down text-icon" data-v-04f5c5e9></span></span></button><div class="menu" data-v-04f5c5e9><div class="VPMenu" data-v-04f5c5e9 data-v-7dd3104a><div class="items" data-v-7dd3104a><!--[--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/GaussianMarkovRandomFields.jl/v0.9/dev-docs/index" data-v-acbfed09><!--[--><span data-v-acbfed09>Overview</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/GaussianMarkovRandomFields.jl/v0.9/dev-docs/solvers" data-v-acbfed09><!--[--><span data-v-acbfed09>Solvers</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/GaussianMarkovRandomFields.jl/v0.9/dev-docs/spdes" data-v-acbfed09><!--[--><span data-v-acbfed09>SPDEs</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/GaussianMarkovRandomFields.jl/v0.9/dev-docs/discretizations" data-v-acbfed09><!--[--><span data-v-acbfed09>Discretizations</span><!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><!----><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-822684d1 data-v-af096f4a><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-af096f4a data-v-e40a8bb6 data-v-4a1c76db><span class="check" data-v-4a1c76db><span class="icon" data-v-4a1c76db><!--[--><span class="vpi-sun sun" data-v-e40a8bb6></span><span class="vpi-moon moon" data-v-e40a8bb6></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-822684d1 data-v-164c457f data-v-ee7a9424><!--[--><a class="VPSocialLink no-icon" href="https://github.com/timweiland/GaussianMarkovRandomFields.jl" aria-label="github" target="_blank" rel="noopener" data-v-ee7a9424 data-v-d26d30cb><span class="vpi-social-github"></span></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-822684d1 data-v-925effce data-v-04f5c5e9><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-04f5c5e9><span class="vpi-more-horizontal icon" data-v-04f5c5e9></span></button><div class="menu" data-v-04f5c5e9><div class="VPMenu" data-v-04f5c5e9 data-v-7dd3104a><!----><!--[--><!--[--><!----><div class="group" data-v-925effce><div class="item appearance" data-v-925effce><p class="label" data-v-925effce>Appearance</p><div class="appearance-action" data-v-925effce><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-925effce data-v-e40a8bb6 data-v-4a1c76db><span class="check" data-v-4a1c76db><span class="icon" data-v-4a1c76db><!--[--><span class="vpi-sun sun" data-v-e40a8bb6></span><span class="vpi-moon moon" data-v-e40a8bb6></span><!--]--></span></span></button></div></div></div><div class="group" data-v-925effce><div class="item social-links" data-v-925effce><div class="VPSocialLinks social-links-list" data-v-925effce data-v-ee7a9424><!--[--><a class="VPSocialLink no-icon" href="https://github.com/timweiland/GaussianMarkovRandomFields.jl" aria-label="github" target="_blank" rel="noopener" data-v-ee7a9424 data-v-d26d30cb><span class="vpi-social-github"></span></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--[--><!--[--><div class="VPFlyout VPNolebaseEnhancedReadabilitiesMenu VPNolebaseEnhancedReadabilitiesMenuFlyout" aria-label="Enhanced Readability" role="menuitem" data-v-04f5c5e9><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-04f5c5e9><span class="text" data-v-04f5c5e9><span class="i-icon-park-outline:book-open option-icon" data-v-04f5c5e9></span><!----><span class="vpi-chevron-down text-icon" data-v-04f5c5e9></span></span></button><div class="menu" data-v-04f5c5e9><div class="VPMenu" data-v-04f5c5e9 data-v-7dd3104a><!----><!--[--><!--]--></div></div></div><!--]--><!--]--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-822684d1 data-v-5dea55bf><span class="container" data-v-5dea55bf><span class="top" data-v-5dea55bf></span><span class="middle" data-v-5dea55bf></span><span class="bottom" data-v-5dea55bf></span></span></button></div></div></div></div><div class="divider" data-v-822684d1><div class="divider-line" data-v-822684d1></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-a9a9e638 data-v-070ab83d><div class="container" data-v-070ab83d><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-070ab83d><span class="vpi-align-left menu-icon" data-v-070ab83d></span><span class="menu-text" data-v-070ab83d>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-070ab83d data-v-168ddf5d><button data-v-168ddf5d>Return to top</button><!----></div></div></div><aside class="VPSidebar" data-v-a9a9e638 data-v-18756405><div class="curtain" data-v-18756405></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-18756405><span class="visually-hidden" id="sidebar-aria-label" data-v-18756405> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="no-transition group" data-v-9e426adc><section class="VPSidebarItem level-0" data-v-9e426adc data-v-a4b0d9bf><!----><div class="items" data-v-a4b0d9bf><!--[--><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/GaussianMarkovRandomFields.jl/v0.9/index" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Home</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-9e426adc><section class="VPSidebarItem level-0 collapsible has-active" data-v-9e426adc data-v-a4b0d9bf><div class="item" role="button" tabindex="0" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><h2 class="text" data-v-a4b0d9bf>Tutorials</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-a4b0d9bf><span class="vpi-chevron-right caret-icon" data-v-a4b0d9bf></span></div></div><div class="items" data-v-a4b0d9bf><!--[--><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/GaussianMarkovRandomFields.jl/v0.9/tutorials/index" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Overview</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/GaussianMarkovRandomFields.jl/v0.9/tutorials/autoregressive_models" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Building autoregressive models</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/GaussianMarkovRandomFields.jl/v0.9/tutorials/spatial_modelling_spdes" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Spatial Modelling with SPDEs</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/GaussianMarkovRandomFields.jl/v0.9/tutorials/spatiotemporal_modelling" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Spatiotemporal Modelling with SPDEs</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/GaussianMarkovRandomFields.jl/v0.9/tutorials/boundary_conditions" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Boundary Conditions for SPDEs</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/GaussianMarkovRandomFields.jl/v0.9/tutorials/bernoulli_spatial_classification" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Bernoulli Spatial Classification with a Matérn Field</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/GaussianMarkovRandomFields.jl/v0.9/tutorials/bym_scotland_lip_cancer" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Advanced GMRF modelling for disease mapping</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/GaussianMarkovRandomFields.jl/v0.9/tutorials/kl_approximation" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>KL-minimizing Sparse GMRF Approximations to Gaussian Processes</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/GaussianMarkovRandomFields.jl/v0.9/tutorials/automatic_differentiation" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Automatic Differentiation for GMRF Hyperparameters</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-9e426adc><section class="VPSidebarItem level-0 collapsible" data-v-9e426adc data-v-a4b0d9bf><div class="item" role="button" tabindex="0" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><h2 class="text" data-v-a4b0d9bf>API Reference</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-a4b0d9bf><span class="vpi-chevron-right caret-icon" data-v-a4b0d9bf></span></div></div><div class="items" data-v-a4b0d9bf><!--[--><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/GaussianMarkovRandomFields.jl/v0.9/reference/index" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Overview</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/GaussianMarkovRandomFields.jl/v0.9/reference/gmrfs" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>GMRFs</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/GaussianMarkovRandomFields.jl/v0.9/reference/latent_models" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Latent Models</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/GaussianMarkovRandomFields.jl/v0.9/reference/observation_models" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Observation Models</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/GaussianMarkovRandomFields.jl/v0.9/reference/gaussian_approximation" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Gaussian Approximation</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/GaussianMarkovRandomFields.jl/v0.9/reference/hard_constraints" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Hard Constraints</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/GaussianMarkovRandomFields.jl/v0.9/reference/autodiff" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Automatic Differentiation</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/GaussianMarkovRandomFields.jl/v0.9/reference/kl_approximation" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>KL Approximations</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/GaussianMarkovRandomFields.jl/v0.9/reference/spdes" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>SPDEs</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/GaussianMarkovRandomFields.jl/v0.9/reference/discretizations" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Discretizations</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/GaussianMarkovRandomFields.jl/v0.9/reference/meshes" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Meshes</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/GaussianMarkovRandomFields.jl/v0.9/reference/plotting" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Plotting</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/GaussianMarkovRandomFields.jl/v0.9/reference/solvers" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Solvers</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/GaussianMarkovRandomFields.jl/v0.9/reference/autoregressive" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Autoregressive Models</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/GaussianMarkovRandomFields.jl/v0.9/reference/linear_maps" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Linear maps</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/GaussianMarkovRandomFields.jl/v0.9/reference/preconditioners" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Preconditioners</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-9e426adc><section class="VPSidebarItem level-0" data-v-9e426adc data-v-a4b0d9bf><!----><div class="items" data-v-a4b0d9bf><!--[--><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/GaussianMarkovRandomFields.jl/v0.9/bibliography" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Bibliography</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-9e426adc><section class="VPSidebarItem level-0 collapsible" data-v-9e426adc data-v-a4b0d9bf><div class="item" role="button" tabindex="0" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><h2 class="text" data-v-a4b0d9bf>Developer Documentation</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-a4b0d9bf><span class="vpi-chevron-right caret-icon" data-v-a4b0d9bf></span></div></div><div class="items" data-v-a4b0d9bf><!--[--><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/GaussianMarkovRandomFields.jl/v0.9/dev-docs/index" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Overview</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/GaussianMarkovRandomFields.jl/v0.9/dev-docs/solvers" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Solvers</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/GaussianMarkovRandomFields.jl/v0.9/dev-docs/spdes" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>SPDEs</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/GaussianMarkovRandomFields.jl/v0.9/dev-docs/discretizations" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Discretizations</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-a9a9e638 data-v-91765379><div class="VPDoc has-sidebar has-aside" data-v-91765379 data-v-83890dd9><!--[--><!--]--><div class="container" data-v-83890dd9><div class="aside" data-v-83890dd9><div class="aside-curtain" data-v-83890dd9></div><div class="aside-container" data-v-83890dd9><div class="aside-content" data-v-83890dd9><div class="VPDocAside" data-v-83890dd9 data-v-6d7b3c46><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-6d7b3c46 data-v-b38bf2ff><div class="content" data-v-b38bf2ff><div class="outline-marker" data-v-b38bf2ff></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-b38bf2ff>On this page</div><ul class="VPDocOutlineItem root" data-v-b38bf2ff data-v-3f927ebe><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-6d7b3c46></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-83890dd9><div class="content-container" data-v-83890dd9><!--[--><!--]--><main class="main" data-v-83890dd9><div style="position:relative;" class="vp-doc _GaussianMarkovRandomFields_jl_v0_9_tutorials_spatial_modelling_spdes" data-v-83890dd9><div><h1 id="Spatial-Modelling-with-SPDEs" tabindex="-1">Spatial Modelling with SPDEs <a class="header-anchor" href="#Spatial-Modelling-with-SPDEs" aria-label="Permalink to &quot;Spatial Modelling with SPDEs {#Spatial-Modelling-with-SPDEs}&quot;">​</a></h1><h2 id="Data-preprocessing" tabindex="-1">Data preprocessing <a class="header-anchor" href="#Data-preprocessing" aria-label="Permalink to &quot;Data preprocessing {#Data-preprocessing}&quot;">​</a></h2><p>In the following, we are going to work with the <code>meuse</code> dataset. This dataset contains measurements of zinc concentrations in the soil near the Meuse river.</p><p>We begin by downloading the dataset.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">meuse_path </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> joinpath</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@__DIR__</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;meuse.csv&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">meuse_URL </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;https://gist.githubusercontent.com/essicolo/91a2666f7c5972a91bca763daecdc5ff/raw/056bda04114d55b793469b2ab0097ec01a6d66c6/meuse.csv&quot;</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">download</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(meuse_URL, meuse_path)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">&quot;/home/runner/work/GaussianMarkovRandomFields.jl/GaussianMarkovRandomFields.jl/docs/build/tutorials/meuse.csv&quot;</span></span></code></pre></div><p>We load the CSV file into a DataFrame and inspect the first few rows.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> CSV, DataFrames</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> DataFrame</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(CSV</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">File</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(meuse_path))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:x</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:y</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:zinc</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]]</span></span></code></pre></div><div><div><div style = "float: left;"><span>5×3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">x</th><th style = "text-align: left;">y</th><th style = "text-align: left;">zinc</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "Int64" style = "text-align: left;">Int64</th><th title = "Int64" style = "text-align: left;">Int64</th><th title = "Int64" style = "text-align: left;">Int64</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: right;">181072</td><td style = "text-align: right;">333611</td><td style = "text-align: right;">1022</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: right;">181025</td><td style = "text-align: right;">333558</td><td style = "text-align: right;">1141</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: right;">181165</td><td style = "text-align: right;">333537</td><td style = "text-align: right;">640</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: right;">181298</td><td style = "text-align: right;">333484</td><td style = "text-align: right;">257</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: right;">181307</td><td style = "text-align: right;">333330</td><td style = "text-align: right;">269</td></tr></tbody></table></div></div><p>Let us visualize the data. We plot the zinc concentrations as a function of the x and y coordinates.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Plots</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">x </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> convert</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Vector{Float64}, df[:, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:x</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">y </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> convert</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Vector{Float64}, df[:, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:y</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">zinc </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> df[:, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:zinc</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">scatter</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x, y, zcolor </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> zinc)</span></span></code></pre></div><p><img src="/GaussianMarkovRandomFields.jl/v0.9/assets/aplkavj.ChmwisPa.png" alt="" width="600px" height="400px"></p><p>Finally, in classic machine learning fashion, we split the data into a training and a test set. We use about 85% of the data for training and the remaining 15% for testing.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Random</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">train_idcs </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> randsubseq</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">size</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(df, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.85</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">test_idcs </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">size</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(df, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> isempty</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">searchsorted</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(train_idcs, i))]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">X </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [x y]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">X_train </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> X[train_idcs, :]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">X_test </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> X[test_idcs, :]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">y_train </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> zinc[train_idcs]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">y_test </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> zinc[test_idcs]</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">size</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(X_train, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">size</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(X_test, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">(133, 22)</span></span></code></pre></div><h2 id="Spatial-Modelling" tabindex="-1">Spatial Modelling <a class="header-anchor" href="#Spatial-Modelling" aria-label="Permalink to &quot;Spatial Modelling {#Spatial-Modelling}&quot;">​</a></h2><p>Matern Gaussian processes (GPs) are a powerful model class commonly used in geostatistics for such data. Unfortunately, without using any further tricks, GPs have a cubic runtime complexity. As the size of the dataset grows, this quickly becomes prohibitively expensive. In the tutorial on Autoregressive models, we learned that GMRFs enable highly efficient Gaussian inference through sparse precision matrices. Can we combine the modelling power of GPs with the efficiency of GMRFs?</p><p>Yes, we can: [<a href="/GaussianMarkovRandomFields.jl/v0.9/bibliography#Lindgren2011">1</a>] told us how. It turns out that Matern processes may equivalently be interpreted as solutions of certain stochastic partial differential equations (SPDEs). If we discretize this SPDE appropriately – for example using the finite element method (FEM) – we get a discrete GMRF approximation of a Matern process. The approximation quality improves as the resolution of the FEM mesh increases. If this all sounds overly complicated to you, fear not! GaussianMarkovRandomFields.jl takes care of the technical details for you, so you can focus on the modelling.</p><p>We create a Matern latent model directly from the spatial coordinates. Internally, GaussianMarkovRandomFields.jl computes a convex hull around the scattered data, generates a FEM mesh, and sets up the SPDE discretization automatically.</p><p>Once we have the latent model, we need to instantiate it for a concrete range parameter. This architecture makes it easy to construct the same GMRF structure many times for different hyperparameter values.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> GaussianMarkovRandomFields</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">latent_model </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> MaternModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(X; smoothness </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">u_matern </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> latent_model</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(range </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 400.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">GMRF{Float64} with 698 variables</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">  Algorithm: LinearSolve.CHOLMODFactorization{Nothing}</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">  Mean: [0.0, 0.0, 0.0, ..., 0.0, 0.0, 0.0]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">  Q_sqrt: not available</span></span></code></pre></div><p>Next, we create an observation model for function value observations at the training points. <code>PointEvaluationObsModel</code> expresses that we&#39;re observing the value of our latent field at some specified points. <code>Normal</code> could&#39;ve been replaced e.g. by <code>Poisson</code> to observe counts at the evaluation points instead – GLM style. As before, we need to pass hyperparameters to get a concrete object (an ObservationLikelihood). Once we have a concrete GMRF and a concrete observation likelihood, we can form a posterior through <code>gaussian_approximation</code>.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Distributions</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">obs_noise_std </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.32</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">obs_model </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> PointEvaluationObsModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(latent_model</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">discretization, X_train, Distributions</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Normal)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">obs_lik </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> obs_model</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(y_train; σ </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> obs_noise_std)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">u_cond </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> gaussian_approximation</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(u_matern, obs_lik)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">GMRF{Float64} with 698 variables</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">  Algorithm: LinearSolve.CHOLMODFactorization{Nothing}</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">  Mean: [71.32393142998112, 123.8416168633791, 59.101355204476306, ..., 23.845274997655906, 255.44322787994597, 249.92451384254616]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">  Q_sqrt: not available</span></span></code></pre></div><p>Next, we can evaluate the RMSE of the posterior mean on the test data. <code>conditional_distribution</code> gives us the predictive distribution p(y | x) for fixed <code>x</code>.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">obs_model_test </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> PointEvaluationObsModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(latent_model</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">discretization, X_test, Distributions</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Normal)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">pred_dist_train </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> conditional_distribution</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(obs_model, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">mean</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(u_cond); σ </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> obs_noise_std)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">pred_dist_test </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> conditional_distribution</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(obs_model_test, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">mean</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(u_cond); σ </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> obs_noise_std)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">rmse </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (a, b) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> sqrt</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">mean</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">((a </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> b) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.^</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">rmse</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">mean</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(pred_dist_train), y_train), </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">rmse</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">mean</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(pred_dist_test), y_test)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">(58.460710110073386, 295.66625672687906)</span></span></code></pre></div><p>We can also visualize the posterior mean and standard deviation. To this end, we write the corresponding vectors to a VTK file together with the grid data, which can then be visualized in e.g. Paraview.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Ferrite</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">VTKGridFile</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;meuse_mean&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, latent_model</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">discretization</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">dof_handler) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">do</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> vtk</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    write_solution</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(vtk, latent_model</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">discretization</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">dof_handler, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">mean</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(u_cond))</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Distributions</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">VTKGridFile</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;meuse_std&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, latent_model</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">discretization</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">dof_handler) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">do</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> vtk</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    write_solution</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(vtk, latent_model</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">discretization</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">dof_handler, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">std</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(u_cond))</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">VTKGridFile for the closed file &quot;meuse_std.vtu&quot;.</span></span></code></pre></div><p>In the end, our posterior mean looks like this: <img src="/GaussianMarkovRandomFields.jl/v0.9/assets/meuse_mean.BQcrDft2.png" alt=""></p><p>And the posterior standard deviation looks like this: <img src="/GaussianMarkovRandomFields.jl/v0.9/assets/meuse_std.BwhkQ6pp.png" alt=""></p><h2 id="Final-note" tabindex="-1">Final note <a class="header-anchor" href="#Final-note" aria-label="Permalink to &quot;Final note {#Final-note}&quot;">​</a></h2><p>We have seen how to combine the modelling power of GPs with the efficiency of GMRFs. This is a powerful combination that allows us to model spatial data efficiently and accurately. Note that these models are still sensitive to the choice of hyperparameters, i.e. the range and smoothness of the Matern process. So it&#39;s quite likely that you may find better hyperparameters than the ones used in this tutorial.</p><hr><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl" target="_blank" rel="noreferrer">Literate.jl</a>.</em></p></div></div></main><footer class="VPDocFooter" data-v-83890dd9 data-v-4f9813fa><!--[--><!--]--><div class="edit-info" data-v-4f9813fa><div class="edit-link" data-v-4f9813fa><a class="VPLink link vp-external-link-icon no-icon edit-link-button" href="https://github.com/timweiland/GaussianMarkovRandomFields.jl/edit/main/docs/src/tutorials/spatial_modelling_spdes.md" target="_blank" rel="noreferrer" data-v-4f9813fa><!--[--><span class="vpi-square-pen edit-link-icon" data-v-4f9813fa></span> Edit this page<!--]--></a></div><!----></div><nav class="prev-next" aria-labelledby="doc-footer-aria-label" data-v-4f9813fa><span class="visually-hidden" id="doc-footer-aria-label" data-v-4f9813fa>Pager</span><div class="pager" data-v-4f9813fa><a class="VPLink link pager-link prev" href="/GaussianMarkovRandomFields.jl/v0.9/tutorials/autoregressive_models" data-v-4f9813fa><!--[--><span class="desc" data-v-4f9813fa>Previous page</span><span class="title" data-v-4f9813fa>Building autoregressive models</span><!--]--></a></div><div class="pager" data-v-4f9813fa><a class="VPLink link pager-link next" href="/GaussianMarkovRandomFields.jl/v0.9/tutorials/spatiotemporal_modelling" data-v-4f9813fa><!--[--><span class="desc" data-v-4f9813fa>Next page</span><span class="title" data-v-4f9813fa>Spatiotemporal Modelling with SPDEs</span><!--]--></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><footer class="VPFooter has-sidebar" data-v-a9a9e638 data-v-c970a860><div class="container" data-v-c970a860><p class="message" data-v-c970a860>Made with <a href="https://luxdl.github.io/DocumenterVitepress.jl/dev/" target="_blank"><strong>DocumenterVitepress.jl</strong></a><br></p><p class="copyright" data-v-c970a860>© Copyright 2025.</p></div></footer><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"bibliography.md\":\"TEY9ytP5\",\"dev-docs_discretizations.md\":\"DTNGB-b7\",\"dev-docs_index.md\":\"QCO_HFfq\",\"dev-docs_solvers.md\":\"UoNhHJLG\",\"dev-docs_spdes.md\":\"DhDs2qTN\",\"index.md\":\"okipN_ip\",\"reference_autodiff.md\":\"D1X9AftR\",\"reference_autoregressive.md\":\"Bh0jjVb2\",\"reference_discretizations.md\":\"BHFLJkRM\",\"reference_formula.md\":\"1LDqfRo1\",\"reference_gaussian_approximation.md\":\"ck03Rmls\",\"reference_gmrfs.md\":\"kaUekAl9\",\"reference_hard_constraints.md\":\"HomkjKIf\",\"reference_index.md\":\"B0KFv-Tc\",\"reference_kl_approximation.md\":\"DCNpGz4y\",\"reference_latent_models.md\":\"D13QK7hg\",\"reference_linear_maps.md\":\"HHVz541F\",\"reference_meshes.md\":\"BN15ZjOh\",\"reference_observation_models.md\":\"Bs6CyE_a\",\"reference_plotting.md\":\"WsJOHFpN\",\"reference_preconditioners.md\":\"CVbpj-wV\",\"reference_solvers.md\":\"CHuAgap2\",\"reference_spatial_utils.md\":\"DlWYj15y\",\"reference_spdes.md\":\"DZ07UBWD\",\"tutorials_automatic_differentiation.md\":\"DosomHPK\",\"tutorials_autoregressive_models.md\":\"BSkFt6Ux\",\"tutorials_bernoulli_spatial_classification.md\":\"Ccy5Iwvy\",\"tutorials_boundary_conditions.md\":\"qkOnHZUu\",\"tutorials_bym_scotland_lip_cancer.md\":\"DIHO3yJA\",\"tutorials_index.md\":\"svXmZkbX\",\"tutorials_kl_approximation.md\":\"DL4EgXdL\",\"tutorials_spatial_modelling_spdes.md\":\"C6KEEXr9\",\"tutorials_spatiotemporal_modelling.md\":\"B7ecFdyA\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"GMRFs.jl\",\"description\":\"Documentation for GaussianMarkovRandomFields.jl\",\"base\":\"/GaussianMarkovRandomFields.jl/v0.9/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"outline\":\"deep\",\"logo\":{\"src\":\"/logo.svg\",\"width\":24,\"height\":24},\"search\":{\"provider\":\"local\",\"options\":{\"detailedView\":true}},\"nav\":[{\"text\":\"Home\",\"link\":\"/index\"},{\"text\":\"Tutorials\",\"collapsed\":false,\"items\":[{\"text\":\"Overview\",\"link\":\"/tutorials/index\"},{\"text\":\"Building autoregressive models\",\"link\":\"/tutorials/autoregressive_models\"},{\"text\":\"Spatial Modelling with SPDEs\",\"link\":\"/tutorials/spatial_modelling_spdes\"},{\"text\":\"Spatiotemporal Modelling with SPDEs\",\"link\":\"/tutorials/spatiotemporal_modelling\"},{\"text\":\"Boundary Conditions for SPDEs\",\"link\":\"/tutorials/boundary_conditions\"},{\"text\":\"Bernoulli Spatial Classification with a Matérn Field\",\"link\":\"/tutorials/bernoulli_spatial_classification\"},{\"text\":\"Advanced GMRF modelling for disease mapping\",\"link\":\"/tutorials/bym_scotland_lip_cancer\"},{\"text\":\"KL-minimizing Sparse GMRF Approximations to Gaussian Processes\",\"link\":\"/tutorials/kl_approximation\"},{\"text\":\"Automatic Differentiation for GMRF Hyperparameters\",\"link\":\"/tutorials/automatic_differentiation\"}]},{\"text\":\"API Reference\",\"collapsed\":false,\"items\":[{\"text\":\"Overview\",\"link\":\"/reference/index\"},{\"text\":\"GMRFs\",\"link\":\"/reference/gmrfs\"},{\"text\":\"Latent Models\",\"link\":\"/reference/latent_models\"},{\"text\":\"Observation Models\",\"link\":\"/reference/observation_models\"},{\"text\":\"Gaussian Approximation\",\"link\":\"/reference/gaussian_approximation\"},{\"text\":\"Hard Constraints\",\"link\":\"/reference/hard_constraints\"},{\"text\":\"Automatic Differentiation\",\"link\":\"/reference/autodiff\"},{\"text\":\"KL Approximations\",\"link\":\"/reference/kl_approximation\"},{\"text\":\"SPDEs\",\"link\":\"/reference/spdes\"},{\"text\":\"Discretizations\",\"link\":\"/reference/discretizations\"},{\"text\":\"Meshes\",\"link\":\"/reference/meshes\"},{\"text\":\"Plotting\",\"link\":\"/reference/plotting\"},{\"text\":\"Solvers\",\"link\":\"/reference/solvers\"},{\"text\":\"Autoregressive Models\",\"link\":\"/reference/autoregressive\"},{\"text\":\"Linear maps\",\"link\":\"/reference/linear_maps\"},{\"text\":\"Preconditioners\",\"link\":\"/reference/preconditioners\"}]},{\"text\":\"Bibliography\",\"link\":\"/bibliography\"},{\"text\":\"Developer Documentation\",\"collapsed\":false,\"items\":[{\"text\":\"Overview\",\"link\":\"/dev-docs/index\"},{\"text\":\"Solvers\",\"link\":\"/dev-docs/solvers\"},{\"text\":\"SPDEs\",\"link\":\"/dev-docs/spdes\"},{\"text\":\"Discretizations\",\"link\":\"/dev-docs/discretizations\"}]},{\"component\":\"VersionPicker\"}],\"sidebar\":[{\"text\":\"Home\",\"link\":\"/index\"},{\"text\":\"Tutorials\",\"collapsed\":false,\"items\":[{\"text\":\"Overview\",\"link\":\"/tutorials/index\"},{\"text\":\"Building autoregressive models\",\"link\":\"/tutorials/autoregressive_models\"},{\"text\":\"Spatial Modelling with SPDEs\",\"link\":\"/tutorials/spatial_modelling_spdes\"},{\"text\":\"Spatiotemporal Modelling with SPDEs\",\"link\":\"/tutorials/spatiotemporal_modelling\"},{\"text\":\"Boundary Conditions for SPDEs\",\"link\":\"/tutorials/boundary_conditions\"},{\"text\":\"Bernoulli Spatial Classification with a Matérn Field\",\"link\":\"/tutorials/bernoulli_spatial_classification\"},{\"text\":\"Advanced GMRF modelling for disease mapping\",\"link\":\"/tutorials/bym_scotland_lip_cancer\"},{\"text\":\"KL-minimizing Sparse GMRF Approximations to Gaussian Processes\",\"link\":\"/tutorials/kl_approximation\"},{\"text\":\"Automatic Differentiation for GMRF Hyperparameters\",\"link\":\"/tutorials/automatic_differentiation\"}]},{\"text\":\"API Reference\",\"collapsed\":false,\"items\":[{\"text\":\"Overview\",\"link\":\"/reference/index\"},{\"text\":\"GMRFs\",\"link\":\"/reference/gmrfs\"},{\"text\":\"Latent Models\",\"link\":\"/reference/latent_models\"},{\"text\":\"Observation Models\",\"link\":\"/reference/observation_models\"},{\"text\":\"Gaussian Approximation\",\"link\":\"/reference/gaussian_approximation\"},{\"text\":\"Hard Constraints\",\"link\":\"/reference/hard_constraints\"},{\"text\":\"Automatic Differentiation\",\"link\":\"/reference/autodiff\"},{\"text\":\"KL Approximations\",\"link\":\"/reference/kl_approximation\"},{\"text\":\"SPDEs\",\"link\":\"/reference/spdes\"},{\"text\":\"Discretizations\",\"link\":\"/reference/discretizations\"},{\"text\":\"Meshes\",\"link\":\"/reference/meshes\"},{\"text\":\"Plotting\",\"link\":\"/reference/plotting\"},{\"text\":\"Solvers\",\"link\":\"/reference/solvers\"},{\"text\":\"Autoregressive Models\",\"link\":\"/reference/autoregressive\"},{\"text\":\"Linear maps\",\"link\":\"/reference/linear_maps\"},{\"text\":\"Preconditioners\",\"link\":\"/reference/preconditioners\"}]},{\"text\":\"Bibliography\",\"link\":\"/bibliography\"},{\"text\":\"Developer Documentation\",\"collapsed\":false,\"items\":[{\"text\":\"Overview\",\"link\":\"/dev-docs/index\"},{\"text\":\"Solvers\",\"link\":\"/dev-docs/solvers\"},{\"text\":\"SPDEs\",\"link\":\"/dev-docs/spdes\"},{\"text\":\"Discretizations\",\"link\":\"/dev-docs/discretizations\"}]}],\"editLink\":{\"pattern\":\"https://github.com/timweiland/GaussianMarkovRandomFields.jl/edit/main/docs/src/:path\"},\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/timweiland/GaussianMarkovRandomFields.jl\"}],\"footer\":{\"message\":\"Made with <a href=\\\"https://luxdl.github.io/DocumenterVitepress.jl/dev/\\\" target=\\\"_blank\\\"><strong>DocumenterVitepress.jl</strong></a><br>\",\"copyright\":\"© Copyright 2025.\"}},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":true}");</script>
    
  </body>
</html>