<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Solvers · GaussianMarkovRandomFields.jl</title><meta name="title" content="Solvers · GaussianMarkovRandomFields.jl"/><meta property="og:title" content="Solvers · GaussianMarkovRandomFields.jl"/><meta property="twitter:title" content="Solvers · GaussianMarkovRandomFields.jl"/><meta name="description" content="Documentation for GaussianMarkovRandomFields.jl."/><meta property="og:description" content="Documentation for GaussianMarkovRandomFields.jl."/><meta property="twitter:description" content="Documentation for GaussianMarkovRandomFields.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/citations.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.svg" alt="GaussianMarkovRandomFields.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">GaussianMarkovRandomFields.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><input class="collapse-toggle" id="menuitem-2" type="checkbox"/><label class="tocitem" for="menuitem-2"><span class="docs-label">Tutorials</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../tutorials/">Overview</a></li><li><a class="tocitem" href="../../tutorials/autoregressive_models/">Building autoregressive models</a></li><li><a class="tocitem" href="../../tutorials/spatial_modelling_spdes/">Spatial Modelling with SPDEs</a></li><li><a class="tocitem" href="../../tutorials/spatiotemporal_modelling/">Spatiotemporal Modelling with SPDEs</a></li><li><a class="tocitem" href="../../tutorials/boundary_conditions/">Boundary Conditions for SPDEs</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox" checked/><label class="tocitem" for="menuitem-3"><span class="docs-label">API Reference</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../">Overview</a></li><li><a class="tocitem" href="../gmrfs/">GMRFs</a></li><li><a class="tocitem" href="../observation_models/">Observation Models</a></li><li><a class="tocitem" href="../gaussian_approximation/">Gaussian Approximation</a></li><li><a class="tocitem" href="../hard_constraints/">Hard Constraints</a></li><li><a class="tocitem" href="../spdes/">SPDEs</a></li><li><a class="tocitem" href="../discretizations/">Discretizations</a></li><li><a class="tocitem" href="../meshes/">Meshes</a></li><li><a class="tocitem" href="../plotting/">Plotting</a></li><li class="is-active"><a class="tocitem" href>Solvers</a><ul class="internal"><li><a class="tocitem" href="#Direct-Methods-(Cholesky,-LU)"><span>Direct Methods (Cholesky, LU)</span></a></li><li><a class="tocitem" href="#Pardiso"><span>Pardiso</span></a></li><li><a class="tocitem" href="#Iterative-Methods-(CG,-GMRES)"><span>Iterative Methods (CG, GMRES)</span></a></li><li><a class="tocitem" href="#Variance-Computation-Strategies"><span>Variance Computation Strategies</span></a></li><li><a class="tocitem" href="#Advanced-Operations"><span>Advanced Operations</span></a></li><li><a class="tocitem" href="#Choosing-a-Solver"><span>Choosing a Solver</span></a></li></ul></li><li><a class="tocitem" href="../autoregressive/">Autoregressive Models</a></li><li><a class="tocitem" href="../linear_maps/">Linear maps</a></li><li><a class="tocitem" href="../preconditioners/">Preconditioners</a></li></ul></li><li><a class="tocitem" href="../../bibliography/">Bibliography</a></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox"/><label class="tocitem" for="menuitem-5"><span class="docs-label">Developer Documentation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../dev-docs/">Overview</a></li><li><a class="tocitem" href="../../dev-docs/solvers/">Solvers</a></li><li><a class="tocitem" href="../../dev-docs/spdes/">SPDEs</a></li><li><a class="tocitem" href="../../dev-docs/discretizations/">Discretizations</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">API Reference</a></li><li class="is-active"><a href>Solvers</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Solvers</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/timweiland/GaussianMarkovRandomFields.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/main/docs/src/reference/solvers.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Solvers"><a class="docs-heading-anchor" href="#Solvers">Solvers</a><a id="Solvers-1"></a><a class="docs-heading-anchor-permalink" href="#Solvers" title="Permalink"></a></h1><p>Fundamentally, all interesting quantities of GMRFs (samples, marginal variances, posterior means, ...) must be computed through <strong>sparse linear algebra</strong>. GaussianMarkovRandomFields.jl uses <a href="https://github.com/SciML/LinearSolve.jl">LinearSolve.jl</a> as the backend for all linear algebra operations, providing access to a wide range of modern solvers and preconditioners while maintaining a unified interface. Our goal is to provide sane defaults that &quot;just work&quot; for most users, while still allowing power users to customize the behavior through LinearSolve.jl algorithms. Read further to learn about the available capabilities and how to use them.</p><h2 id="Direct-Methods-(Cholesky,-LU)"><a class="docs-heading-anchor" href="#Direct-Methods-(Cholesky,-LU)">Direct Methods (Cholesky, LU)</a><a id="Direct-Methods-(Cholesky,-LU)-1"></a><a class="docs-heading-anchor-permalink" href="#Direct-Methods-(Cholesky,-LU)" title="Permalink"></a></h2><p><a href="https://github.com/DrTimothyAldenDavis/SuiteSparse">CHOLMOD</a> and other direct solvers are  state-of-the-art methods for sparse linear systems. LinearSolve.jl automatically selects appropriate direct methods (typically Cholesky for symmetric positive definite systems like GMRF precision matrices) to compute factorizations of the precision matrix, which are then leveraged to draw samples and compute posterior means. Marginal variances are computed using selected inversion when available, or RBMC as a fallback.</p><h2 id="Pardiso"><a class="docs-heading-anchor" href="#Pardiso">Pardiso</a><a id="Pardiso-1"></a><a class="docs-heading-anchor-permalink" href="#Pardiso" title="Permalink"></a></h2><p><a href="https://panua.ch/pardiso/">Pardiso</a> is a state-of-the-art direct solver for sparse linear systems with excellent performance on large-dimensional GMRFs and highly efficient methods for marginal variance computation.</p><p>To use Pardiso, you need to set up and load <a href="https://github.com/JuliaSparse/Pardiso.jl">Pardiso.jl</a>, then specify <code>alg=LinearSolve.PardisoJL()</code> when creating your GMRF:</p><pre><code class="language-julia hljs">using Pardiso, LinearSolve
gmrf = GMRF(μ, Q, alg=LinearSolve.PardisoJL())</code></pre><p>See the <a href="https://docs.sciml.ai/LinearSolve/stable/solvers/solvers/#LinearSolve.PardisoJL">LinearSolve.jl documentation</a> for more information about PardisoJL algorithm options.</p><h2 id="Iterative-Methods-(CG,-GMRES)"><a class="docs-heading-anchor" href="#Iterative-Methods-(CG,-GMRES)">Iterative Methods (CG, GMRES)</a><a id="Iterative-Methods-(CG,-GMRES)-1"></a><a class="docs-heading-anchor-permalink" href="#Iterative-Methods-(CG,-GMRES)" title="Permalink"></a></h2><p>The Conjugate Gradient (CG) method and other iterative methods are efficient approaches for solving large sparse symmetric positive-definite linear systems. LinearSolve.jl provides access to various iterative solvers that can be used for large-scale GMRFs where direct methods become prohibitively expensive.</p><p>For symmetric systems like GMRFs, CG-based methods are typically most appropriate:</p><pre><code class="language-julia hljs">using LinearSolve
gmrf = GMRF(μ, Q, alg=LinearSolve.KrylovJL_CG())</code></pre><h2 id="Variance-Computation-Strategies"><a class="docs-heading-anchor" href="#Variance-Computation-Strategies">Variance Computation Strategies</a><a id="Variance-Computation-Strategies-1"></a><a class="docs-heading-anchor-permalink" href="#Variance-Computation-Strategies" title="Permalink"></a></h2><p>Fundamentally, computing marginal variances of GMRFs is not trivial, as it requires computing the diagonal entries of the covariance matrix (which is the inverse of the precision matrix).</p><p><strong>Selected Inversion</strong> (including Takahashi recursions) is a highly accurate and stable method for computing these variances when available for the chosen algorithm. This is automatically used when supported.</p><p>When selected inversion is not available, the package automatically falls back to <strong>RBMC</strong> (Rao-Blackwellized Monte Carlo), a sampling-based approach that is less accurate but can be much faster for large GMRFs.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GaussianMarkovRandomFields.AbstractVarianceStrategy" href="#GaussianMarkovRandomFields.AbstractVarianceStrategy"><code>GaussianMarkovRandomFields.AbstractVarianceStrategy</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">AbstractVarianceStrategy</code></pre><p>An abstract type for a strategy to compute the variance of a GMRF.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/bdabc9ad248bcf9b0b288a6baa5cc58ece218ff5/src/typedefs.jl#L5-L9">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GaussianMarkovRandomFields.RBMCStrategy" href="#GaussianMarkovRandomFields.RBMCStrategy"><code>GaussianMarkovRandomFields.RBMCStrategy</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">RBMCStrategy(n_samples; rng)</code></pre><p>Rao-Blackwellized Monte Carlo estimator of a GMRF&#39;s marginal variances based on [<a href="../../bibliography/#Siden2018">3</a>]. Particularly useful in large-scale regimes where Takahashi recursions may be too expensive.</p><p><strong>Arguments</strong></p><ul><li><code>n_samples::Int</code>: Number of samples to draw.</li></ul><p><strong>Keyword arguments</strong></p><ul><li><code>rng::Random.AbstractRNG = Random.default_rng()</code>: Random number generator.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/bdabc9ad248bcf9b0b288a6baa5cc58ece218ff5/src/solvers/rbmc.jl#L8-L21">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GaussianMarkovRandomFields.BlockRBMCStrategy" href="#GaussianMarkovRandomFields.BlockRBMCStrategy"><code>GaussianMarkovRandomFields.BlockRBMCStrategy</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">BlockRBMCStrategy(n_samples; rng, enclosure_size)</code></pre><p>Block Rao-Blackwellized Monte Carlo estimator of a GMRF&#39;s marginal variances based on [<a href="../../bibliography/#Siden2018">3</a>]. Achieves faster convergence than plain RBMC by considering blocks of nodes rather than individual nodes, thus integrating more information about the precision matrix. <code>enclosure_size</code> specifies the size of these blocks. Larger values lead to faster convergence (in terms of the number of samples) at the cost of increased compute. Thus, one should aim for a sweet spot between sampling costs and block operation costs.</p><p><strong>Arguments</strong></p><ul><li><code>n_samples::Int</code>: Number of samples to draw.</li></ul><p><strong>Keyword arguments</strong></p><ul><li><code>rng::Random.AbstractRNG = Random.default_rng()</code>: Random number generator.</li><li><code>enclosure_size::Int = 1</code>: Size of the blocks.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/bdabc9ad248bcf9b0b288a6baa5cc58ece218ff5/src/solvers/rbmc.jl#L31-L51">source</a></section></article><h2 id="Advanced-Operations"><a class="docs-heading-anchor" href="#Advanced-Operations">Advanced Operations</a><a id="Advanced-Operations-1"></a><a class="docs-heading-anchor-permalink" href="#Advanced-Operations" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GaussianMarkovRandomFields.logdet_cov" href="#GaussianMarkovRandomFields.logdet_cov"><code>GaussianMarkovRandomFields.logdet_cov</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">logdet_cov(linsolve, alg)</code></pre><p>Compute the log determinant of the covariance matrix (inverse of precision). Dispatches on the algorithm type.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/bdabc9ad248bcf9b0b288a6baa5cc58ece218ff5/src/solvers/logdet.jl#L6-L11">source</a></section><section><div><pre><code class="language-julia hljs">logdet_cov(linsolve)</code></pre><p>Convenience function that dispatches to logdet_cov(linsolve, linsolve.alg).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/bdabc9ad248bcf9b0b288a6baa5cc58ece218ff5/src/solvers/logdet.jl#L17-L21">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GaussianMarkovRandomFields.selinv" href="#GaussianMarkovRandomFields.selinv"><code>GaussianMarkovRandomFields.selinv</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">selinv(linsolve, alg)</code></pre><p>Compute the full selected inverse matrix using selected inversion. Dispatches on the algorithm type.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/bdabc9ad248bcf9b0b288a6baa5cc58ece218ff5/src/solvers/selinv.jl#L47-L52">source</a></section><section><div><pre><code class="language-julia hljs">selinv(linsolve)</code></pre><p>Convenience function that dispatches to selinv(linsolve, linsolve.alg).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/bdabc9ad248bcf9b0b288a6baa5cc58ece218ff5/src/solvers/selinv.jl#L58-L62">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GaussianMarkovRandomFields.backward_solve" href="#GaussianMarkovRandomFields.backward_solve"><code>GaussianMarkovRandomFields.backward_solve</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">backward_solve(linsolve, x, alg)</code></pre><p>Perform backward solve L^T \ x where L is the Cholesky factor. Dispatches on the algorithm type.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/bdabc9ad248bcf9b0b288a6baa5cc58ece218ff5/src/solvers/backward_solve.jl#L28-L33">source</a></section><section><div><pre><code class="language-julia hljs">backward_solve(linsolve, x)</code></pre><p>Convenience function that dispatches to backward_solve(linsolve, x, linsolve.alg).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/bdabc9ad248bcf9b0b288a6baa5cc58ece218ff5/src/solvers/backward_solve.jl#L39-L43">source</a></section></article><h2 id="Choosing-a-Solver"><a class="docs-heading-anchor" href="#Choosing-a-Solver">Choosing a Solver</a><a id="Choosing-a-Solver-1"></a><a class="docs-heading-anchor-permalink" href="#Choosing-a-Solver" title="Permalink"></a></h2><p>LinearSolve.jl automatically selects appropriate algorithms based on matrix properties:</p><ul><li><strong>Direct methods</strong> (Cholesky, LU) for small to medium-sized GMRFs</li><li><strong>Iterative methods</strong> (CG, GMRES) for large sparse GMRFs where direct methods become prohibitively expensive</li></ul><p>This matches our general recommendations: Direct solvers combined with selected inversion are highly accurate and stable and should be used whenever possible. However, direct solvers become prohibitively expensive for very large-scale GMRFs, both in terms of compute and memory use. In these regimes, iterative methods may still be a viable option.</p><p>If you have access to both strong parallel computing resources and a Pardiso license, <code>LinearSolve.PardisoJL()</code> may provide the best performance.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../plotting/">« Plotting</a><a class="docs-footer-nextpage" href="../autoregressive/">Autoregressive Models »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Monday 25 August 2025 13:01">Monday 25 August 2025</span>. Using Julia version 1.10.10.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
