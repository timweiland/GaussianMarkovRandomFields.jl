<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Observation Models | GMRFs.jl</title>
    <meta name="description" content="Documentation for GaussianMarkovRandomFields.jl">
    <meta name="generator" content="VitePress v1.6.4">
    <link rel="preload stylesheet" href="/GaussianMarkovRandomFields.jl/dev/assets/style.DOn6kFZk.css" as="style">
    <link rel="preload stylesheet" href="/GaussianMarkovRandomFields.jl/dev/vp-icons.css" as="style">
    
    <script type="module" src="/GaussianMarkovRandomFields.jl/dev/assets/app.CODlTd-7.js"></script>
    <link rel="preload" href="/GaussianMarkovRandomFields.jl/dev/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/GaussianMarkovRandomFields.jl/dev/assets/chunks/theme.IfNffD3t.js">
    <link rel="modulepreload" href="/GaussianMarkovRandomFields.jl/dev/assets/chunks/framework.B28kaWcy.js">
    <link rel="modulepreload" href="/GaussianMarkovRandomFields.jl/dev/assets/reference_observation_models.md.Cy0qdkzq.lean.js">
    <script src="/GaussianMarkovRandomFields.jl/versions.js"></script>
    <script src="/GaussianMarkovRandomFields.jl/dev/siteinfo.js"></script>
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-a9a9e638><!--[--><!--]--><!--[--><span tabindex="-1" data-v-492508fc></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-492508fc>Skip to content</a><!--]--><!----><header class="VPNav" data-v-a9a9e638 data-v-f1e365da><div class="VPNavBar" data-v-f1e365da data-v-822684d1><div class="wrapper" data-v-822684d1><div class="container" data-v-822684d1><div class="title" data-v-822684d1><div class="VPNavBarTitle has-sidebar" data-v-822684d1 data-v-0f4f798b><a class="title" href="/GaussianMarkovRandomFields.jl/dev/" data-v-0f4f798b><!--[--><!--]--><!--[--><img class="VPImage logo" src="/GaussianMarkovRandomFields.jl/dev/logo.svg" width="24" height="24" alt data-v-35a7d0b8><!--]--><span data-v-0f4f798b>GMRFs.jl</span><!--[--><!--]--></a></div></div><div class="content" data-v-822684d1><div class="content-body" data-v-822684d1><!--[--><!--]--><div class="VPNavBarSearch search" data-v-822684d1><!--[--><!----><div id="local-search"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><span class="vp-icon DocSearch-Search-Icon"></span><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-822684d1 data-v-e6d46098><span id="main-nav-aria-label" class="visually-hidden" data-v-e6d46098> Main Navigation </span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/GaussianMarkovRandomFields.jl/dev/index" tabindex="0" data-v-e6d46098 data-v-956ec74c><!--[--><span data-v-956ec74c>Home</span><!--]--></a><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-e6d46098 data-v-04f5c5e9><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-04f5c5e9><span class="text" data-v-04f5c5e9><!----><span data-v-04f5c5e9>Tutorials</span><span class="vpi-chevron-down text-icon" data-v-04f5c5e9></span></span></button><div class="menu" data-v-04f5c5e9><div class="VPMenu" data-v-04f5c5e9 data-v-7dd3104a><div class="items" data-v-7dd3104a><!--[--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/GaussianMarkovRandomFields.jl/dev/tutorials/index" data-v-acbfed09><!--[--><span data-v-acbfed09>Overview</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/GaussianMarkovRandomFields.jl/dev/tutorials/autoregressive_models" data-v-acbfed09><!--[--><span data-v-acbfed09>Building autoregressive models</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/GaussianMarkovRandomFields.jl/dev/tutorials/spatial_modelling_spdes" data-v-acbfed09><!--[--><span data-v-acbfed09>Spatial Modelling with SPDEs</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/GaussianMarkovRandomFields.jl/dev/tutorials/spatiotemporal_modelling" data-v-acbfed09><!--[--><span data-v-acbfed09>Spatiotemporal Modelling with SPDEs</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/GaussianMarkovRandomFields.jl/dev/tutorials/boundary_conditions" data-v-acbfed09><!--[--><span data-v-acbfed09>Boundary Conditions for SPDEs</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/GaussianMarkovRandomFields.jl/dev/tutorials/bernoulli_spatial_classification" data-v-acbfed09><!--[--><span data-v-acbfed09>Bernoulli Spatial Classification with a Matérn Field</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/GaussianMarkovRandomFields.jl/dev/tutorials/bym_scotland_lip_cancer" data-v-acbfed09><!--[--><span data-v-acbfed09>Advanced GMRF modelling for disease mapping</span><!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup active" data-v-e6d46098 data-v-04f5c5e9><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-04f5c5e9><span class="text" data-v-04f5c5e9><!----><span data-v-04f5c5e9>API Reference</span><span class="vpi-chevron-down text-icon" data-v-04f5c5e9></span></span></button><div class="menu" data-v-04f5c5e9><div class="VPMenu" data-v-04f5c5e9 data-v-7dd3104a><div class="items" data-v-7dd3104a><!--[--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/GaussianMarkovRandomFields.jl/dev/reference/index" data-v-acbfed09><!--[--><span data-v-acbfed09>Overview</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/GaussianMarkovRandomFields.jl/dev/reference/gmrfs" data-v-acbfed09><!--[--><span data-v-acbfed09>GMRFs</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/GaussianMarkovRandomFields.jl/dev/reference/latent_models" data-v-acbfed09><!--[--><span data-v-acbfed09>Latent Models</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link active" href="/GaussianMarkovRandomFields.jl/dev/reference/observation_models" data-v-acbfed09><!--[--><span data-v-acbfed09>Observation Models</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/GaussianMarkovRandomFields.jl/dev/reference/gaussian_approximation" data-v-acbfed09><!--[--><span data-v-acbfed09>Gaussian Approximation</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/GaussianMarkovRandomFields.jl/dev/reference/hard_constraints" data-v-acbfed09><!--[--><span data-v-acbfed09>Hard Constraints</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/GaussianMarkovRandomFields.jl/dev/reference/spdes" data-v-acbfed09><!--[--><span data-v-acbfed09>SPDEs</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/GaussianMarkovRandomFields.jl/dev/reference/discretizations" data-v-acbfed09><!--[--><span data-v-acbfed09>Discretizations</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/GaussianMarkovRandomFields.jl/dev/reference/meshes" data-v-acbfed09><!--[--><span data-v-acbfed09>Meshes</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/GaussianMarkovRandomFields.jl/dev/reference/plotting" data-v-acbfed09><!--[--><span data-v-acbfed09>Plotting</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/GaussianMarkovRandomFields.jl/dev/reference/solvers" data-v-acbfed09><!--[--><span data-v-acbfed09>Solvers</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/GaussianMarkovRandomFields.jl/dev/reference/autoregressive" data-v-acbfed09><!--[--><span data-v-acbfed09>Autoregressive Models</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/GaussianMarkovRandomFields.jl/dev/reference/linear_maps" data-v-acbfed09><!--[--><span data-v-acbfed09>Linear maps</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/GaussianMarkovRandomFields.jl/dev/reference/preconditioners" data-v-acbfed09><!--[--><span data-v-acbfed09>Preconditioners</span><!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/GaussianMarkovRandomFields.jl/dev/bibliography" tabindex="0" data-v-e6d46098 data-v-956ec74c><!--[--><span data-v-956ec74c>Bibliography</span><!--]--></a><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-e6d46098 data-v-04f5c5e9><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-04f5c5e9><span class="text" data-v-04f5c5e9><!----><span data-v-04f5c5e9>Developer Documentation</span><span class="vpi-chevron-down text-icon" data-v-04f5c5e9></span></span></button><div class="menu" data-v-04f5c5e9><div class="VPMenu" data-v-04f5c5e9 data-v-7dd3104a><div class="items" data-v-7dd3104a><!--[--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/GaussianMarkovRandomFields.jl/dev/dev-docs/index" data-v-acbfed09><!--[--><span data-v-acbfed09>Overview</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/GaussianMarkovRandomFields.jl/dev/dev-docs/solvers" data-v-acbfed09><!--[--><span data-v-acbfed09>Solvers</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/GaussianMarkovRandomFields.jl/dev/dev-docs/spdes" data-v-acbfed09><!--[--><span data-v-acbfed09>SPDEs</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/GaussianMarkovRandomFields.jl/dev/dev-docs/discretizations" data-v-acbfed09><!--[--><span data-v-acbfed09>Discretizations</span><!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><!----><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-822684d1 data-v-af096f4a><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-af096f4a data-v-e40a8bb6 data-v-4a1c76db><span class="check" data-v-4a1c76db><span class="icon" data-v-4a1c76db><!--[--><span class="vpi-sun sun" data-v-e40a8bb6></span><span class="vpi-moon moon" data-v-e40a8bb6></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-822684d1 data-v-164c457f data-v-ee7a9424><!--[--><a class="VPSocialLink no-icon" href="https://github.com/timweiland/GaussianMarkovRandomFields.jl" aria-label="github" target="_blank" rel="noopener" data-v-ee7a9424 data-v-d26d30cb><span class="vpi-social-github"></span></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-822684d1 data-v-925effce data-v-04f5c5e9><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-04f5c5e9><span class="vpi-more-horizontal icon" data-v-04f5c5e9></span></button><div class="menu" data-v-04f5c5e9><div class="VPMenu" data-v-04f5c5e9 data-v-7dd3104a><!----><!--[--><!--[--><!----><div class="group" data-v-925effce><div class="item appearance" data-v-925effce><p class="label" data-v-925effce>Appearance</p><div class="appearance-action" data-v-925effce><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-925effce data-v-e40a8bb6 data-v-4a1c76db><span class="check" data-v-4a1c76db><span class="icon" data-v-4a1c76db><!--[--><span class="vpi-sun sun" data-v-e40a8bb6></span><span class="vpi-moon moon" data-v-e40a8bb6></span><!--]--></span></span></button></div></div></div><div class="group" data-v-925effce><div class="item social-links" data-v-925effce><div class="VPSocialLinks social-links-list" data-v-925effce data-v-ee7a9424><!--[--><a class="VPSocialLink no-icon" href="https://github.com/timweiland/GaussianMarkovRandomFields.jl" aria-label="github" target="_blank" rel="noopener" data-v-ee7a9424 data-v-d26d30cb><span class="vpi-social-github"></span></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--[--><!--[--><div class="VPFlyout VPNolebaseEnhancedReadabilitiesMenu VPNolebaseEnhancedReadabilitiesMenuFlyout" aria-label="Enhanced Readability" role="menuitem" data-v-04f5c5e9><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-04f5c5e9><span class="text" data-v-04f5c5e9><span class="i-icon-park-outline:book-open option-icon" data-v-04f5c5e9></span><!----><span class="vpi-chevron-down text-icon" data-v-04f5c5e9></span></span></button><div class="menu" data-v-04f5c5e9><div class="VPMenu" data-v-04f5c5e9 data-v-7dd3104a><!----><!--[--><!--]--></div></div></div><!--]--><!--]--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-822684d1 data-v-5dea55bf><span class="container" data-v-5dea55bf><span class="top" data-v-5dea55bf></span><span class="middle" data-v-5dea55bf></span><span class="bottom" data-v-5dea55bf></span></span></button></div></div></div></div><div class="divider" data-v-822684d1><div class="divider-line" data-v-822684d1></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-a9a9e638 data-v-070ab83d><div class="container" data-v-070ab83d><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-070ab83d><span class="vpi-align-left menu-icon" data-v-070ab83d></span><span class="menu-text" data-v-070ab83d>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-070ab83d data-v-168ddf5d><button data-v-168ddf5d>Return to top</button><!----></div></div></div><aside class="VPSidebar" data-v-a9a9e638 data-v-18756405><div class="curtain" data-v-18756405></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-18756405><span class="visually-hidden" id="sidebar-aria-label" data-v-18756405> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="no-transition group" data-v-9e426adc><section class="VPSidebarItem level-0" data-v-9e426adc data-v-a4b0d9bf><!----><div class="items" data-v-a4b0d9bf><!--[--><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/GaussianMarkovRandomFields.jl/dev/index" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Home</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-9e426adc><section class="VPSidebarItem level-0 collapsible" data-v-9e426adc data-v-a4b0d9bf><div class="item" role="button" tabindex="0" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><h2 class="text" data-v-a4b0d9bf>Tutorials</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-a4b0d9bf><span class="vpi-chevron-right caret-icon" data-v-a4b0d9bf></span></div></div><div class="items" data-v-a4b0d9bf><!--[--><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/GaussianMarkovRandomFields.jl/dev/tutorials/index" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Overview</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/GaussianMarkovRandomFields.jl/dev/tutorials/autoregressive_models" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Building autoregressive models</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/GaussianMarkovRandomFields.jl/dev/tutorials/spatial_modelling_spdes" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Spatial Modelling with SPDEs</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/GaussianMarkovRandomFields.jl/dev/tutorials/spatiotemporal_modelling" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Spatiotemporal Modelling with SPDEs</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/GaussianMarkovRandomFields.jl/dev/tutorials/boundary_conditions" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Boundary Conditions for SPDEs</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/GaussianMarkovRandomFields.jl/dev/tutorials/bernoulli_spatial_classification" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Bernoulli Spatial Classification with a Matérn Field</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/GaussianMarkovRandomFields.jl/dev/tutorials/bym_scotland_lip_cancer" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Advanced GMRF modelling for disease mapping</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-9e426adc><section class="VPSidebarItem level-0 collapsible has-active" data-v-9e426adc data-v-a4b0d9bf><div class="item" role="button" tabindex="0" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><h2 class="text" data-v-a4b0d9bf>API Reference</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-a4b0d9bf><span class="vpi-chevron-right caret-icon" data-v-a4b0d9bf></span></div></div><div class="items" data-v-a4b0d9bf><!--[--><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/GaussianMarkovRandomFields.jl/dev/reference/index" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Overview</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/GaussianMarkovRandomFields.jl/dev/reference/gmrfs" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>GMRFs</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/GaussianMarkovRandomFields.jl/dev/reference/latent_models" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Latent Models</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/GaussianMarkovRandomFields.jl/dev/reference/observation_models" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Observation Models</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/GaussianMarkovRandomFields.jl/dev/reference/gaussian_approximation" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Gaussian Approximation</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/GaussianMarkovRandomFields.jl/dev/reference/hard_constraints" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Hard Constraints</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/GaussianMarkovRandomFields.jl/dev/reference/spdes" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>SPDEs</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/GaussianMarkovRandomFields.jl/dev/reference/discretizations" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Discretizations</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/GaussianMarkovRandomFields.jl/dev/reference/meshes" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Meshes</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/GaussianMarkovRandomFields.jl/dev/reference/plotting" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Plotting</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/GaussianMarkovRandomFields.jl/dev/reference/solvers" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Solvers</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/GaussianMarkovRandomFields.jl/dev/reference/autoregressive" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Autoregressive Models</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/GaussianMarkovRandomFields.jl/dev/reference/linear_maps" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Linear maps</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/GaussianMarkovRandomFields.jl/dev/reference/preconditioners" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Preconditioners</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-9e426adc><section class="VPSidebarItem level-0" data-v-9e426adc data-v-a4b0d9bf><!----><div class="items" data-v-a4b0d9bf><!--[--><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/GaussianMarkovRandomFields.jl/dev/bibliography" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Bibliography</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-9e426adc><section class="VPSidebarItem level-0 collapsible" data-v-9e426adc data-v-a4b0d9bf><div class="item" role="button" tabindex="0" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><h2 class="text" data-v-a4b0d9bf>Developer Documentation</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-a4b0d9bf><span class="vpi-chevron-right caret-icon" data-v-a4b0d9bf></span></div></div><div class="items" data-v-a4b0d9bf><!--[--><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/GaussianMarkovRandomFields.jl/dev/dev-docs/index" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Overview</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/GaussianMarkovRandomFields.jl/dev/dev-docs/solvers" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Solvers</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/GaussianMarkovRandomFields.jl/dev/dev-docs/spdes" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>SPDEs</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/GaussianMarkovRandomFields.jl/dev/dev-docs/discretizations" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Discretizations</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-a9a9e638 data-v-91765379><div class="VPDoc has-sidebar has-aside" data-v-91765379 data-v-83890dd9><!--[--><!--]--><div class="container" data-v-83890dd9><div class="aside" data-v-83890dd9><div class="aside-curtain" data-v-83890dd9></div><div class="aside-container" data-v-83890dd9><div class="aside-content" data-v-83890dd9><div class="VPDocAside" data-v-83890dd9 data-v-6d7b3c46><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-6d7b3c46 data-v-b38bf2ff><div class="content" data-v-b38bf2ff><div class="outline-marker" data-v-b38bf2ff></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-b38bf2ff>On this page</div><ul class="VPDocOutlineItem root" data-v-b38bf2ff data-v-3f927ebe><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-6d7b3c46></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-83890dd9><div class="content-container" data-v-83890dd9><!--[--><!--]--><main class="main" data-v-83890dd9><div style="position:relative;" class="vp-doc _GaussianMarkovRandomFields_jl_dev_reference_observation_models" data-v-83890dd9><div><h1 id="Observation-Models" tabindex="-1">Observation Models <a class="header-anchor" href="#Observation-Models" aria-label="Permalink to &quot;Observation Models {#Observation-Models}&quot;">​</a></h1><p>Observation models define the relationship between observations <code>y</code> and the latent GMRF field <code>x</code>, typically through likelihood functions. They enable Bayesian inference by connecting your data to the underlying Gaussian process through flexible probabilistic models.</p><p>GaussianMarkovRandomFields.jl implements observation models using a <strong>factory pattern</strong> that separates model configuration from materialized evaluation instances. This design provides major performance benefits in optimization loops and cleaner automatic differentiation boundaries.</p><h2 id="Core-Concepts" tabindex="-1">Core Concepts <a class="header-anchor" href="#Core-Concepts" aria-label="Permalink to &quot;Core Concepts {#Core-Concepts}&quot;">​</a></h2><h3 id="The-Factory-Pattern" tabindex="-1">The Factory Pattern <a class="header-anchor" href="#The-Factory-Pattern" aria-label="Permalink to &quot;The Factory Pattern {#The-Factory-Pattern}&quot;">​</a></h3><p>Observation models follow a two-stage pattern:</p><ol><li><p><strong>ObservationModel</strong>: A factory that defines the model structure and hyperparameters</p></li><li><p><strong>ObservationLikelihood</strong>: A materialized instance with specific data and hyperparameters for fast evaluation</p></li></ol><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Step 1: Configure observation model (factory)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">obs_model </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ExponentialFamily</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Normal)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Step 2: Materialize with data and hyperparameters  </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">obs_lik </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> obs_model</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(y; σ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Step 3: Fast evaluation in hot loops</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ll </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> loglik</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x, obs_lik)      </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Only x argument needed!</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">grad </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> loggrad</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x, obs_lik)   </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Fast x-only evaluation</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">hess </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> loghessian</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x, obs_lik)</span></span></code></pre></div><p>This pattern eliminates the need to repeatedly pass data and hyperparameters, providing significant performance benefits in optimization and sampling algorithms.</p><h3 id="Evaluation-Interface" tabindex="-1">Evaluation Interface <a class="header-anchor" href="#Evaluation-Interface" aria-label="Permalink to &quot;Evaluation Interface {#Evaluation-Interface}&quot;">​</a></h3><p>All materialized observation likelihoods support a common interface:</p><ul><li><p><code>loglik(x, obs_lik)</code>: Evaluate log-likelihood</p></li><li><p><code>loggrad(x, obs_lik)</code>: Compute gradient with respect to latent field</p></li><li><p><code>loghessian(x, obs_lik)</code>: Compute Hessian matrix</p></li></ul><h2 id="Exponential-Family-Models" tabindex="-1">Exponential Family Models <a class="header-anchor" href="#Exponential-Family-Models" aria-label="Permalink to &quot;Exponential Family Models {#Exponential-Family-Models}&quot;">​</a></h2><p>The most common observation models are exponential family distributions connected to the latent field through link functions.</p><h3 id="Basic-Usage" tabindex="-1">Basic Usage <a class="header-anchor" href="#Basic-Usage" aria-label="Permalink to &quot;Basic Usage {#Basic-Usage}&quot;">​</a></h3><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> GaussianMarkovRandomFields</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Distributions</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Poisson model for count data (canonical LogLink)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">poisson_model </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ExponentialFamily</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Poisson)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">x </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Latent field (log-intensity due to LogLink)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">y </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">7</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]      </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Count observations</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">obs_lik </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> poisson_model</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(y)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ll </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> loglik</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x, obs_lik)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Normal model for continuous data (canonical IdentityLink)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">normal_model </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ExponentialFamily</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Normal)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">x </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2.3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Latent field (direct mean due to IdentityLink)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">y </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2.8</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Continuous observations</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">obs_lik </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> normal_model</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(y; σ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Normal requires σ hyperparameter</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ll </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> loglik</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x, obs_lik)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Bernoulli model for binary data (canonical LogitLink)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">bernoulli_model </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ExponentialFamily</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Bernoulli)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">x </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Latent field (logit-probability due to LogitLink)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">y </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]      </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Binary observations</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">obs_lik </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> bernoulli_model</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(y)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ll </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> loglik</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x, obs_lik)</span></span></code></pre></div><h3 id="Supported-Distributions-and-Links" tabindex="-1">Supported Distributions and Links <a class="header-anchor" href="#Supported-Distributions-and-Links" aria-label="Permalink to &quot;Supported Distributions and Links {#Supported-Distributions-and-Links}&quot;">​</a></h3><table tabindex="0"><thead><tr><th style="text-align:right;">Distribution</th><th style="text-align:right;">Canonical Link</th><th style="text-align:right;">Alternative Links</th><th style="text-align:right;">Hyperparameters</th></tr></thead><tbody><tr><td style="text-align:right;">Normal</td><td style="text-align:right;">IdentityLink</td><td style="text-align:right;">LogLink</td><td style="text-align:right;">σ (std. dev.)</td></tr><tr><td style="text-align:right;">Poisson</td><td style="text-align:right;">LogLink</td><td style="text-align:right;">IdentityLink</td><td style="text-align:right;">none</td></tr><tr><td style="text-align:right;">Bernoulli</td><td style="text-align:right;">LogitLink</td><td style="text-align:right;">LogLink</td><td style="text-align:right;">none</td></tr><tr><td style="text-align:right;">Binomial</td><td style="text-align:right;">LogitLink</td><td style="text-align:right;">IdentityLink</td><td style="text-align:right;">none*</td></tr></tbody></table><p>*For Binomial, the number of trials is provided through the data structure <code>BinomialObservations</code>, not as a hyperparameter.</p><h3 id="Custom-Link-Functions" tabindex="-1">Custom Link Functions <a class="header-anchor" href="#Custom-Link-Functions" aria-label="Permalink to &quot;Custom Link Functions {#Custom-Link-Functions}&quot;">​</a></h3><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Non-canonical link function</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">poisson_identity </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ExponentialFamily</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Poisson, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">IdentityLink</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">())</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Note: Requires positive latent field values for valid Poisson intensities</span></span></code></pre></div><h2 id="Custom-Observation-Models" tabindex="-1">Custom Observation Models <a class="header-anchor" href="#Custom-Observation-Models" aria-label="Permalink to &quot;Custom Observation Models {#Custom-Observation-Models}&quot;">​</a></h2><p>For models not covered by exponential families, you can define custom log-likelihood functions using automatic differentiation.</p><h3 id="Basic-AutoDiff-Models" tabindex="-1">Basic AutoDiff Models <a class="header-anchor" href="#Basic-AutoDiff-Models" aria-label="Permalink to &quot;Basic AutoDiff Models {#Basic-AutoDiff-Models}&quot;">​</a></h3><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Define custom log-likelihood function</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> custom_loglik</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x; y</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], σ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    μ </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> sin</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.(x)  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Custom transformation</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.5</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> sum</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">((y </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> μ)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.^</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> σ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">^</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> length</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(y) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(σ)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Create observation model</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">obs_model </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> AutoDiffObservationModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(custom_loglik; n_latent</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, hyperparams</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:y</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:σ</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Materialize with data</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">obs_lik </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> obs_model</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(y</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.8</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], σ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Use normally - gradients and Hessians computed automatically!</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">x </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ll </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> loglik</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x, obs_lik)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">grad </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> loggrad</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x, obs_lik)    </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Automatic differentiation</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">hess </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> loghessian</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x, obs_lik) </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Potentially sparse!</span></span></code></pre></div><h3 id="Automatic-Differentiation-Requirements" tabindex="-1">Automatic Differentiation Requirements <a class="header-anchor" href="#Automatic-Differentiation-Requirements" aria-label="Permalink to &quot;Automatic Differentiation Requirements {#Automatic-Differentiation-Requirements}&quot;">​</a></h3><p>AutoDiff observation models require an automatic differentiation backend. We support and recommend the following backends in order of preference:</p><ol><li><p><strong>Enzyme.jl</strong> (recommended for performance)</p></li><li><p><strong>Mooncake.jl</strong> (good balance of performance and compatibility)</p></li><li><p><strong>Zygote.jl</strong> (reliable fallback)</p></li><li><p><strong>ForwardDiff.jl</strong> (for small problems)</p></li></ol><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Load an AD backend (required for AutoDiffObservationModel)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Enzyme  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Recommended</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Or use another supported backend:</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># using Mooncake</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># using Zygote</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># using ForwardDiff</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Now you can use AutoDiff models</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">obs_model </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> AutoDiffObservationModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(my_loglik; n_latent</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">obs_lik </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> obs_model</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(y</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">data)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">grad </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> loggrad</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x, obs_lik)  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Uses your loaded AD backend</span></span></code></pre></div><h3 id="Sparse-Hessian-Computation" tabindex="-1">Sparse Hessian Computation <a class="header-anchor" href="#Sparse-Hessian-Computation" aria-label="Permalink to &quot;Sparse Hessian Computation {#Sparse-Hessian-Computation}&quot;">​</a></h3><p>AutoDiff observation models can automatically detect and exploit sparsity in Hessian matrices using our package extensions. This requires loading both an AD backend and additional sparsity packages:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Load AD backend + sparse AD packages</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Enzyme  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Or your preferred AD backend</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> SparseConnectivityTracer, SparseMatrixColorings</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># The package extension is automatically activated</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">obs_model </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> AutoDiffObservationModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(my_loglik; n_latent</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">obs_lik </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> obs_model</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(y</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">data)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Hessian computation now automatically:</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># - Detects sparsity pattern using TracerSparsityDetector  </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># - Uses greedy coloring for efficient computation</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># - Returns sparse matrix when beneficial</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">hess </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> loghessian</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x, obs_lik)  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># May be sparse!</span></span></code></pre></div><p>The sparse Hessian features provide dramatic performance improvements for large-scale problems with structured sparsity.</p><h2 id="Nonlinear-Least-Squares" tabindex="-1">Nonlinear Least Squares <a class="header-anchor" href="#Nonlinear-Least-Squares" aria-label="Permalink to &quot;Nonlinear Least Squares {#Nonlinear-Least-Squares}&quot;">​</a></h2><p>Use when observations are Gaussian with mean given by an arbitrary (possibly nonlinear) function of the latent field: <code>y | x ~ Normal(f(x), σ)</code>.</p><p>Key properties</p><ul><li><p>Out-of-place <code>f</code>: define <code>f(x)::AbstractVector</code> with length equal to <code>length(y)</code>.</p></li><li><p>Gauss–Newton: gradient and Hessian use the Gauss–Newton approximation (no exact Hessian term).</p><ul><li><p><code>∇ℓ(x) = J(x)&#39; (w ⊙ r)</code>, where <code>r = y − f(x)</code>, <code>w = 1 ./ σ.^2</code></p></li><li><p><code>∇²ℓ(x) ≈ − J(x)&#39; Diagonal(w) J(x)</code></p></li></ul></li><li><p><code>σ</code>: accepts a scalar or vector (heteroskedastic), both interpreted as standard deviations.</p></li><li><p>Sparse autodiff: requires loading <code>SparseConnectivityTracer</code> and <code>SparseMatrixColorings</code> to activate the sparse Jacobian backend.</p></li></ul><p>Example</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> GaussianMarkovRandomFields</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> SparseConnectivityTracer, SparseMatrixColorings  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># activate sparse Jacobian backend</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Nonlinear mapping f: R^2 -&gt; R^3</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">f</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [x[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">x[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">sin</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]), x[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">^</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Observations and noise</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">y </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">σ </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># vector sigma allowed</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Build model and materialize likelihood</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">model </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> NonlinearLeastSquaresModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(f, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">lik </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> model</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(y; σ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">σ)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Evaluate</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">x </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ll </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> loglik</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x, lik)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">g  </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> loggrad</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x, lik)     </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># uses sparse DI.jacobian under the hood</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">H  </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> loghessian</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x, lik)  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Gauss–Newton: -J&#39; W J</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Conditional distribution p(y | x)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">dist </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> conditional_distribution</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(model, x; σ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>API</p><details class="jldocstring custom-block" open><summary><a id="GaussianMarkovRandomFields.NonlinearLeastSquaresModel" href="#GaussianMarkovRandomFields.NonlinearLeastSquaresModel"><span class="jlbinding">GaussianMarkovRandomFields.NonlinearLeastSquaresModel</span></a> <span class="VPBadge info jlObjectType jlType"><!--[-->Type<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NonlinearLeastSquaresModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(f, n)</span></span></code></pre></div><p>Observation model for nonlinear least squares with Gaussian noise: y | x ~ Normal(f(x), σ)</p><p>This model uses a Gauss–Newton approximation for the Hessian: ∇ℓ(x) = J(x)&#39; (w ⊙ r), where r = y - f(x), w = 1 ./ σ.^2 ∇²ℓ(x) ≈ -J(x)&#39; Diagonal(w) J(x)</p><p>Notes</p><ul><li><p>Requires the sparse-AD extension (SparseConnectivityTracer + SparseMatrixColorings) to be loaded. If missing, construction or evaluation will error with a clear message.</p></li><li><p><code>f</code> must be out-of-place with signature <code>f(x)::AbstractVector</code> of the same length as <code>y</code>.</p></li><li><p><code>σ</code> can be a scalar or a vector matching <code>length(y)</code> (heteroskedastic case). It must be positive.</p></li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/e87dd5e4ec510a2e45a9e3ca0055e1e83a026ef4/src/observation_models/nonlinear_least_squares.jl#L9-L24" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="GaussianMarkovRandomFields.NonlinearLeastSquaresLikelihood" href="#GaussianMarkovRandomFields.NonlinearLeastSquaresLikelihood"><span class="jlbinding">GaussianMarkovRandomFields.NonlinearLeastSquaresLikelihood</span></a> <span class="VPBadge info jlObjectType jlType"><!--[-->Type<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NonlinearLeastSquaresLikelihood </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ObservationLikelihood</span></span></code></pre></div><p>Materialized likelihood for NonlinearLeastSquaresModel with precomputed weights and cached sparse-Jacobian state. Hessian uses Gauss–Newton.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/e87dd5e4ec510a2e45a9e3ca0055e1e83a026ef4/src/observation_models/nonlinear_least_squares.jl#L30-L35" target="_blank" rel="noreferrer">source</a><!--]--></span></details><h2 id="Advanced-Features" tabindex="-1">Advanced Features <a class="header-anchor" href="#Advanced-Features" aria-label="Permalink to &quot;Advanced Features {#Advanced-Features}&quot;">​</a></h2><h3 id="Linear-Transformations-and-Design-Matrices" tabindex="-1">Linear Transformations and Design Matrices <a class="header-anchor" href="#Linear-Transformations-and-Design-Matrices" aria-label="Permalink to &quot;Linear Transformations and Design Matrices {#Linear-Transformations-and-Design-Matrices}&quot;">​</a></h3><p>For GLM-style modeling where observations are related to linear combinations of latent field components:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Design matrix mapping latent field to linear predictors</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Rows = observations, Columns = latent components</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">A </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  20.0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  1.0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  0.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;   </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># obs 1: intercept + temp + group1</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">     1.0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  25.0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  1.0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  0.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;   </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># obs 2: intercept + temp + group1  </span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">     1.0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  30.0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  0.0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  1.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]   </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># obs 3: intercept + temp + group2</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">base_model </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ExponentialFamily</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Poisson)  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># LogLink by default</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">obs_model </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> LinearlyTransformedObservationModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(base_model, A)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Latent field now includes all components: [β₀, β₁, u₁, u₂]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">x_full </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># intercept, slope, group effects</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">obs_lik </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> obs_model</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(y)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ll </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> loglik</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x_full, obs_lik)  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Chain rule applied automatically</span></span></code></pre></div><h3 id="Binomial-Observations" tabindex="-1">Binomial Observations <a class="header-anchor" href="#Binomial-Observations" aria-label="Permalink to &quot;Binomial Observations {#Binomial-Observations}&quot;">​</a></h3><p>For binomial data, use the <code>BinomialObservations</code> utility:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Create binomial observations with successes and trials</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">y </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> BinomialObservations</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">([</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">8</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">6</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># (successes, trials) pairs</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Use with Binomial model</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">binomial_model </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ExponentialFamily</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Binomial) </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">obs_lik </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> binomial_model</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(y)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Access components</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">successes</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(y)  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># [3, 1, 4]</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">trials</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(y)     </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># [5, 8, 6]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">y[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]          </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># (3, 5) - tuple access</span></span></code></pre></div><h3 id="Composite-Observations" tabindex="-1">Composite Observations <a class="header-anchor" href="#Composite-Observations" aria-label="Permalink to &quot;Composite Observations {#Composite-Observations}&quot;">​</a></h3><p>For multiple observation types in a single model:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Multiple observation vectors</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">count_data </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">binary_data </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">obs </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> CompositeObservations</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(count_data, binary_data)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Corresponding models for each observation type</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">poisson_model </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ExponentialFamily</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Poisson)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">bernoulli_model </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ExponentialFamily</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Bernoulli) </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">composite_model </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> CompositeObservationModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(poisson_model, bernoulli_model)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">obs_lik </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> composite_model</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(obs)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Latent field x now corresponds to concatenated observations</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ll </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> loglik</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x, obs_lik)</span></span></code></pre></div><h2 id="API-Reference" tabindex="-1">API Reference <a class="header-anchor" href="#API-Reference" aria-label="Permalink to &quot;API Reference {#API-Reference}&quot;">​</a></h2><h3 id="Core-Types-and-Interface" tabindex="-1">Core Types and Interface <a class="header-anchor" href="#Core-Types-and-Interface" aria-label="Permalink to &quot;Core Types and Interface {#Core-Types-and-Interface}&quot;">​</a></h3><details class="jldocstring custom-block" open><summary><a id="GaussianMarkovRandomFields.ObservationModel" href="#GaussianMarkovRandomFields.ObservationModel"><span class="jlbinding">GaussianMarkovRandomFields.ObservationModel</span></a> <span class="VPBadge info jlObjectType jlType"><!--[-->Type<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ObservationModel</span></span></code></pre></div><p>Abstract base type for all observation models for GMRFs.</p><p>An observation model defines the relationship between observations <code>y</code> and the latent field <code>x</code>, typically through a likelihood function. ObservationModel types serve as factories for creating ObservationLikelihood instances via callable syntax.</p><p><strong>Usage Pattern</strong></p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Step 1: Create observation model (factory)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">obs_model </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ExponentialFamily</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Normal)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Step 2: Materialize with data and hyperparameters</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">obs_lik </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> obs_model</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(y; σ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Creates ObservationLikelihood</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Step 3: Use materialized likelihood in hot loops</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ll </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> loglik</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x, obs_lik)  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Fast x-only evaluation</span></span></code></pre></div><p>See also: <a href="/GaussianMarkovRandomFields.jl/dev/reference/observation_models#GaussianMarkovRandomFields.ObservationLikelihood"><code>ObservationLikelihood</code></a>, <a href="/GaussianMarkovRandomFields.jl/dev/reference/observation_models#GaussianMarkovRandomFields.ExponentialFamily"><code>ExponentialFamily</code></a></p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/e87dd5e4ec510a2e45a9e3ca0055e1e83a026ef4/src/observation_models/observation_model.jl#L5-L27" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="GaussianMarkovRandomFields.ObservationLikelihood" href="#GaussianMarkovRandomFields.ObservationLikelihood"><span class="jlbinding">GaussianMarkovRandomFields.ObservationLikelihood</span></a> <span class="VPBadge info jlObjectType jlType"><!--[-->Type<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ObservationLikelihood</span></span></code></pre></div><p>Abstract base type for materialized observation likelihoods.</p><p>Observation likelihoods are created by materializing an observation model with specific hyperparameters θ and observed data y. They provide efficient evaluation methods that only depend on the latent field x, eliminating the need to repeatedly pass θ and y.</p><p>This design provides major performance benefits in optimization loops and cleaner automatic differentiation boundaries.</p><p><strong>Usage Pattern</strong></p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Step 1: Configure observation model (factory)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">obs_model </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ExponentialFamily</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Normal)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Step 2: Materialize with data and hyperparameters  </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">obs_lik </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> obs_model</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(y; σ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Step 3: Fast evaluation in hot loops</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ll </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> loglik</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x, obs_lik)      </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Only x argument needed!</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">grad </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> loggrad</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x, obs_lik)   </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Fast x-only evaluation</span></span></code></pre></div><span class="VPBadge info source-link"><!--[--><a href="https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/e87dd5e4ec510a2e45a9e3ca0055e1e83a026ef4/src/observation_models/observation_likelihood.jl#L7-L32" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="GaussianMarkovRandomFields.hyperparameters-Tuple{ObservationModel}" href="#GaussianMarkovRandomFields.hyperparameters-Tuple{ObservationModel}"><span class="jlbinding">GaussianMarkovRandomFields.hyperparameters</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">hyperparameters</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(obs_model</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ObservationModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Tuple{Vararg{Symbol}}</span></span></code></pre></div><p>Return a tuple of required hyperparameter names for this observation model.</p><p>This method defines which hyperparameters the observation model expects to receive when materializing an ObservationLikelihood instance.</p><p><strong>Arguments</strong></p><ul><li><code>obs_model</code>: An observation model implementing the <code>ObservationModel</code> interface</li></ul><p><strong>Returns</strong></p><ul><li><code>Tuple{Vararg{Symbol}}</code>: Tuple of parameter names (e.g., <code>(:σ,)</code> or <code>(:α, :β)</code>)</li></ul><p><strong>Example</strong></p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">hyperparameters</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ExponentialFamily</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Normal)) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:σ</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">hyperparameters</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ExponentialFamily</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Bernoulli)) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ()</span></span></code></pre></div><p><strong>Implementation</strong></p><p>All observation models should implement this method. The default returns an empty tuple.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/e87dd5e4ec510a2e45a9e3ca0055e1e83a026ef4/src/observation_models/observation_model.jl#L31-L53" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="GaussianMarkovRandomFields.latent_dimension" href="#GaussianMarkovRandomFields.latent_dimension"><span class="jlbinding">GaussianMarkovRandomFields.latent_dimension</span></a> <span class="VPBadge info jlObjectType jlFunction"><!--[-->Function<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">latent_dimension</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(obs_model</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ObservationModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, y</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">AbstractVector</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Union{Int, Nothing}</span></span></code></pre></div><p>Return the latent field dimension for this observation model given observations y.</p><p>For most observation models, this will be <code>length(y)</code> (1:1 mapping). For transformed observation models like <code>LinearlyTransformedObservationModel</code>, this will be the dimension of the design matrix.</p><p>Returns <code>nothing</code> if the latent dimension cannot be determined automatically.</p><p><strong>Arguments</strong></p><ul><li><p><code>obs_model</code>: An observation model implementing the <code>ObservationModel</code> interface</p></li><li><p><code>y</code>: Vector of observations</p></li></ul><p><strong>Returns</strong></p><ul><li><code>Int</code>: The latent field dimension, or <code>nothing</code> if unknown</li></ul><p><strong>Example</strong></p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">latent_dimension</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ExponentialFamily</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Normal), y) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> length</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(y)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">latent_dimension</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">LinearlyTransformedObservationModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(base, A), y) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> size</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(A, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><span class="VPBadge info source-link"><!--[--><a href="https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/e87dd5e4ec510a2e45a9e3ca0055e1e83a026ef4/src/observation_models/observation_model.jl#L56-L79" target="_blank" rel="noreferrer">source</a><!--]--></span><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">latent_dimension</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ef</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ExponentialFamily</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, y</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">AbstractVector</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Int</span></span></code></pre></div><p>Return the latent field dimension for exponential family models.</p><p>For ExponentialFamily models, there is a direct 1:1 mapping between observations and latent field components, so the latent dimension equals the observation dimension.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/e87dd5e4ec510a2e45a9e3ca0055e1e83a026ef4/src/observation_models/exponential_family/exponential_family.jl#L233-L240" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="GaussianMarkovRandomFields.loglik" href="#GaussianMarkovRandomFields.loglik"><span class="jlbinding">GaussianMarkovRandomFields.loglik</span></a> <span class="VPBadge info jlObjectType jlFunction"><!--[-->Function<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">loglik</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x, lik</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ExponentialFamilyLikelihood</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Float64</span></span></code></pre></div><p>Generic loglik implementation for all exponential family likelihoods using product_distribution.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/e87dd5e4ec510a2e45a9e3ca0055e1e83a026ef4/src/observation_models/exponential_family/canonical_implementations.jl#L12-L16" target="_blank" rel="noreferrer">source</a><!--]--></span><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">loglik</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x, lik</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NormalLikelihood</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Float64</span></span></code></pre></div><p>Specialized fast implementation for Normal likelihood that avoids product_distribution overhead.</p><p>Computes: ∑ᵢ logpdf(Normal(μᵢ, σ), yᵢ) = -n/2 * log(2π) - n * log(σ) - 1/(2σ²) * ∑ᵢ(yᵢ - μᵢ)²</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/e87dd5e4ec510a2e45a9e3ca0055e1e83a026ef4/src/observation_models/exponential_family/canonical_implementations.jl#L25-L31" target="_blank" rel="noreferrer">source</a><!--]--></span><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">loglik</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x, composite_lik</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">CompositeLikelihood</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Float64</span></span></code></pre></div><p>Compute the log-likelihood of a composite likelihood by summing component contributions.</p><p>Each component likelihood receives the full latent field <code>x</code> and contributes to the total log-likelihood. This handles cases where components may have overlapping dependencies on the latent field.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/e87dd5e4ec510a2e45a9e3ca0055e1e83a026ef4/src/observation_models/composite/composite_evaluation.jl#L8-L16" target="_blank" rel="noreferrer">source</a><!--]--></span><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">loglik</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x, obs_lik</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">AutoDiffLikelihood</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Real</span></span></code></pre></div><p>Evaluate the log-likelihood function at latent field <code>x</code>.</p><p>Calls the stored log-likelihood function, which typically includes all necessary hyperparameters and data as a closure.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/e87dd5e4ec510a2e45a9e3ca0055e1e83a026ef4/src/observation_models/autodiff_likelihood.jl#L224-L231" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="GaussianMarkovRandomFields.loggrad" href="#GaussianMarkovRandomFields.loggrad"><span class="jlbinding">GaussianMarkovRandomFields.loggrad</span></a> <span class="VPBadge info jlObjectType jlFunction"><!--[-->Function<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">loggrad</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x, obs_lik</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ObservationLikelihood</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Vector{Float64}</span></span></code></pre></div><p>Automatic differentiation fallback for ObservationLikelihood gradient computation.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/e87dd5e4ec510a2e45a9e3ca0055e1e83a026ef4/src/observation_models/observation_likelihood.jl#L45-L49" target="_blank" rel="noreferrer">source</a><!--]--></span><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">loggrad</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x, lik</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NormalLikelihood{IdentityLink}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Vector{Float64}</span></span></code></pre></div><p>Compute gradient of Normal likelihood with canonical identity link w.r.t. latent field x.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/e87dd5e4ec510a2e45a9e3ca0055e1e83a026ef4/src/observation_models/exponential_family/canonical_implementations.jl#L65-L69" target="_blank" rel="noreferrer">source</a><!--]--></span><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">loggrad</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x, lik</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">PoissonLikelihood{LogLink}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Vector{Float64}</span></span></code></pre></div><p>Compute gradient of Poisson likelihood with canonical log link w.r.t. latent field x.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/e87dd5e4ec510a2e45a9e3ca0055e1e83a026ef4/src/observation_models/exponential_family/canonical_implementations.jl#L77-L81" target="_blank" rel="noreferrer">source</a><!--]--></span><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">loggrad</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x, lik</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">BernoulliLikelihood{LogitLink}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Vector{Float64}</span></span></code></pre></div><p>Compute gradient of Bernoulli likelihood with canonical logit link w.r.t. latent field x.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/e87dd5e4ec510a2e45a9e3ca0055e1e83a026ef4/src/observation_models/exponential_family/canonical_implementations.jl#L90-L94" target="_blank" rel="noreferrer">source</a><!--]--></span><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">loggrad</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x, lik</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">BinomialLikelihood{LogitLink}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Vector{Float64}</span></span></code></pre></div><p>Compute gradient of Binomial likelihood with canonical logit link w.r.t. latent field x.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/e87dd5e4ec510a2e45a9e3ca0055e1e83a026ef4/src/observation_models/exponential_family/canonical_implementations.jl#L103-L107" target="_blank" rel="noreferrer">source</a><!--]--></span><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">loggrad</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x, lik</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ExponentialFamilyLikelihood</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Vector{Float64}</span></span></code></pre></div><p>Optimized chain rule implementation for exponential family likelihoods. Handles indexing via helper embedding.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/e87dd5e4ec510a2e45a9e3ca0055e1e83a026ef4/src/observation_models/exponential_family/fallback_implementations.jl#L13-L18" target="_blank" rel="noreferrer">source</a><!--]--></span><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">loggrad</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x, composite_lik</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">CompositeLikelihood</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Vector{Float64}</span></span></code></pre></div><p>Compute the gradient of the log-likelihood by summing component gradients.</p><p>Each component contributes its gradient with respect to the full latent field <code>x</code>. For overlapping dependencies, gradients are automatically summed at each latent field element.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/e87dd5e4ec510a2e45a9e3ca0055e1e83a026ef4/src/observation_models/composite/composite_evaluation.jl#L21-L28" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="GaussianMarkovRandomFields.loghessian" href="#GaussianMarkovRandomFields.loghessian"><span class="jlbinding">GaussianMarkovRandomFields.loghessian</span></a> <span class="VPBadge info jlObjectType jlFunction"><!--[-->Function<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">loghessian</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x, obs_lik</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ObservationLikelihood</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> AbstractMatrix{Float64}</span></span></code></pre></div><p>Automatic differentiation fallback for ObservationLikelihood Hessian computation.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/e87dd5e4ec510a2e45a9e3ca0055e1e83a026ef4/src/observation_models/observation_likelihood.jl#L68-L72" target="_blank" rel="noreferrer">source</a><!--]--></span><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">loghessian</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x, lik</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NormalLikelihood{IdentityLink}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Diagonal{Float64}</span></span></code></pre></div><p>Compute Hessian of Normal likelihood with canonical identity link w.r.t. latent field x.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/e87dd5e4ec510a2e45a9e3ca0055e1e83a026ef4/src/observation_models/exponential_family/canonical_implementations.jl#L119-L123" target="_blank" rel="noreferrer">source</a><!--]--></span><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">loghessian</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x, lik</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">PoissonLikelihood{LogLink}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Diagonal{Float64}</span></span></code></pre></div><p>Compute Hessian of Poisson likelihood with canonical log link w.r.t. latent field x.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/e87dd5e4ec510a2e45a9e3ca0055e1e83a026ef4/src/observation_models/exponential_family/canonical_implementations.jl#L129-L133" target="_blank" rel="noreferrer">source</a><!--]--></span><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">loghessian</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x, lik</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">BernoulliLikelihood{LogitLink}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Diagonal{Float64}</span></span></code></pre></div><p>Compute Hessian of Bernoulli likelihood with canonical logit link w.r.t. latent field x.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/e87dd5e4ec510a2e45a9e3ca0055e1e83a026ef4/src/observation_models/exponential_family/canonical_implementations.jl#L141-L145" target="_blank" rel="noreferrer">source</a><!--]--></span><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">loghessian</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x, lik</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">BinomialLikelihood{LogitLink}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Diagonal{Float64}</span></span></code></pre></div><p>Compute Hessian of Binomial likelihood with canonical logit link w.r.t. latent field x.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/e87dd5e4ec510a2e45a9e3ca0055e1e83a026ef4/src/observation_models/exponential_family/canonical_implementations.jl#L153-L157" target="_blank" rel="noreferrer">source</a><!--]--></span><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">loghessian</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x, lik</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ExponentialFamilyLikelihood</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Diagonal{Float64}</span></span></code></pre></div><p>Optimized chain rule implementation for exponential family likelihoods. Handles indexing via helper embedding.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/e87dd5e4ec510a2e45a9e3ca0055e1e83a026ef4/src/observation_models/exponential_family/fallback_implementations.jl#L27-L32" target="_blank" rel="noreferrer">source</a><!--]--></span><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">loghessian</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x, composite_lik</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">CompositeLikelihood</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> AbstractMatrix{Float64}</span></span></code></pre></div><p>Compute the Hessian of the log-likelihood by summing component Hessians.</p><p>Each component contributes its Hessian with respect to the full latent field <code>x</code>. For overlapping dependencies, Hessians are automatically summed element-wise.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/e87dd5e4ec510a2e45a9e3ca0055e1e83a026ef4/src/observation_models/composite/composite_evaluation.jl#L41-L48" target="_blank" rel="noreferrer">source</a><!--]--></span></details><h3 id="Exponential-Family-Models-2" tabindex="-1">Exponential Family Models <a class="header-anchor" href="#Exponential-Family-Models-2" aria-label="Permalink to &quot;Exponential Family Models {#Exponential-Family-Models-2}&quot;">​</a></h3><details class="jldocstring custom-block" open><summary><a id="GaussianMarkovRandomFields.ExponentialFamily" href="#GaussianMarkovRandomFields.ExponentialFamily"><span class="jlbinding">GaussianMarkovRandomFields.ExponentialFamily</span></a> <span class="VPBadge info jlObjectType jlType"><!--[-->Type<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ExponentialFamily{F</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Distribution</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, L</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">LinkFunction</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ObservationModel</span></span></code></pre></div><p>Observation model for exponential family distributions with link functions.</p><p>This struct represents observation models where the observations come from an exponential family distribution (Normal, Poisson, Bernoulli, Binomial) and the mean parameter is related to the latent field through a link function.</p><p><strong>Mathematical Model</strong></p><p>For observations yᵢ and latent field values xᵢ:</p><ul><li><p>Linear predictor: ηᵢ = xᵢ</p></li><li><p>Mean parameter: μᵢ = g⁻¹(ηᵢ) where g is the link function</p></li><li><p>Observations: yᵢ ~ F(μᵢ, θ) where F is the distribution family</p></li></ul><p><strong>Fields</strong></p><ul><li><p><code>family::Type{F}</code>: The distribution family (e.g., <code>Poisson</code>, <code>Bernoulli</code>)</p></li><li><p><code>link::L</code>: The link function connecting mean parameters to linear predictors</p></li></ul><p><strong>Type Parameters</strong></p><ul><li><p><code>F</code>: A subtype of <code>Distribution</code> from Distributions.jl</p></li><li><p><code>L</code>: A subtype of <code>LinkFunction</code></p></li></ul><p><strong>Constructors</strong></p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Use canonical link (recommended)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ExponentialFamily</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Poisson)        </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Uses LogLink()</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ExponentialFamily</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Bernoulli)      </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Uses LogitLink()</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ExponentialFamily</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Normal)         </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Uses IdentityLink()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Specify custom link function</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ExponentialFamily</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Poisson, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">IdentityLink</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">())  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Non-canonical</span></span></code></pre></div><p><strong>Supported Combinations</strong></p><ul><li><p><code>Normal</code> with <code>IdentityLink</code> (canonical) or <code>LogLink</code></p></li><li><p><code>Poisson</code> with <code>LogLink</code> (canonical) or <code>IdentityLink</code></p></li><li><p><code>Bernoulli</code> with <code>LogitLink</code> (canonical) or <code>LogLink</code></p></li><li><p><code>Binomial</code> with <code>LogitLink</code> (canonical) or <code>IdentityLink</code></p></li></ul><p><strong>Hyperparameters (θ)</strong></p><p>Different families require different hyperparameters:</p><ul><li><p><code>Normal</code>: <code>θ = [σ]</code> (standard deviation)</p></li><li><p><code>Poisson</code>: <code>θ = []</code> (no hyperparameters)</p></li><li><p><code>Bernoulli</code>: <code>θ = []</code> (no hyperparameters)</p></li><li><p><code>Binomial</code>: <code>θ = [n]</code> (number of trials)</p></li></ul><p><strong>Examples</strong></p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Poisson model for count data</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">model </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ExponentialFamily</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Poisson)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">x </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]        </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Latent field (log scale due to LogLink)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">θ </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Float64[]         </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># No hyperparameters  </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">y </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">7</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]           </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Count observations</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">obs_lik </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> obs_model</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(y; θ_named</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ll </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> loglik</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x, obs_lik)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">dist </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> conditional_distribution</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(model, x, θ)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Bernoulli model for binary data</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">model </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ExponentialFamily</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Bernoulli)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">x </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]       </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Latent field (logit scale due to LogitLink)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">y </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]           </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Binary observations</span></span></code></pre></div><p><strong>Performance Notes</strong></p><p>Canonical link functions have optimized implementations that avoid redundant computations. Non-canonical links use general chain rule formulations which may be slower.</p><p>See also: <a href="/GaussianMarkovRandomFields.jl/dev/reference/observation_models#GaussianMarkovRandomFields.LinkFunction"><code>LinkFunction</code></a>, <a href="/GaussianMarkovRandomFields.jl/dev/reference/observation_models#GaussianMarkovRandomFields.loglik"><code>loglik</code></a>, <a href="/GaussianMarkovRandomFields.jl/dev/reference/observation_models#GaussianMarkovRandomFields.conditional_distribution"><code>conditional_distribution</code></a></p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/e87dd5e4ec510a2e45a9e3ca0055e1e83a026ef4/src/observation_models/exponential_family/exponential_family.jl#L7-L78" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="GaussianMarkovRandomFields.conditional_distribution" href="#GaussianMarkovRandomFields.conditional_distribution"><span class="jlbinding">GaussianMarkovRandomFields.conditional_distribution</span></a> <span class="VPBadge info jlObjectType jlFunction"><!--[-->Function<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">conditional_distribution</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(obs_model</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ObservationModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, x; kwargs</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Distribution</span></span></code></pre></div><p>Construct the conditional distribution p(y | x, θ) for sampling new observations.</p><p>This function returns a Distribution object that represents the probability distribution over observations y given latent field values x and hyperparameters θ. It is used for sampling new observations from the observation model.</p><p><strong>Arguments</strong></p><ul><li><p><code>obs_model</code>: An observation model implementing the <code>ObservationModel</code> interface</p></li><li><p><code>x</code>: Latent field values (vector)</p></li><li><p><code>kwargs...</code>: Hyperparameters as keyword arguments</p></li></ul><p><strong>Returns</strong></p><p>Distribution object that can be used with <code>rand()</code> to generate observations</p><p><strong>Example</strong></p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">model </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ExponentialFamily</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Poisson)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">x </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">dist </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> conditional_distribution</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(model, x)  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Poisson has no hyperparameters</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">y </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> rand</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(dist)  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Sample observations</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># For Normal distribution with hyperparameters</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">model_normal </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ExponentialFamily</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Normal)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">x </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">dist </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> conditional_distribution</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(model_normal, x; σ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">y </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> rand</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(dist)  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Sample observations</span></span></code></pre></div><p><strong>Implementation</strong></p><p>All observation models should implement this method. The default throws an error.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/e87dd5e4ec510a2e45a9e3ca0055e1e83a026ef4/src/observation_models/observation_model.jl#L82-L115" target="_blank" rel="noreferrer">source</a><!--]--></span><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">conditional_distribution</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(obs_model</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ExponentialFamily</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, x; θ_named</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Distribution</span></span></code></pre></div><p>Construct the data-generating distribution p(y | x, θ).</p><p>This function returns a Distribution object that represents the probability distribution over observations y given latent field values x and hyperparameters θ. It is used for sampling new observations.</p><p><strong>Arguments</strong></p><ul><li><p><code>obs_model</code>: An ExponentialFamily observation model</p></li><li><p><code>x</code>: Latent field values (vector)</p></li><li><p><code>θ_named...</code>: Hyperparameters as keyword arguments</p></li></ul><p><strong>Returns</strong></p><p>Distribution object that can be used with <code>rand()</code> to generate observations</p><p><strong>Example</strong></p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">model </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ExponentialFamily</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Poisson)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">x </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">dist </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> conditional_distribution</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(model, x)  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Poisson has no hyperparameters</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">y </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> rand</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(dist)  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Sample observations</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># For Normal distribution with hyperparameters</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">model_normal </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ExponentialFamily</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Normal)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">x </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">dist </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> conditional_distribution</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(model_normal, x; σ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">y </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> rand</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(dist)  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Sample observations</span></span></code></pre></div><p>Note: This API now follows the same convention as materializing likelihoods:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">obs_lik </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> obs_model</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(y; θ_named</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Materialize likelihood</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ll </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> loglik</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x, obs_lik)             </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Evaluate likelihood</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">dist </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> conditional_distribution</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(obs_model, x; θ_named</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Create distribution</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">y_new </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> rand</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(dist)                  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Sample new data</span></span></code></pre></div><span class="VPBadge info source-link"><!--[--><a href="https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/e87dd5e4ec510a2e45a9e3ca0055e1e83a026ef4/src/observation_models/exponential_family/exponential_family.jl#L123-L161" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="GaussianMarkovRandomFields.ExponentialFamilyLikelihood" href="#GaussianMarkovRandomFields.ExponentialFamilyLikelihood"><span class="jlbinding">GaussianMarkovRandomFields.ExponentialFamilyLikelihood</span></a> <span class="VPBadge info jlObjectType jlType"><!--[-->Type<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ExponentialFamilyLikelihood{L, I} </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ObservationLikelihood</span></span></code></pre></div><p>Abstract type for exponential family observation likelihoods.</p><p>This intermediate type allows for generic implementations that work across all exponential family distributions while still allowing specialized methods for specific combinations.</p><p><strong>Type Parameters</strong></p><ul><li><p><code>L</code>: Link function type</p></li><li><p><code>I</code>: Index type (Nothing for non-indexed, UnitRange or Vector for indexed)</p></li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/e87dd5e4ec510a2e45a9e3ca0055e1e83a026ef4/src/observation_models/exponential_family/observation_likelihoods.jl#L3-L15" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="GaussianMarkovRandomFields.NormalLikelihood" href="#GaussianMarkovRandomFields.NormalLikelihood"><span class="jlbinding">GaussianMarkovRandomFields.NormalLikelihood</span></a> <span class="VPBadge info jlObjectType jlType"><!--[-->Type<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NormalLikelihood{L</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">LinkFunction</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ObservationLikelihood</span></span></code></pre></div><p>Materialized Normal observation likelihood with precomputed hyperparameters.</p><p><strong>Fields</strong></p><ul><li><p><code>link::L</code>: Link function connecting latent field to mean parameter</p></li><li><p><code>y::Vector{Float64}</code>: Observed data</p></li><li><p><code>σ::Float64</code>: Standard deviation hyperparameter</p></li><li><p><code>inv_σ²::Float64</code>: Precomputed 1/σ² for performance</p></li><li><p><code>log_σ::Float64</code>: Precomputed log(σ) for log-likelihood computation</p></li></ul><p><strong>Example</strong></p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">obs_model </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ExponentialFamily</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Normal)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">obs_lik </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> obs_model</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">([</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]; σ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># NormalLikelihood{IdentityLink}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ll </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> loglik</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">([</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.9</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2.1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], obs_lik)</span></span></code></pre></div><span class="VPBadge info source-link"><!--[--><a href="https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/e87dd5e4ec510a2e45a9e3ca0055e1e83a026ef4/src/observation_models/exponential_family/observation_likelihoods.jl#L18-L36" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="GaussianMarkovRandomFields.PoissonLikelihood" href="#GaussianMarkovRandomFields.PoissonLikelihood"><span class="jlbinding">GaussianMarkovRandomFields.PoissonLikelihood</span></a> <span class="VPBadge info jlObjectType jlType"><!--[-->Type<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">PoissonLikelihood{L</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">LinkFunction</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ObservationLikelihood</span></span></code></pre></div><p>Materialized Poisson observation likelihood.</p><p><strong>Fields</strong></p><ul><li><p><code>link::L</code>: Link function connecting latent field to rate parameter</p></li><li><p><code>y::Vector{Int}</code>: Count observations</p></li></ul><p><strong>Example</strong></p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">obs_model </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ExponentialFamily</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Poisson)  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Uses LogLink by default</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">obs_lik </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> obs_model</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">([</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])      </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># PoissonLikelihood{LogLink}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ll </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> loglik</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">([</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.7</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], obs_lik)  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># x values on log scale</span></span></code></pre></div><span class="VPBadge info source-link"><!--[--><a href="https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/e87dd5e4ec510a2e45a9e3ca0055e1e83a026ef4/src/observation_models/exponential_family/observation_likelihoods.jl#L46-L61" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="GaussianMarkovRandomFields.BernoulliLikelihood" href="#GaussianMarkovRandomFields.BernoulliLikelihood"><span class="jlbinding">GaussianMarkovRandomFields.BernoulliLikelihood</span></a> <span class="VPBadge info jlObjectType jlType"><!--[-->Type<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">BernoulliLikelihood{L</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">LinkFunction</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ObservationLikelihood</span></span></code></pre></div><p>Materialized Bernoulli observation likelihood for binary data.</p><p><strong>Fields</strong></p><ul><li><p><code>link::L</code>: Link function connecting latent field to probability parameter</p></li><li><p><code>y::Vector{Int}</code>: Binary observations (0 or 1)</p></li></ul><p><strong>Example</strong></p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">obs_model </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ExponentialFamily</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Bernoulli)  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Uses LogitLink by default</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">obs_lik </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> obs_model</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">([</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])        </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># BernoulliLikelihood{LogitLink}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ll </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> loglik</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">([</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.8</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], obs_lik)  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># x values on logit scale</span></span></code></pre></div><span class="VPBadge info source-link"><!--[--><a href="https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/e87dd5e4ec510a2e45a9e3ca0055e1e83a026ef4/src/observation_models/exponential_family/observation_likelihoods.jl#L69-L84" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="GaussianMarkovRandomFields.BinomialLikelihood" href="#GaussianMarkovRandomFields.BinomialLikelihood"><span class="jlbinding">GaussianMarkovRandomFields.BinomialLikelihood</span></a> <span class="VPBadge info jlObjectType jlType"><!--[-->Type<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">BinomialLikelihood{L</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">LinkFunction</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ObservationLikelihood</span></span></code></pre></div><p>Materialized Binomial observation likelihood.</p><p><strong>Fields</strong></p><ul><li><p><code>link::L</code>: Link function connecting latent field to probability parameter</p></li><li><p><code>y::Vector{Int}</code>: Number of successes for each trial</p></li><li><p><code>n::Vector{Int}</code>: Number of trials per observation (can vary across observations)</p></li></ul><p><strong>Example</strong></p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">obs_model </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ExponentialFamily</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Binomial)  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Uses LogitLink by default</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">obs_lik </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> obs_model</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">([</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]; trials</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">8</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">6</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># BinomialLikelihood{LogitLink}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ll </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> loglik</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">([</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.8</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], obs_lik)  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># x values on logit scale</span></span></code></pre></div><span class="VPBadge info source-link"><!--[--><a href="https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/e87dd5e4ec510a2e45a9e3ca0055e1e83a026ef4/src/observation_models/exponential_family/observation_likelihoods.jl#L91-L107" target="_blank" rel="noreferrer">source</a><!--]--></span></details><h3 id="Link-Functions" tabindex="-1">Link Functions <a class="header-anchor" href="#Link-Functions" aria-label="Permalink to &quot;Link Functions {#Link-Functions}&quot;">​</a></h3><details class="jldocstring custom-block" open><summary><a id="GaussianMarkovRandomFields.LinkFunction" href="#GaussianMarkovRandomFields.LinkFunction"><span class="jlbinding">GaussianMarkovRandomFields.LinkFunction</span></a> <span class="VPBadge info jlObjectType jlType"><!--[-->Type<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">LinkFunction</span></span></code></pre></div><p>Abstract base type for link functions used in exponential family models.</p><p>A link function g(μ) connects the mean parameter μ of a distribution to the linear predictor η through the relationship g(μ) = η, or equivalently μ = g⁻¹(η).</p><p><strong>Implemented Link Functions</strong></p><ul><li><p><a href="/GaussianMarkovRandomFields.jl/dev/reference/observation_models#GaussianMarkovRandomFields.IdentityLink"><code>IdentityLink</code></a>: g(μ) = μ (for Normal distributions)</p></li><li><p><a href="/GaussianMarkovRandomFields.jl/dev/reference/observation_models#GaussianMarkovRandomFields.LogLink"><code>LogLink</code></a>: g(μ) = log(μ) (for Poisson distributions)</p></li><li><p><a href="/GaussianMarkovRandomFields.jl/dev/reference/observation_models#GaussianMarkovRandomFields.LogitLink"><code>LogitLink</code></a>: g(μ) = logit(μ) (for Bernoulli/Binomial distributions)</p></li></ul><p><strong>Interface</strong></p><p>Concrete link functions must implement:</p><ul><li><p><code>apply_link(link, μ)</code>: Apply the link function g(μ)</p></li><li><p><code>apply_invlink(link, η)</code>: Apply the inverse link function g⁻¹(η)</p></li></ul><p>For performance in GMRF computations, they should also implement:</p><ul><li><p><code>derivative_invlink(link, η)</code>: First derivative of g⁻¹(η)</p></li><li><p><code>second_derivative_invlink(link, η)</code>: Second derivative of g⁻¹(η)</p></li></ul><p>See also: <a href="/GaussianMarkovRandomFields.jl/dev/reference/observation_models#GaussianMarkovRandomFields.ExponentialFamily"><code>ExponentialFamily</code></a>, <a href="/GaussianMarkovRandomFields.jl/dev/reference/observation_models#GaussianMarkovRandomFields.apply_link"><code>apply_link</code></a>, <a href="/GaussianMarkovRandomFields.jl/dev/reference/observation_models#GaussianMarkovRandomFields.apply_invlink"><code>apply_invlink</code></a></p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/e87dd5e4ec510a2e45a9e3ca0055e1e83a026ef4/src/observation_models/exponential_family/link_functions.jl#L6-L29" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="GaussianMarkovRandomFields.IdentityLink" href="#GaussianMarkovRandomFields.IdentityLink"><span class="jlbinding">GaussianMarkovRandomFields.IdentityLink</span></a> <span class="VPBadge info jlObjectType jlType"><!--[-->Type<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">IdentityLink </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> LinkFunction</span></span></code></pre></div><p>Identity link function: g(μ) = μ.</p><p>This is the canonical link for Normal distributions. The mean parameter μ is directly equal to the linear predictor η.</p><p><strong>Mathematical Definition</strong></p><ul><li><p>Link: g(μ) = μ</p></li><li><p>Inverse link: g⁻¹(η) = η</p></li><li><p>First derivative: d/dη g⁻¹(η) = 1</p></li><li><p>Second derivative: d²/dη² g⁻¹(η) = 0</p></li></ul><p><strong>Example</strong></p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">link </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> IdentityLink</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">μ </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> apply_invlink</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(link, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># μ = 1.5</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">η </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> apply_link</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(link, μ)       </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># η = 1.5</span></span></code></pre></div><p>See also: <a href="/GaussianMarkovRandomFields.jl/dev/reference/observation_models#GaussianMarkovRandomFields.LogLink"><code>LogLink</code></a>, <a href="/GaussianMarkovRandomFields.jl/dev/reference/observation_models#GaussianMarkovRandomFields.LogitLink"><code>LogitLink</code></a></p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/e87dd5e4ec510a2e45a9e3ca0055e1e83a026ef4/src/observation_models/exponential_family/link_functions.jl#L32-L54" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="GaussianMarkovRandomFields.LogLink" href="#GaussianMarkovRandomFields.LogLink"><span class="jlbinding">GaussianMarkovRandomFields.LogLink</span></a> <span class="VPBadge info jlObjectType jlType"><!--[-->Type<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">LogLink </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> LinkFunction</span></span></code></pre></div><p>Logarithmic link function: g(μ) = log(μ).</p><p>This is the canonical link for Poisson and Gamma distributions. It ensures the mean parameter μ remains positive by mapping the real-valued linear predictor η to μ = exp(η).</p><p><strong>Mathematical Definition</strong></p><ul><li><p>Link: g(μ) = log(μ)</p></li><li><p>Inverse link: g⁻¹(η) = exp(η)</p></li><li><p>First derivative: d/dη g⁻¹(η) = exp(η)</p></li><li><p>Second derivative: d²/dη² g⁻¹(η) = exp(η)</p></li></ul><p><strong>Example</strong></p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">link </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> LogLink</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">μ </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> apply_invlink</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(link, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># μ = exp(1.0) ≈ 2.718</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">η </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> apply_link</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(link, μ)       </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># η = log(μ) = 1.0</span></span></code></pre></div><p>See also: <a href="/GaussianMarkovRandomFields.jl/dev/reference/observation_models#GaussianMarkovRandomFields.IdentityLink"><code>IdentityLink</code></a>, <a href="/GaussianMarkovRandomFields.jl/dev/reference/observation_models#GaussianMarkovRandomFields.LogitLink"><code>LogitLink</code></a></p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/e87dd5e4ec510a2e45a9e3ca0055e1e83a026ef4/src/observation_models/exponential_family/link_functions.jl#L57-L80" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="GaussianMarkovRandomFields.LogitLink" href="#GaussianMarkovRandomFields.LogitLink"><span class="jlbinding">GaussianMarkovRandomFields.LogitLink</span></a> <span class="VPBadge info jlObjectType jlType"><!--[-->Type<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">LogitLink </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> LinkFunction</span></span></code></pre></div><p>Logit link function: g(μ) = logit(μ) = log(μ/(1-μ)).</p><p>This is the canonical link for Bernoulli and Binomial distributions. It maps probabilities μ ∈ (0,1) to the real line via the logistic transformation, ensuring μ = logistic(η) = 1/(1+exp(-η)) remains a valid probability.</p><p><strong>Mathematical Definition</strong></p><ul><li><p>Link: g(μ) = logit(μ) = log(μ/(1-μ))</p></li><li><p>Inverse link: g⁻¹(η) = logistic(η) = 1/(1+exp(-η))</p></li><li><p>First derivative: d/dη g⁻¹(η) = μ(1-μ) where μ = logistic(η)</p></li><li><p>Second derivative: d²/dη² g⁻¹(η) = μ(1-μ)(1-2μ)</p></li></ul><p><strong>Example</strong></p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">link </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> LogitLink</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">μ </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> apply_invlink</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(link, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># μ = logistic(0.0) = 0.5</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">η </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> apply_link</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(link, μ)       </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># η = logit(0.5) = 0.0</span></span></code></pre></div><p>See also: <a href="/GaussianMarkovRandomFields.jl/dev/reference/observation_models#GaussianMarkovRandomFields.IdentityLink"><code>IdentityLink</code></a>, <a href="/GaussianMarkovRandomFields.jl/dev/reference/observation_models#GaussianMarkovRandomFields.LogLink"><code>LogLink</code></a></p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/e87dd5e4ec510a2e45a9e3ca0055e1e83a026ef4/src/observation_models/exponential_family/link_functions.jl#L83-L106" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="GaussianMarkovRandomFields.apply_link" href="#GaussianMarkovRandomFields.apply_link"><span class="jlbinding">GaussianMarkovRandomFields.apply_link</span></a> <span class="VPBadge info jlObjectType jlFunction"><!--[-->Function<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">apply_link</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(link</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">LinkFunction</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, μ) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Real</span></span></code></pre></div><p>Apply the link function g(μ) to transform mean parameters to linear predictor scale.</p><p>This function computes η = g(μ), where g is the link function. This transformation is typically used to ensure the mean parameter satisfies appropriate constraints (e.g., positivity for Poisson, probability bounds for Bernoulli).</p><p><strong>Arguments</strong></p><ul><li><p><code>link</code>: A link function (IdentityLink, LogLink, or LogitLink)</p></li><li><p><code>μ</code>: Mean parameter value(s) in the natural parameter space</p></li></ul><p><strong>Returns</strong></p><p>The transformed value(s) η on the linear predictor scale</p><p><strong>Examples</strong></p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">apply_link</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">LogLink</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(), </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2.718</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)      </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ≈ 1.0</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">apply_link</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">LogitLink</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(), </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)      </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># = 0.0  </span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">apply_link</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">IdentityLink</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(), </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)   </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># = 1.5</span></span></code></pre></div><p>See also: <a href="/GaussianMarkovRandomFields.jl/dev/reference/observation_models#GaussianMarkovRandomFields.apply_invlink"><code>apply_invlink</code></a>, <a href="/GaussianMarkovRandomFields.jl/dev/reference/observation_models#GaussianMarkovRandomFields.LinkFunction"><code>LinkFunction</code></a></p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/e87dd5e4ec510a2e45a9e3ca0055e1e83a026ef4/src/observation_models/exponential_family/link_functions.jl#L109-L133" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="GaussianMarkovRandomFields.apply_invlink" href="#GaussianMarkovRandomFields.apply_invlink"><span class="jlbinding">GaussianMarkovRandomFields.apply_invlink</span></a> <span class="VPBadge info jlObjectType jlFunction"><!--[-->Function<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">apply_invlink</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(link</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">LinkFunction</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, η) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Real</span></span></code></pre></div><p>Apply the inverse link function g⁻¹(η) to transform linear predictor to mean parameters.</p><p>This function computes μ = g⁻¹(η), where g⁻¹ is the inverse link function. This is the primary transformation used in GMRF models to convert the latent field values to the natural parameter space of the observation distribution.</p><p><strong>Arguments</strong></p><ul><li><p><code>link</code>: A link function (IdentityLink, LogLink, or LogitLink)</p></li><li><p><code>η</code>: Linear predictor value(s)</p></li></ul><p><strong>Returns</strong></p><p>The transformed value(s) μ in the natural parameter space</p><p><strong>Examples</strong></p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">apply_invlink</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">LogLink</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(), </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)      </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ≈ 2.718 (= exp(1))</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">apply_invlink</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">LogitLink</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(), </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)    </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># = 0.5   (= logistic(0))</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">apply_invlink</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">IdentityLink</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(), </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># = 1.5</span></span></code></pre></div><p>See also: <a href="/GaussianMarkovRandomFields.jl/dev/reference/observation_models#GaussianMarkovRandomFields.apply_link"><code>apply_link</code></a>, <a href="/GaussianMarkovRandomFields.jl/dev/reference/observation_models#GaussianMarkovRandomFields.LinkFunction"><code>LinkFunction</code></a></p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/e87dd5e4ec510a2e45a9e3ca0055e1e83a026ef4/src/observation_models/exponential_family/link_functions.jl#L138-L162" target="_blank" rel="noreferrer">source</a><!--]--></span></details><h3 id="Custom-AutoDiff-Models" tabindex="-1">Custom AutoDiff Models <a class="header-anchor" href="#Custom-AutoDiff-Models" aria-label="Permalink to &quot;Custom AutoDiff Models {#Custom-AutoDiff-Models}&quot;">​</a></h3><details class="jldocstring custom-block" open><summary><a id="GaussianMarkovRandomFields.AutoDiffObservationModel" href="#GaussianMarkovRandomFields.AutoDiffObservationModel"><span class="jlbinding">GaussianMarkovRandomFields.AutoDiffObservationModel</span></a> <span class="VPBadge info jlObjectType jlType"><!--[-->Type<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">AutoDiffObservationModel{F, B, SB, H} </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ObservationModel</span></span></code></pre></div><p>Observation model that uses automatic differentiation for a user-provided log-likelihood function.</p><p>This serves as a factory for creating AutoDiffLikelihood instances. The user provides a log-likelihood function that can accept hyperparameters, and when materialized, creates a closure with the hyperparameters baked in.</p><p><strong>Type Parameters</strong></p><ul><li><p><code>F</code>: Type of the log-likelihood function</p></li><li><p><code>B</code>: Type of the AD backend for gradients</p></li><li><p><code>SB</code>: Type of the AD backend for Hessians</p></li><li><p><code>H</code>: Type of the hyperparameters tuple</p></li></ul><p><strong>Fields</strong></p><ul><li><p><code>loglik_func::F</code>: User-provided log-likelihood function with signature <code>(x; kwargs...) -&gt; Real</code></p></li><li><p><code>n_latent::Int</code>: Number of latent field components</p></li><li><p><code>grad_backend::B</code>: AD backend for gradient computation</p></li><li><p><code>hess_backend::SB</code>: AD backend for Hessian computation</p></li><li><p><code>hyperparams::H</code>: Tuple of hyperparameter names that this model expects</p></li></ul><p><strong>Usage</strong></p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Define your log-likelihood function with hyperparameters</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> my_loglik</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x; σ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, y</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    μ </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> x  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># or some transformation of x</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.5</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> sum</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">((y </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> μ)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.^</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> σ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">^</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> length</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(y) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(σ)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Create observation model specifying expected hyperparameters</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">obs_model </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> AutoDiffObservationModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(my_loglik; n_latent</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, hyperparams</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:σ</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:y</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Materialize with specific hyperparameters</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">obs_lik </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> obs_model</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(σ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, y</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.8</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Creates AutoDiffLikelihood</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Use normally</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ll </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> loglik</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x, obs_lik)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">grad </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> loggrad</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x, obs_lik)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">hess </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> loghessian</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x, obs_lik)</span></span></code></pre></div><p>See also: <a href="/GaussianMarkovRandomFields.jl/dev/reference/observation_models#GaussianMarkovRandomFields.AutoDiffLikelihood"><code>AutoDiffLikelihood</code></a>, <a href="/GaussianMarkovRandomFields.jl/dev/reference/observation_models#GaussianMarkovRandomFields.ObservationModel"><code>ObservationModel</code></a></p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/e87dd5e4ec510a2e45a9e3ca0055e1e83a026ef4/src/observation_models/autodiff_likelihood.jl#L66-L109" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="GaussianMarkovRandomFields.AutoDiffLikelihood" href="#GaussianMarkovRandomFields.AutoDiffLikelihood"><span class="jlbinding">GaussianMarkovRandomFields.AutoDiffLikelihood</span></a> <span class="VPBadge info jlObjectType jlType"><!--[-->Type<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">AutoDiffLikelihood{F, B, SB, GP, HP} </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ObservationLikelihood</span></span></code></pre></div><p>Automatic differentiation-based observation likelihood that wraps a user-provided log-likelihood function.</p><p>This is a materialized likelihood created from an AutoDiffObservationModel. The log-likelihood function is typically a closure that already includes hyperparameters and data.</p><p><strong>Type Parameters</strong></p><ul><li><p><code>F</code>: Type of the log-likelihood function (usually a closure)</p></li><li><p><code>B</code>: Type of the AD backend for gradients</p></li><li><p><code>SB</code>: Type of the AD backend for Hessians</p></li><li><p><code>GP</code>: Type of the gradient preparation object</p></li><li><p><code>HP</code>: Type of the Hessian preparation object</p></li></ul><p><strong>Fields</strong></p><ul><li><p><code>loglik_func::F</code>: Log-likelihood function with signature <code>(x) -&gt; Real</code></p></li><li><p><code>grad_backend::B</code>: AD backend for gradient computation</p></li><li><p><code>hess_backend::SB</code>: AD backend for Hessian computation</p></li><li><p><code>grad_prep::GP</code>: Preparation object for gradient computation</p></li><li><p><code>hess_prep::HP</code>: Preparation object for Hessian computation</p></li></ul><p><strong>Usage</strong></p><p>Typically created via AutoDiffObservationModel factory:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Define your log-likelihood function with hyperparameters</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> my_loglik</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x; σ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, y</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    μ </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> x  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># or some transformation of x</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.5</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> sum</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">((y </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> μ)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.^</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> σ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">^</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> length</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(y) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(σ)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Create observation model</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">obs_model </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> AutoDiffObservationModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(my_loglik, n_latent</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Materialize with data and hyperparameters</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">obs_lik </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> obs_model</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(σ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, y</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.8</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Creates AutoDiffLikelihood</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Use in the standard way</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">x </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.9</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ll </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> loglik</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x, obs_lik)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">grad </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> loggrad</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x, obs_lik)  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Uses prepared AD with optimal backends</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">hess </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> loghessian</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x, obs_lik)  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Automatically sparse when available!</span></span></code></pre></div><p><strong>Sparse Hessian Features</strong></p><p>The Hessian computation automatically:</p><ul><li><p>Detects sparsity pattern using TracerSparsityDetector</p></li><li><p>Uses greedy coloring for efficient computation</p></li><li><p>Returns a sparse matrix when beneficial</p></li><li><p>Falls back to dense computation for small problems</p></li></ul><p>See also: <a href="/GaussianMarkovRandomFields.jl/dev/reference/observation_models#GaussianMarkovRandomFields.loglik"><code>loglik</code></a>, <a href="/GaussianMarkovRandomFields.jl/dev/reference/observation_models#GaussianMarkovRandomFields.loggrad"><code>loggrad</code></a>, <a href="/GaussianMarkovRandomFields.jl/dev/reference/observation_models#GaussianMarkovRandomFields.loghessian"><code>loghessian</code></a></p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/e87dd5e4ec510a2e45a9e3ca0055e1e83a026ef4/src/observation_models/autodiff_likelihood.jl#L5-L57" target="_blank" rel="noreferrer">source</a><!--]--></span></details><h3 id="FEM-Helper-Functions" tabindex="-1">FEM Helper Functions <a class="header-anchor" href="#FEM-Helper-Functions" aria-label="Permalink to &quot;FEM Helper Functions {#FEM-Helper-Functions}&quot;">​</a></h3><details class="jldocstring custom-block" open><summary><a id="GaussianMarkovRandomFields.PointEvaluationObsModel" href="#GaussianMarkovRandomFields.PointEvaluationObsModel"><span class="jlbinding">GaussianMarkovRandomFields.PointEvaluationObsModel</span></a> <span class="VPBadge info jlObjectType jlFunction"><!--[-->Function<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">PointEvaluationObsModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fem</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">FEMDiscretization</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, points</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">AbstractMatrix</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, family</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Type{&lt;:Distribution}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> LinearlyTransformedObservationModel</span></span></code></pre></div><p>Create an observation model for observing function values at specified points using a FEM discretization.</p><p>This helper automatically constructs a <code>LinearlyTransformedObservationModel</code> where:</p><ul><li><p>The design matrix comes from <code>evaluation_matrix(fem, points)</code></p></li><li><p>The base observation model is <code>ExponentialFamily(family)</code></p></li></ul><p><strong>Arguments</strong></p><ul><li><p><code>fem</code>: FEM discretization defining the basis functions</p></li><li><p><code>points</code>: N×D matrix where each row is a spatial point to observe</p></li><li><p><code>family</code>: Distribution family for observations (e.g., <code>Normal</code>, <code>Poisson</code>)</p></li></ul><p><strong>Returns</strong></p><p><code>LinearlyTransformedObservationModel</code> ready for materialization with data</p><p><strong>Example</strong></p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Create FEM discretization</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">grid </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> generate_grid</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Triangle, (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ip </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Lagrange{RefTriangle, 1}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">qr </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> QuadratureRule{RefTriangle}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fem </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> FEMDiscretization</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(grid, ip, qr)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Observation points</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">points </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.5</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.7</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.9</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 3 points in 2D</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Create observation model for Poisson count data</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">obs_model </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> PointEvaluationObsModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fem, points, Poisson)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Materialize with data</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">y </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Count observations</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">obs_lik </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> obs_model</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(y)  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Ready for loglik evaluation</span></span></code></pre></div><span class="VPBadge info source-link"><!--[--><a href="https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/e87dd5e4ec510a2e45a9e3ca0055e1e83a026ef4/src/observation_models/fem_helpers.jl#L5-L40" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="GaussianMarkovRandomFields.PointDerivativeObsModel" href="#GaussianMarkovRandomFields.PointDerivativeObsModel"><span class="jlbinding">GaussianMarkovRandomFields.PointDerivativeObsModel</span></a> <span class="VPBadge info jlObjectType jlFunction"><!--[-->Function<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">PointDerivativeObsModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fem</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">FEMDiscretization</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, points</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">AbstractMatrix</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, family</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Type{&lt;:Distribution}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; derivative_idcs</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">nothing</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> LinearlyTransformedObservationModel</span></span></code></pre></div><p>Create an observation model for observing first derivatives at specified points using a FEM discretization.</p><p>This helper automatically constructs a <code>LinearlyTransformedObservationModel</code> where:</p><ul><li><p>The design matrix comes from <code>derivative_matrices(fem, points; derivative_idcs)</code></p></li><li><p>The base observation model is <code>ExponentialFamily(family)</code></p></li></ul><p><strong>Arguments</strong></p><ul><li><p><code>fem</code>: FEM discretization defining the basis functions</p></li><li><p><code>points</code>: N×D matrix where each row is a spatial point to observe derivatives</p></li><li><p><code>family</code>: Distribution family for observations (e.g., <code>Normal</code>, <code>Poisson</code>)</p></li></ul><p><strong>Keywords</strong></p><ul><li><code>derivative_idcs</code>: Indices of partial derivatives to compute. Defaults to <code>[1, 2, ..., ndim(fem)]</code> (all spatial directions)</li></ul><p><strong>Returns</strong></p><p><code>LinearlyTransformedObservationModel</code> ready for materialization with data</p><p><strong>Example</strong></p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Create observation model for x-derivatives of a 2D function</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">obs_model </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> PointDerivativeObsModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fem, points, Normal; derivative_idcs</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Or observe both x and y derivatives</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">obs_model </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> PointDerivativeObsModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fem, points, Normal; derivative_idcs</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># This creates concatenated observations: [∂u/∂x at all points, ∂u/∂y at all points]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Materialize with gradient data</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">y </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># [∂u/∂x₁, ∂u/∂x₂, ∂u/∂x₃, ∂u/∂y₁, ∂u/∂y₂, ∂u/∂y₃]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">obs_lik </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> obs_model</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(y; σ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><span class="VPBadge info source-link"><!--[--><a href="https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/e87dd5e4ec510a2e45a9e3ca0055e1e83a026ef4/src/observation_models/fem_helpers.jl#L47-L80" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="GaussianMarkovRandomFields.PointSecondDerivativeObsModel" href="#GaussianMarkovRandomFields.PointSecondDerivativeObsModel"><span class="jlbinding">GaussianMarkovRandomFields.PointSecondDerivativeObsModel</span></a> <span class="VPBadge info jlObjectType jlFunction"><!--[-->Function<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">PointSecondDerivativeObsModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fem</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">FEMDiscretization</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, points</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">AbstractMatrix</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, family</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Type{&lt;:Distribution}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; derivative_idcs</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">nothing</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> LinearlyTransformedObservationModel</span></span></code></pre></div><p>Create an observation model for observing second derivatives at specified points using a FEM discretization.</p><p>This helper automatically constructs a <code>LinearlyTransformedObservationModel</code> where:</p><ul><li><p>The design matrix comes from <code>second_derivative_matrices(fem, points; derivative_idcs)</code></p></li><li><p>The base observation model is <code>ExponentialFamily(family)</code></p></li></ul><p><strong>Arguments</strong></p><ul><li><p><code>fem</code>: FEM discretization defining the basis functions</p></li><li><p><code>points</code>: N×D matrix where each row is a spatial point to observe second derivatives</p></li><li><p><code>family</code>: Distribution family for observations (e.g., <code>Normal</code>, <code>Poisson</code>)</p></li></ul><p><strong>Keywords</strong></p><ul><li><code>derivative_idcs</code>: Indices of second partial derivatives to compute. Defaults to diagonal terms <code>[(1,1), (2,2), ...]</code> up to <code>ndim(fem)</code></li></ul><p><strong>Returns</strong></p><p><code>LinearlyTransformedObservationModel</code> ready for materialization with data</p><p><strong>Example</strong></p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Create observation model for Laplacian (∂²u/∂x² + ∂²u/∂y²) observations</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">obs_model </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> PointSecondDerivativeObsModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fem, points, Normal; derivative_idcs</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)])</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Materialize with Laplacian data</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">y </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.05</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.15</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.05</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># [∂²u/∂x²₁, ∂²u/∂x²₂, ∂²u/∂x²₃, ∂²u/∂y²₁, ∂²u/∂y²₂, ∂²u/∂y²₃]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">obs_lik </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> obs_model</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(y; σ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.01</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><span class="VPBadge info source-link"><!--[--><a href="https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/e87dd5e4ec510a2e45a9e3ca0055e1e83a026ef4/src/observation_models/fem_helpers.jl#L99-L128" target="_blank" rel="noreferrer">source</a><!--]--></span></details><h3 id="Advanced-Features-2" tabindex="-1">Advanced Features <a class="header-anchor" href="#Advanced-Features-2" aria-label="Permalink to &quot;Advanced Features {#Advanced-Features-2}&quot;">​</a></h3><details class="jldocstring custom-block" open><summary><a id="GaussianMarkovRandomFields.LinearlyTransformedObservationModel" href="#GaussianMarkovRandomFields.LinearlyTransformedObservationModel"><span class="jlbinding">GaussianMarkovRandomFields.LinearlyTransformedObservationModel</span></a> <span class="VPBadge info jlObjectType jlType"><!--[-->Type<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">LinearlyTransformedObservationModel{M, A} </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ObservationModel</span></span></code></pre></div><p>Observation model that applies a linear transformation to the latent field before passing to a base observation model. This enables GLM-style modeling with design matrices while maintaining full compatibility with existing observation models.</p><p><strong>Mathematical Foundation</strong></p><p>The wrapper transforms the full latent field x_full to linear predictors η via a design matrix A:</p><ul><li><p>η = A * x_full</p></li><li><p>Base model operates on η as usual: p(y | η, θ)</p></li><li><p>Chain rule applied for gradients/Hessians:</p><ul><li><p>∇_{x_full} ℓ = A^T ∇_η ℓ</p></li><li><p>∇²_{x_full} ℓ = A^T ∇²_η ℓ A</p></li></ul></li></ul><p><strong>Type Parameters</strong></p><ul><li><p><code>M &lt;: ObservationModel</code>: Type of the base observation model</p></li><li><p><code>A</code>: Type of the design matrix (typically AbstractMatrix)</p></li></ul><p><strong>Fields</strong></p><ul><li><p><code>base_model::M</code>: The underlying observation model that operates on linear predictors</p></li><li><p><code>design_matrix::A</code>: Matrix mapping full latent field to observation-specific linear predictors</p></li></ul><p><strong>Usage Pattern</strong></p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Step 1: Create base observation model</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">base_model </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ExponentialFamily</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Poisson)  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># LogLink by default</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Step 2: Create design matrix (maps latent field to linear predictors)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># For: y ~ intercept + temperature + group_effects</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">A </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  20.0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  1.0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  0.0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  0.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;   </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># obs 1: intercept + temp + group1</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">     1.0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  25.0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  1.0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  0.0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  0.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;   </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># obs 2: intercept + temp + group1  </span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">     1.0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  30.0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  0.0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  1.0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  0.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;   </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># obs 3: intercept + temp + group2</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">     1.0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  15.0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  0.0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  0.0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  1.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]   </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># obs 4: intercept + temp + group3</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Step 3: Create wrapped model</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">obs_model </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> LinearlyTransformedObservationModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(base_model, A)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Step 4: Use in GMRF model - latent field now includes all components</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># x_full = [β₀, β₁, u₁, u₂, u₃]  # intercept, slope, group effects</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Step 5: Materialize with data and hyperparameters</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">obs_lik </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> obs_model</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(y; σ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Creates LinearlyTransformedLikelihood</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Step 6: Fast evaluation in optimization loops</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ll </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> loglik</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x_full, obs_lik)</span></span></code></pre></div><p><strong>Hyperparameters</strong></p><p>All hyperparameters come from the base observation model. The design matrix introduces no new hyperparameters - it&#39;s a fixed linear transformation.</p><p>See also: <a href="/GaussianMarkovRandomFields.jl/dev/reference/observation_models#GaussianMarkovRandomFields.LinearlyTransformedLikelihood"><code>LinearlyTransformedLikelihood</code></a>, <a href="/GaussianMarkovRandomFields.jl/dev/reference/observation_models#GaussianMarkovRandomFields.ExponentialFamily"><code>ExponentialFamily</code></a>, <a href="/GaussianMarkovRandomFields.jl/dev/reference/observation_models#GaussianMarkovRandomFields.ObservationModel"><code>ObservationModel</code></a></p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/e87dd5e4ec510a2e45a9e3ca0055e1e83a026ef4/src/observation_models/linearly_transformed.jl#L6-L60" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="GaussianMarkovRandomFields.LinearlyTransformedLikelihood" href="#GaussianMarkovRandomFields.LinearlyTransformedLikelihood"><span class="jlbinding">GaussianMarkovRandomFields.LinearlyTransformedLikelihood</span></a> <span class="VPBadge info jlObjectType jlType"><!--[-->Type<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">LinearlyTransformedLikelihood{L, A} </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ObservationLikelihood</span></span></code></pre></div><p>Materialized likelihood for LinearlyTransformedObservationModel with precomputed base likelihood and design matrix.</p><p>This is created by calling a LinearlyTransformedObservationModel instance with data and hyperparameters, following the factory pattern used throughout the package.</p><p><strong>Type Parameters</strong></p><ul><li><p><code>L &lt;: ObservationLikelihood</code>: Type of the materialized base likelihood</p></li><li><p><code>A</code>: Type of the design matrix</p></li></ul><p><strong>Fields</strong></p><ul><li><p><code>base_likelihood::L</code>: Materialized base observation likelihood (contains y and θ)</p></li><li><p><code>design_matrix::A</code>: Design matrix mapping full latent field to linear predictors</p></li></ul><p><strong>Usage</strong></p><p>This type is typically created automatically:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ltom </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> LinearlyTransformedObservationModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(base_model, design_matrix)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ltlik </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ltom</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(y; σ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Creates LinearlyTransformedLikelihood</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ll </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> loglik</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x_full, ltlik)  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Fast evaluation</span></span></code></pre></div><span class="VPBadge info source-link"><!--[--><a href="https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/e87dd5e4ec510a2e45a9e3ca0055e1e83a026ef4/src/observation_models/linearly_transformed.jl#L81-L105" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="GaussianMarkovRandomFields.BinomialObservations" href="#GaussianMarkovRandomFields.BinomialObservations"><span class="jlbinding">GaussianMarkovRandomFields.BinomialObservations</span></a> <span class="VPBadge info jlObjectType jlType"><!--[-->Type<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">BinomialObservations </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> AbstractVector{Tuple{Int, Int}}</span></span></code></pre></div><p>Combined observation type for binomial data containing both successes and trials.</p><p>This type packages binomial observation data (number of successes and trials) into a single vector-like object where each element is a (successes, trials) tuple.</p><p><strong>Fields</strong></p><ul><li><p><code>successes::Vector{Int}</code>: Number of successes for each observation</p></li><li><p><code>trials::Vector{Int}</code>: Number of trials for each observation</p></li></ul><p><strong>Example</strong></p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Create binomial observations</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">y </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> BinomialObservations</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">([</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">8</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">6</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Access as tuples</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">y[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># (3, 5)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">y[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># (1, 8)</span></span></code></pre></div><span class="VPBadge info source-link"><!--[--><a href="https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/e87dd5e4ec510a2e45a9e3ca0055e1e83a026ef4/src/observation_models/binomial_observations.jl#L3-L24" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="GaussianMarkovRandomFields.successes" href="#GaussianMarkovRandomFields.successes"><span class="jlbinding">GaussianMarkovRandomFields.successes</span></a> <span class="VPBadge info jlObjectType jlFunction"><!--[-->Function<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">successes</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(y</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">BinomialObservations</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Vector{Int}</span></span></code></pre></div><p>Extract the successes vector from binomial observations.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/e87dd5e4ec510a2e45a9e3ca0055e1e83a026ef4/src/observation_models/binomial_observations.jl#L61-L65" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="GaussianMarkovRandomFields.trials" href="#GaussianMarkovRandomFields.trials"><span class="jlbinding">GaussianMarkovRandomFields.trials</span></a> <span class="VPBadge info jlObjectType jlFunction"><!--[-->Function<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">trials</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(y</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">BinomialObservations</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Vector{Int}</span></span></code></pre></div><p>Extract the trials vector from binomial observations.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/e87dd5e4ec510a2e45a9e3ca0055e1e83a026ef4/src/observation_models/binomial_observations.jl#L68-L72" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="GaussianMarkovRandomFields.CompositeObservations" href="#GaussianMarkovRandomFields.CompositeObservations"><span class="jlbinding">GaussianMarkovRandomFields.CompositeObservations</span></a> <span class="VPBadge info jlObjectType jlType"><!--[-->Type<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">CompositeObservations{T</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Tuple</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> AbstractVector{Float64}</span></span></code></pre></div><p>A composite observation vector that stores observation data as a tuple of component vectors.</p><p>This type implements the <code>AbstractVector</code> interface and allows combining different observation datasets while maintaining their structure. The composite vector presents a unified view where indexing delegates to the appropriate component vector.</p><p><strong>Fields</strong></p><ul><li><code>components::T</code>: Tuple of observation vectors, one per likelihood component</li></ul><p><strong>Example</strong></p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">y1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Gaussian observations</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">y2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]       </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># More Gaussian observations</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">y_composite </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> CompositeObservations</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">((y1, y2))</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">length</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(y_composite)    </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 5</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">y_composite[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]         </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 1.0</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">y_composite[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]         </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 4.0</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">collect</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(y_composite)   </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># [1.0, 2.0, 3.0, 4.0, 5.0]</span></span></code></pre></div><span class="VPBadge info source-link"><!--[--><a href="https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/e87dd5e4ec510a2e45a9e3ca0055e1e83a026ef4/src/observation_models/composite/composite_observations.jl#L1-L24" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="GaussianMarkovRandomFields.CompositeObservationModel" href="#GaussianMarkovRandomFields.CompositeObservationModel"><span class="jlbinding">GaussianMarkovRandomFields.CompositeObservationModel</span></a> <span class="VPBadge info jlObjectType jlType"><!--[-->Type<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">CompositeObservationModel{T</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Tuple</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ObservationModel</span></span></code></pre></div><p>An observation model that combines multiple component observation models.</p><p>This type follows the factory pattern - it stores component observation models and creates <code>CompositeLikelihood</code> instances when called with observation data and hyperparameters.</p><p><strong>Fields</strong></p><ul><li><code>components::T</code>: Tuple of component observation models for type stability</li></ul><p><strong>Example</strong></p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">gaussian_model </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ExponentialFamily</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Normal)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">poisson_model </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ExponentialFamily</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Poisson)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">composite_model </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> CompositeObservationModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">((gaussian_model, poisson_model))</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Materialize with data and hyperparameters</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">y_composite </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> CompositeObservations</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(([</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">composite_lik </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> composite_model</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(y_composite; σ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><span class="VPBadge info source-link"><!--[--><a href="https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/e87dd5e4ec510a2e45a9e3ca0055e1e83a026ef4/src/observation_models/composite/composite_observation_model.jl#L1-L22" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="GaussianMarkovRandomFields.CompositeLikelihood" href="#GaussianMarkovRandomFields.CompositeLikelihood"><span class="jlbinding">GaussianMarkovRandomFields.CompositeLikelihood</span></a> <span class="VPBadge info jlObjectType jlType"><!--[-->Type<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">CompositeLikelihood{T</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Tuple</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ObservationLikelihood</span></span></code></pre></div><p>A materialized composite likelihood that combines multiple component likelihoods.</p><p>Created by calling a <code>CompositeObservationModel</code> with observation data and hyperparameters. Provides efficient evaluation of log-likelihood, gradient, and Hessian by summing contributions from all component likelihoods.</p><p><strong>Fields</strong></p><ul><li><code>components::T</code>: Tuple of materialized component likelihoods</li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/e87dd5e4ec510a2e45a9e3ca0055e1e83a026ef4/src/observation_models/composite/composite_observation_model.jl#L34-L45" target="_blank" rel="noreferrer">source</a><!--]--></span></details></div></div></main><footer class="VPDocFooter" data-v-83890dd9 data-v-4f9813fa><!--[--><!--]--><div class="edit-info" data-v-4f9813fa><div class="edit-link" data-v-4f9813fa><a class="VPLink link vp-external-link-icon no-icon edit-link-button" href="https://github.com/timweiland/GaussianMarkovRandomFields.jl/edit/main/docs/src/reference/observation_models.md" target="_blank" rel="noreferrer" data-v-4f9813fa><!--[--><span class="vpi-square-pen edit-link-icon" data-v-4f9813fa></span> Edit this page<!--]--></a></div><!----></div><nav class="prev-next" aria-labelledby="doc-footer-aria-label" data-v-4f9813fa><span class="visually-hidden" id="doc-footer-aria-label" data-v-4f9813fa>Pager</span><div class="pager" data-v-4f9813fa><a class="VPLink link pager-link prev" href="/GaussianMarkovRandomFields.jl/dev/reference/latent_models" data-v-4f9813fa><!--[--><span class="desc" data-v-4f9813fa>Previous page</span><span class="title" data-v-4f9813fa>Latent Models</span><!--]--></a></div><div class="pager" data-v-4f9813fa><a class="VPLink link pager-link next" href="/GaussianMarkovRandomFields.jl/dev/reference/gaussian_approximation" data-v-4f9813fa><!--[--><span class="desc" data-v-4f9813fa>Next page</span><span class="title" data-v-4f9813fa>Gaussian Approximation</span><!--]--></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><footer class="VPFooter has-sidebar" data-v-a9a9e638 data-v-c970a860><div class="container" data-v-c970a860><p class="message" data-v-c970a860>Made with <a href="https://luxdl.github.io/DocumenterVitepress.jl/dev/" target="_blank"><strong>DocumenterVitepress.jl</strong></a><br></p><p class="copyright" data-v-c970a860>© Copyright 2025.</p></div></footer><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"bibliography.md\":\"DInEruNy\",\"dev-docs_discretizations.md\":\"ECQ83iBN\",\"dev-docs_index.md\":\"Cv2x46gl\",\"dev-docs_solvers.md\":\"PfYJ_Bwq\",\"dev-docs_spdes.md\":\"xszPiOu_\",\"index.md\":\"hof8FWos\",\"reference_autodiff.md\":\"DPkNHwEM\",\"reference_autoregressive.md\":\"Bc4-LPLX\",\"reference_discretizations.md\":\"klC_fdJ3\",\"reference_formula.md\":\"CYGcXtdN\",\"reference_gaussian_approximation.md\":\"DMFoj6bw\",\"reference_gmrfs.md\":\"BzTs1zki\",\"reference_hard_constraints.md\":\"vSqqk8db\",\"reference_index.md\":\"D3jZzmFP\",\"reference_latent_models.md\":\"AN4wLO9H\",\"reference_linear_maps.md\":\"CMBApdR4\",\"reference_meshes.md\":\"C02-5j0X\",\"reference_observation_models.md\":\"Cy0qdkzq\",\"reference_plotting.md\":\"CePKBmw9\",\"reference_preconditioners.md\":\"DLv5mfIi\",\"reference_solvers.md\":\"pFXyQP-A\",\"reference_spatial_utils.md\":\"CbgMkXrZ\",\"reference_spdes.md\":\"B2W7anQK\",\"tutorials_autoregressive_models.md\":\"BmHb5aQw\",\"tutorials_bernoulli_spatial_classification.md\":\"DfHDgJHN\",\"tutorials_boundary_conditions.md\":\"DPxLRVng\",\"tutorials_bym_scotland_lip_cancer.md\":\"CHo2GcrK\",\"tutorials_index.md\":\"DTYP_L0p\",\"tutorials_spatial_modelling_spdes.md\":\"CrOqtium\",\"tutorials_spatiotemporal_modelling.md\":\"DNn37s3f\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"GMRFs.jl\",\"description\":\"Documentation for GaussianMarkovRandomFields.jl\",\"base\":\"/GaussianMarkovRandomFields.jl/dev/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"outline\":\"deep\",\"logo\":{\"src\":\"/logo.svg\",\"width\":24,\"height\":24},\"search\":{\"provider\":\"local\",\"options\":{\"detailedView\":true}},\"nav\":[{\"text\":\"Home\",\"link\":\"/index\"},{\"text\":\"Tutorials\",\"collapsed\":false,\"items\":[{\"text\":\"Overview\",\"link\":\"/tutorials/index\"},{\"text\":\"Building autoregressive models\",\"link\":\"/tutorials/autoregressive_models\"},{\"text\":\"Spatial Modelling with SPDEs\",\"link\":\"/tutorials/spatial_modelling_spdes\"},{\"text\":\"Spatiotemporal Modelling with SPDEs\",\"link\":\"/tutorials/spatiotemporal_modelling\"},{\"text\":\"Boundary Conditions for SPDEs\",\"link\":\"/tutorials/boundary_conditions\"},{\"text\":\"Bernoulli Spatial Classification with a Matérn Field\",\"link\":\"/tutorials/bernoulli_spatial_classification\"},{\"text\":\"Advanced GMRF modelling for disease mapping\",\"link\":\"/tutorials/bym_scotland_lip_cancer\"}]},{\"text\":\"API Reference\",\"collapsed\":false,\"items\":[{\"text\":\"Overview\",\"link\":\"/reference/index\"},{\"text\":\"GMRFs\",\"link\":\"/reference/gmrfs\"},{\"text\":\"Latent Models\",\"link\":\"/reference/latent_models\"},{\"text\":\"Observation Models\",\"link\":\"/reference/observation_models\"},{\"text\":\"Gaussian Approximation\",\"link\":\"/reference/gaussian_approximation\"},{\"text\":\"Hard Constraints\",\"link\":\"/reference/hard_constraints\"},{\"text\":\"SPDEs\",\"link\":\"/reference/spdes\"},{\"text\":\"Discretizations\",\"link\":\"/reference/discretizations\"},{\"text\":\"Meshes\",\"link\":\"/reference/meshes\"},{\"text\":\"Plotting\",\"link\":\"/reference/plotting\"},{\"text\":\"Solvers\",\"link\":\"/reference/solvers\"},{\"text\":\"Autoregressive Models\",\"link\":\"/reference/autoregressive\"},{\"text\":\"Linear maps\",\"link\":\"/reference/linear_maps\"},{\"text\":\"Preconditioners\",\"link\":\"/reference/preconditioners\"}]},{\"text\":\"Bibliography\",\"link\":\"/bibliography\"},{\"text\":\"Developer Documentation\",\"collapsed\":false,\"items\":[{\"text\":\"Overview\",\"link\":\"/dev-docs/index\"},{\"text\":\"Solvers\",\"link\":\"/dev-docs/solvers\"},{\"text\":\"SPDEs\",\"link\":\"/dev-docs/spdes\"},{\"text\":\"Discretizations\",\"link\":\"/dev-docs/discretizations\"}]},{\"component\":\"VersionPicker\"}],\"sidebar\":[{\"text\":\"Home\",\"link\":\"/index\"},{\"text\":\"Tutorials\",\"collapsed\":false,\"items\":[{\"text\":\"Overview\",\"link\":\"/tutorials/index\"},{\"text\":\"Building autoregressive models\",\"link\":\"/tutorials/autoregressive_models\"},{\"text\":\"Spatial Modelling with SPDEs\",\"link\":\"/tutorials/spatial_modelling_spdes\"},{\"text\":\"Spatiotemporal Modelling with SPDEs\",\"link\":\"/tutorials/spatiotemporal_modelling\"},{\"text\":\"Boundary Conditions for SPDEs\",\"link\":\"/tutorials/boundary_conditions\"},{\"text\":\"Bernoulli Spatial Classification with a Matérn Field\",\"link\":\"/tutorials/bernoulli_spatial_classification\"},{\"text\":\"Advanced GMRF modelling for disease mapping\",\"link\":\"/tutorials/bym_scotland_lip_cancer\"}]},{\"text\":\"API Reference\",\"collapsed\":false,\"items\":[{\"text\":\"Overview\",\"link\":\"/reference/index\"},{\"text\":\"GMRFs\",\"link\":\"/reference/gmrfs\"},{\"text\":\"Latent Models\",\"link\":\"/reference/latent_models\"},{\"text\":\"Observation Models\",\"link\":\"/reference/observation_models\"},{\"text\":\"Gaussian Approximation\",\"link\":\"/reference/gaussian_approximation\"},{\"text\":\"Hard Constraints\",\"link\":\"/reference/hard_constraints\"},{\"text\":\"SPDEs\",\"link\":\"/reference/spdes\"},{\"text\":\"Discretizations\",\"link\":\"/reference/discretizations\"},{\"text\":\"Meshes\",\"link\":\"/reference/meshes\"},{\"text\":\"Plotting\",\"link\":\"/reference/plotting\"},{\"text\":\"Solvers\",\"link\":\"/reference/solvers\"},{\"text\":\"Autoregressive Models\",\"link\":\"/reference/autoregressive\"},{\"text\":\"Linear maps\",\"link\":\"/reference/linear_maps\"},{\"text\":\"Preconditioners\",\"link\":\"/reference/preconditioners\"}]},{\"text\":\"Bibliography\",\"link\":\"/bibliography\"},{\"text\":\"Developer Documentation\",\"collapsed\":false,\"items\":[{\"text\":\"Overview\",\"link\":\"/dev-docs/index\"},{\"text\":\"Solvers\",\"link\":\"/dev-docs/solvers\"},{\"text\":\"SPDEs\",\"link\":\"/dev-docs/spdes\"},{\"text\":\"Discretizations\",\"link\":\"/dev-docs/discretizations\"}]}],\"editLink\":{\"pattern\":\"https://github.com/timweiland/GaussianMarkovRandomFields.jl/edit/main/docs/src/:path\"},\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/timweiland/GaussianMarkovRandomFields.jl\"}],\"footer\":{\"message\":\"Made with <a href=\\\"https://luxdl.github.io/DocumenterVitepress.jl/dev/\\\" target=\\\"_blank\\\"><strong>DocumenterVitepress.jl</strong></a><br>\",\"copyright\":\"© Copyright 2025.\"}},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":true}");</script>
    
  </body>
</html>