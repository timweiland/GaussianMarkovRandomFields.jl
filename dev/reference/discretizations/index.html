<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Discretizations ¬∑ GaussianMarkovRandomFields.jl</title><meta name="title" content="Discretizations ¬∑ GaussianMarkovRandomFields.jl"/><meta property="og:title" content="Discretizations ¬∑ GaussianMarkovRandomFields.jl"/><meta property="twitter:title" content="Discretizations ¬∑ GaussianMarkovRandomFields.jl"/><meta name="description" content="Documentation for GaussianMarkovRandomFields.jl."/><meta property="og:description" content="Documentation for GaussianMarkovRandomFields.jl."/><meta property="twitter:description" content="Documentation for GaussianMarkovRandomFields.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/citations.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.svg" alt="GaussianMarkovRandomFields.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">GaussianMarkovRandomFields.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><input class="collapse-toggle" id="menuitem-2" type="checkbox"/><label class="tocitem" for="menuitem-2"><span class="docs-label">Tutorials</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../tutorials/">Overview</a></li><li><a class="tocitem" href="../../tutorials/autoregressive_models/">Building autoregressive models</a></li><li><a class="tocitem" href="../../tutorials/spatial_modelling_spdes/">Spatial Modelling with SPDEs</a></li><li><a class="tocitem" href="../../tutorials/spatiotemporal_modelling/">Spatiotemporal Modelling with SPDEs</a></li><li><a class="tocitem" href="../../tutorials/autodiff_mcmc/">Automatic Differentiation and MCMC</a></li><li><a class="tocitem" href="../../tutorials/boundary_conditions/">Boundary Conditions for SPDEs</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox" checked/><label class="tocitem" for="menuitem-3"><span class="docs-label">API Reference</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../">Overview</a></li><li><a class="tocitem" href="../gmrfs/">GMRFs</a></li><li><a class="tocitem" href="../spdes/">SPDEs</a></li><li class="is-active"><a class="tocitem" href>Discretizations</a><ul class="internal"><li><a class="tocitem" href="#Discretizing-SPDEs"><span>Discretizing SPDEs</span></a></li><li><a class="tocitem" href="#Spatial-discretization:-FEM"><span>Spatial discretization: FEM</span></a></li><li><a class="tocitem" href="#Temporal-discretization-and-state-space-models"><span>Temporal discretization and state-space models</span></a></li></ul></li><li><a class="tocitem" href="../meshes/">Meshes</a></li><li><a class="tocitem" href="../plotting/">Plotting</a></li><li><a class="tocitem" href="../solvers/">Solvers</a></li><li><a class="tocitem" href="../autoregressive/">Autoregressive Models</a></li><li><a class="tocitem" href="../linear_maps/">Linear maps</a></li><li><a class="tocitem" href="../gn_optim/">Gauss-Newton optimization</a></li><li><a class="tocitem" href="../preconditioners/">Preconditioners</a></li></ul></li><li><a class="tocitem" href="../../bibliography/">Bibliography</a></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox"/><label class="tocitem" for="menuitem-5"><span class="docs-label">Developer Documentation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../dev-docs/">Overview</a></li><li><a class="tocitem" href="../../dev-docs/solvers/">Solvers</a></li><li><a class="tocitem" href="../../dev-docs/spdes/">SPDEs</a></li><li><a class="tocitem" href="../../dev-docs/discretizations/">Discretizations</a></li><li><a class="tocitem" href="../../dev-docs/utils/">Utilities</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">API Reference</a></li><li class="is-active"><a href>Discretizations</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Discretizations</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/timweiland/GaussianMarkovRandomFields.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands">ÔÇõ</span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/main/docs/src/reference/discretizations.md" title="Edit source on GitHub"><span class="docs-icon fa-solid">ÔÅÑ</span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Spatial-and-spatiotemporal-discretizations"><a class="docs-heading-anchor" href="#Spatial-and-spatiotemporal-discretizations">Spatial and spatiotemporal discretizations</a><a id="Spatial-and-spatiotemporal-discretizations-1"></a><a class="docs-heading-anchor-permalink" href="#Spatial-and-spatiotemporal-discretizations" title="Permalink"></a></h1><h2 id="Discretizing-SPDEs"><a class="docs-heading-anchor" href="#Discretizing-SPDEs">Discretizing SPDEs</a><a id="Discretizing-SPDEs-1"></a><a class="docs-heading-anchor-permalink" href="#Discretizing-SPDEs" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GaussianMarkovRandomFields.discretize" href="#GaussianMarkovRandomFields.discretize"><code>GaussianMarkovRandomFields.discretize</code></a> ‚Äî <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">discretize(ùíü::MaternSPDE{D}, discretization::FEMDiscretization{D})::AbstractGMRF where {D}</code></pre><p>Discretize a Mat√©rn SPDE using a Finite Element Method (FEM) discretization. Computes the stiffness and (lumped) mass matrix, and then forms the precision matrix of the GMRF discretization.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/4b76af219209edd77c1de217c71daeb9d41e2ca1/src/spdes/matern.jl#L194-L200">source</a></section><section><div><pre><code class="language-julia hljs">discretize(spde::AdvectionDiffusionSPDE, discretization::FEMDiscretization,
ts::AbstractVector{Float64}; colored_noise = false,
streamline_diffusion = false, h = 0.1) where {D}</code></pre><p>Discretize an advection-diffusion SPDE using a constant spatial mesh. Streamline diffusion is an optional stabilization scheme for advection-dominated problems, which are known to be unstable. When using streamline diffusion, <code>h</code> may be passed to specify the mesh element size.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/4b76af219209edd77c1de217c71daeb9d41e2ca1/src/spdes/advection_diffusion.jl#L100-L110">source</a></section></article><h2 id="Spatial-discretization:-FEM"><a class="docs-heading-anchor" href="#Spatial-discretization:-FEM">Spatial discretization: FEM</a><a id="Spatial-discretization:-FEM-1"></a><a class="docs-heading-anchor-permalink" href="#Spatial-discretization:-FEM" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GaussianMarkovRandomFields.FEMDiscretization" href="#GaussianMarkovRandomFields.FEMDiscretization"><code>GaussianMarkovRandomFields.FEMDiscretization</code></a> ‚Äî <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">FEMDiscretization(
    grid::Ferrite.Grid,
    interpolation::Ferrite.Interpolation,
    quadrature_rule::Ferrite.QuadratureRule,
    fields = ((:u, nothing),),
    boundary_conditions = (),
)</code></pre><p>A struct that contains all the information needed to discretize an (S)PDE using the Finite Element Method.</p><p><strong>Arguments</strong></p><ul><li><code>grid::Ferrite.Grid</code>: The grid on which the discretization is defined.</li><li><code>interpolation::Ferrite.Interpolation</code>: The interpolation scheme, i.e. the                                         type of FEM elements.</li><li><code>quadrature_rule::Ferrite.QuadratureRule</code>: The quadrature rule.</li><li><code>fields::Vector{Tuple{Symbol, Union{Nothing, Ferrite.Interpolation}}}</code>:       The fields to be discretized. Each tuple contains the field name and       the geometric interpolation scheme. If the interpolation scheme is       <code>nothing</code>, <code>interpolation</code> is used for geometric interpolation.</li><li><code>boundary_conditions::Vector{Tuple{Ferrite.BoundaryCondition, Float64}}</code>:       The (soft) boundary conditions. Each tuple contains the boundary       condition and the noise standard deviation.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/4b76af219209edd77c1de217c71daeb9d41e2ca1/src/spdes/fem/fem_discretization.jl#L6-L30">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GaussianMarkovRandomFields.ndim" href="#GaussianMarkovRandomFields.ndim"><code>GaussianMarkovRandomFields.ndim</code></a> ‚Äî <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ndim(f::FEMDiscretization)</code></pre><p>Return the dimension of space in which the discretization is defined. Typically ndim(f) == 1, 2, or 3.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/4b76af219209edd77c1de217c71daeb9d41e2ca1/src/spdes/fem/fem_discretization.jl#L120-L125">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Ferrite.ndofs-Tuple{FEMDiscretization}" href="#Ferrite.ndofs-Tuple{FEMDiscretization}"><code>Ferrite.ndofs</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ndofs(f::FEMDiscretization)</code></pre><p>Return the number of degrees of freedom in the discretization.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/4b76af219209edd77c1de217c71daeb9d41e2ca1/src/spdes/fem/fem_discretization.jl#L128-L132">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GaussianMarkovRandomFields.evaluation_matrix" href="#GaussianMarkovRandomFields.evaluation_matrix"><code>GaussianMarkovRandomFields.evaluation_matrix</code></a> ‚Äî <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">evaluation_matrix(f::FEMDiscretization, X)</code></pre><p>Return the matrix A such that A[i, j] is the value of the j-th basis function at the i-th point in X.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/4b76af219209edd77c1de217c71daeb9d41e2ca1/src/spdes/fem/fem_discretization.jl#L135-L140">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GaussianMarkovRandomFields.node_selection_matrix" href="#GaussianMarkovRandomFields.node_selection_matrix"><code>GaussianMarkovRandomFields.node_selection_matrix</code></a> ‚Äî <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">node_selection_matrix(f::FEMDiscretization, node_ids)</code></pre><p>Return the matrix A such that A[i, j] = 1 if the j-th basis function is associated with the i-th node in node_ids.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/4b76af219209edd77c1de217c71daeb9d41e2ca1/src/spdes/fem/fem_discretization.jl#L165-L170">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GaussianMarkovRandomFields.derivative_matrices" href="#GaussianMarkovRandomFields.derivative_matrices"><code>GaussianMarkovRandomFields.derivative_matrices</code></a> ‚Äî <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">derivative_matrices(f::FEMDiscretization{D}, X; derivative_idcs = [1])</code></pre><p>Return a vector of matrices such that mats[k][i, j] is the derivative of the j-th basis function at X[i], where the partial derivative index is given by derivative_idcs[k].</p><p><strong>Examples</strong></p><p>We&#39;re modelling a 2D function u(x, y) and we want the derivatives with respect to y at two input points.</p><pre><code class="language- hljs">using Ferrite # hide
grid = generate_grid(Triangle, (20,20)) # hide
ip = Lagrange{2, RefTetrahedron, 1}() # hide
qr = QuadratureRule{2, RefTetrahedron}(2) # hide
disc = FEMDiscretization(grid, ip, qr)
X = [Tensors.Vec(0.11, 0.22), Tensors.Vec(-0.1, 0.4)]

mats = derivative_matrices(disc, X; derivative_idcs=[2])</code></pre><p><code>mats</code> contains a single matrix of size (2, ndofs(disc)) where the i-th row contains the derivative of all basis functions with respect to y at X[i].</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/4b76af219209edd77c1de217c71daeb9d41e2ca1/src/spdes/fem/fem_derivatives.jl#L111-L135">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GaussianMarkovRandomFields.second_derivative_matrices" href="#GaussianMarkovRandomFields.second_derivative_matrices"><code>GaussianMarkovRandomFields.second_derivative_matrices</code></a> ‚Äî <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">second_derivative_matrices(f::FEMDiscretization{D}, X; derivative_idcs = [(1,1)])</code></pre><p>Return a vector of matrices such that mats[k][i, j] is the second derivative of the j-th basis function at X[i], where the partial derivative index is given by derivative_idcs[k]. Note that the indices refer to the Hessian, i.e. (1, 2) corresponds to ‚àÇ¬≤/‚àÇx‚àÇy.</p><p><strong>Examples</strong></p><p>We&#39;re modelling a 2D function u(x, y) and we want to evaluate the Laplacian at two input points.</p><pre><code class="language- hljs">using Ferrite # hide
grid = generate_grid(Triangle, (20,20)) # hide
ip = Lagrange{2, RefTetrahedron, 1}() # hide
qr = QuadratureRule{2, RefTetrahedron}(2) # hide
disc = FEMDiscretization(grid, ip, qr)
X = [Tensors.Vec(0.11, 0.22), Tensors.Vec(-0.1, 0.4)]

A, B = derivative_matrices(disc, X; derivative_idcs=[(1, 1), (2, 2)])
laplacian = A + B</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/4b76af219209edd77c1de217c71daeb9d41e2ca1/src/spdes/fem/fem_derivatives.jl#L170-L193">source</a></section></article><h3 id="Utilities"><a class="docs-heading-anchor" href="#Utilities">Utilities</a><a id="Utilities-1"></a><a class="docs-heading-anchor-permalink" href="#Utilities" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GaussianMarkovRandomFields.assemble_mass_matrix" href="#GaussianMarkovRandomFields.assemble_mass_matrix"><code>GaussianMarkovRandomFields.assemble_mass_matrix</code></a> ‚Äî <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">assemble_mass_matrix(
    Ce::SparseMatrixCSC,
    cellvalues::CellValues,
    interpolation;
    lumping = true,
)</code></pre><p>Assemble the mass matrix <code>Ce</code> for the given cell values.</p><p><strong>Arguments</strong></p><ul><li><code>Ce::SparseMatrixCSC</code>: The mass matrix.</li><li><code>cellvalues::CellValues</code>: Ferrite cell values.</li><li><code>interpolation::Interpolation</code>: The interpolation scheme.</li><li><code>lumping::Bool=true</code>: Whether to lump the mass matrix.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/4b76af219209edd77c1de217c71daeb9d41e2ca1/src/spdes/fem/utils.jl#L35-L50">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GaussianMarkovRandomFields.assemble_diffusion_matrix" href="#GaussianMarkovRandomFields.assemble_diffusion_matrix"><code>GaussianMarkovRandomFields.assemble_diffusion_matrix</code></a> ‚Äî <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">assemble_diffusion_matrix(
    Ge::SparseMatrixCSC,
    cellvalues::CellValues;
    diffusion_factor = I,
)</code></pre><p>Assemble the diffusion matrix <code>Ge</code> for the given cell values.</p><p><strong>Arguments</strong></p><ul><li><code>Ge::SparseMatrixCSC</code>: The diffusion matrix.</li><li><code>cellvalues::CellValues</code>: Ferrite cell values.</li><li><code>diffusion_factor=I</code>: The diffusion factor.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/4b76af219209edd77c1de217c71daeb9d41e2ca1/src/spdes/fem/utils.jl#L81-L94">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GaussianMarkovRandomFields.assemble_advection_matrix" href="#GaussianMarkovRandomFields.assemble_advection_matrix"><code>GaussianMarkovRandomFields.assemble_advection_matrix</code></a> ‚Äî <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">assemble_advection_matrix(
    Be::SparseMatrixCSC,
    cellvalues::CellValues;
    advection_velocity = 1,
)</code></pre><p>Assemble the advection matrix <code>Be</code> for the given cell values.</p><p><strong>Arguments</strong></p><ul><li><code>Be::SparseMatrixCSC</code>: The advection matrix.</li><li><code>cellvalues::CellValues</code>: Ferrite cell values.</li><li><code>advection_velocity=1</code>: The advection velocity.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/4b76af219209edd77c1de217c71daeb9d41e2ca1/src/spdes/fem/utils.jl#L121-L134">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GaussianMarkovRandomFields.lump_matrix" href="#GaussianMarkovRandomFields.lump_matrix"><code>GaussianMarkovRandomFields.lump_matrix</code></a> ‚Äî <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">lump_matrix(A::AbstractMatrix, ::Lagrange{D, S, 1}) where {D, S}</code></pre><p>Lump a matrix by summing over the rows.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/4b76af219209edd77c1de217c71daeb9d41e2ca1/src/spdes/fem/utils.jl#L10-L14">source</a></section><section><div><pre><code class="language-julia hljs">lump_matrix(A::AbstractMatrix, ::Lagrange)</code></pre><p>Lump a matrix through HRZ lumping. Fallback for non-linear elements. Row-summing cannot be used for non-linear elements, because it does not ensure positive definiteness.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/4b76af219209edd77c1de217c71daeb9d41e2ca1/src/spdes/fem/utils.jl#L19-L26">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GaussianMarkovRandomFields.assemble_streamline_diffusion_matrix" href="#GaussianMarkovRandomFields.assemble_streamline_diffusion_matrix"><code>GaussianMarkovRandomFields.assemble_streamline_diffusion_matrix</code></a> ‚Äî <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">assemble_streamline_diffusion_matrix(
    Ge::SparseMatrixCSC,
    cellvalues::CellValues,
    advection_velocity,
    h,
)</code></pre><p>Assemble the streamline diffusion matrix <code>Ge</code> for the given cell values.</p><p><strong>Arguments</strong></p><ul><li><code>Ge::SparseMatrixCSC</code>: The streamline diffusion matrix.</li><li><code>cellvalues::CellValues</code>: Ferrite cell values.</li><li><code>advection_velocity</code>: The advection velocity.</li><li><code>h</code>: The mesh size.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/4b76af219209edd77c1de217c71daeb9d41e2ca1/src/spdes/fem/utils.jl#L161-L176">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GaussianMarkovRandomFields.apply_soft_constraints!" href="#GaussianMarkovRandomFields.apply_soft_constraints!"><code>GaussianMarkovRandomFields.apply_soft_constraints!</code></a> ‚Äî <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">apply_soft_constraints!(K, f_rhs, ch, constraint_noise; Q_rhs = nothing, Q_rhs_sqrt = nothing)</code></pre><p>Apply soft constraints to the Gaussian relation</p><p class="math-container">\[\mathbf{K} \mathbf{u} \sim \mathcal{N}(\mathbf{f}_{\text{rhs}}, \mathbf{Q}_{\text{rhs}}^{-1})\]</p><p>Soft means that the constraints are fulfilled up to noise of magnitude specified by <code>constraint_noise</code>.</p><p>Modifies <code>K</code> and <code>f_rhs</code> in place. If <code>Q_rhs</code> and <code>Q_rhs_sqrt</code> are provided, they are modified in place as well.</p><p><strong>Arguments</strong></p><ul><li><code>K::SparseMatrixCSC</code>: Stiffness matrix.</li><li><code>f_rhs::AbstractVector</code>: Right-hand side.</li><li><code>ch::ConstraintHandler</code>: Constraint handler.</li><li><code>constraint_noise::Vector{Float64}</code>: Noise for each constraint.</li><li><code>Q_rhs::Union{Nothing, SparseMatrixCSC}</code>: Covariance matrix for the right-hand                                           side.</li><li><code>Q_rhs_sqrt::Union{Nothing, SparseMatrixCSC}</code>: Square root of the covariance                                                matrix for the right-hand side.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/4b76af219209edd77c1de217c71daeb9d41e2ca1/src/spdes/fem/utils.jl#L205-L228">source</a></section></article><h2 id="Temporal-discretization-and-state-space-models"><a class="docs-heading-anchor" href="#Temporal-discretization-and-state-space-models">Temporal discretization and state-space models</a><a id="Temporal-discretization-and-state-space-models-1"></a><a class="docs-heading-anchor-permalink" href="#Temporal-discretization-and-state-space-models" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GaussianMarkovRandomFields.JointSSMMatrices" href="#GaussianMarkovRandomFields.JointSSMMatrices"><code>GaussianMarkovRandomFields.JointSSMMatrices</code></a> ‚Äî <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">JointSSMMatrices</code></pre><p>Abstract type for the matrices defining the transition of a certain linear state-space model of the form</p><p class="math-container">\[G(Œît) x_{k+1} ‚à£ x‚Çñ ‚àº ùí©(M(Œît) x‚Çñ, Œ£)\]</p><p><strong>Fields</strong></p><ul><li><code>Œît::Real</code>: Time step.</li><li><code>G::LinearMap</code>: Transition matrix.</li><li><code>M::LinearMap</code>: Observation matrix.</li><li><code>Œ£‚Åª¬π::LinearMap</code>: Transition precision map.</li><li><code>Œ£‚Åª¬π_sqrt::LinearMap</code>: Square root of the transition precision map.</li><li><code>constraint_handler</code>: Ferrite constraint handler.</li><li><code>constraint_noise</code>: Constraint noise.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/4b76af219209edd77c1de217c71daeb9d41e2ca1/src/spdes/spatiotemporal/ssm/linear_ssm.jl#L6-L24">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GaussianMarkovRandomFields.joint_ssm" href="#GaussianMarkovRandomFields.joint_ssm"><code>GaussianMarkovRandomFields.joint_ssm</code></a> ‚Äî <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">joint_ssm(x‚ÇÄ::GMRF, ssm_matrices::Function, ts::AbstractVector)</code></pre><p>Form the joint GMRF for the linear state-space model given by</p><p class="math-container">\[G(Œît‚Çñ) x_{k+1} ‚à£ x‚Çñ ‚àº ùí©(M(Œît‚Çñ) x‚Çñ, Œ£)\]</p><p>at time points given by <code>ts</code> (from which the Œît‚Çñ are computed).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/4b76af219209edd77c1de217c71daeb9d41e2ca1/src/spdes/spatiotemporal/ssm/linear_ssm.jl#L36-L46">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GaussianMarkovRandomFields.ImplicitEulerSSM" href="#GaussianMarkovRandomFields.ImplicitEulerSSM"><code>GaussianMarkovRandomFields.ImplicitEulerSSM</code></a> ‚Äî <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ImplicitEulerSSM(
    x‚ÇÄ::AbstractGMRF,
    G::Function,
    M::Function,
    M‚Åª¬π::Function,
    Œ≤::Function,
    Œ≤‚Åª¬π::Function,
    spatial_noise::AbstractGMRF,
    ts::AbstractVector,
    constraint_handler::ConstraintHandler,
    constraint_noise::AbstractVector,
)</code></pre><p>State-space model for the implicit Euler discretization of a stochastic differential equation.</p><p>The state-space model is given by</p><pre><code class="nohighlight hljs">G(Œît) x‚Çñ‚Çä‚ÇÅ = M(Œît) x‚Çñ + M(Œît) Œ≤(Œît) z‚Çõ</code></pre><p>where <code>z‚Çõ</code> is (possibly colored) spatial noise. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/4b76af219209edd77c1de217c71daeb9d41e2ca1/src/spdes/spatiotemporal/ssm/implicit_euler_ssm.jl#L6-L30">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GaussianMarkovRandomFields.ImplicitEulerJointSSMMatrices" href="#GaussianMarkovRandomFields.ImplicitEulerJointSSMMatrices"><code>GaussianMarkovRandomFields.ImplicitEulerJointSSMMatrices</code></a> ‚Äî <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ImplicitEulerJointSSMMatrices(
    ssm::ImplicitEulerSSM,
    Œît::Real
)</code></pre><p>Construct the joint state-space model matrices for the implicit Euler discretization scheme.</p><p><strong>Arguments</strong></p><ul><li><code>ssm::ImplicitEulerSSM</code>: The implicit Euler state-space model.</li><li><code>Œît::Real</code>: The time step.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/4b76af219209edd77c1de217c71daeb9d41e2ca1/src/spdes/spatiotemporal/ssm/implicit_euler_ssm.jl#L70-L82">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../spdes/">¬´ SPDEs</a><a class="docs-footer-nextpage" href="../meshes/">Meshes ¬ª</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.13.0 on <span class="colophon-date" title="Saturday 5 July 2025 15:11">Saturday 5 July 2025</span>. Using Julia version 1.10.10.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
