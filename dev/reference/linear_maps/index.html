<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Linear maps · GaussianMarkovRandomFields.jl</title><meta name="title" content="Linear maps · GaussianMarkovRandomFields.jl"/><meta property="og:title" content="Linear maps · GaussianMarkovRandomFields.jl"/><meta property="twitter:title" content="Linear maps · GaussianMarkovRandomFields.jl"/><meta name="description" content="Documentation for GaussianMarkovRandomFields.jl."/><meta property="og:description" content="Documentation for GaussianMarkovRandomFields.jl."/><meta property="twitter:description" content="Documentation for GaussianMarkovRandomFields.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/citations.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.svg" alt="GaussianMarkovRandomFields.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">GaussianMarkovRandomFields.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><input class="collapse-toggle" id="menuitem-2" type="checkbox"/><label class="tocitem" for="menuitem-2"><span class="docs-label">Tutorials</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../tutorials/">Overview</a></li><li><a class="tocitem" href="../../tutorials/autoregressive_models/">Building autoregressive models</a></li><li><a class="tocitem" href="../../tutorials/spatial_modelling_spdes/">Spatial Modelling with SPDEs</a></li><li><a class="tocitem" href="../../tutorials/spatiotemporal_modelling/">Spatiotemporal Modelling with SPDEs</a></li><li><a class="tocitem" href="../../tutorials/boundary_conditions/">Boundary Conditions for SPDEs</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox" checked/><label class="tocitem" for="menuitem-3"><span class="docs-label">API Reference</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../">Overview</a></li><li><a class="tocitem" href="../gmrfs/">GMRFs</a></li><li><a class="tocitem" href="../spdes/">SPDEs</a></li><li><a class="tocitem" href="../discretizations/">Discretizations</a></li><li><a class="tocitem" href="../meshes/">Meshes</a></li><li><a class="tocitem" href="../plotting/">Plotting</a></li><li><a class="tocitem" href="../solvers/">Solvers</a></li><li><a class="tocitem" href="../autoregressive/">Autoregressive Models</a></li><li class="is-active"><a class="tocitem" href>Linear maps</a></li><li><a class="tocitem" href="../gn_optim/">Gauss-Newton optimization</a></li><li><a class="tocitem" href="../preconditioners/">Preconditioners</a></li></ul></li><li><a class="tocitem" href="../../bibliography/">Bibliography</a></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox"/><label class="tocitem" for="menuitem-5"><span class="docs-label">Developer Documentation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../dev-docs/">Overview</a></li><li><a class="tocitem" href="../../dev-docs/solvers/">Solvers</a></li><li><a class="tocitem" href="../../dev-docs/spdes/">SPDEs</a></li><li><a class="tocitem" href="../../dev-docs/discretizations/">Discretizations</a></li><li><a class="tocitem" href="../../dev-docs/utils/">Utilities</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">API Reference</a></li><li class="is-active"><a href>Linear maps</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Linear maps</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/timweiland/GaussianMarkovRandomFields.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/main/docs/src/reference/linear_maps.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Linear-Maps"><a class="docs-heading-anchor" href="#Linear-Maps">Linear Maps</a><a id="Linear-Maps-1"></a><a class="docs-heading-anchor-permalink" href="#Linear-Maps" title="Permalink"></a></h1><p>The construction of GMRFs involves various kinds of structured matrices. These structures may be leveraged in downstream computations to save compute and memory. But to make this possible, we need to actually keep track of these structures -  which we achieve through diverse subtypes of <a href="https://julialinearalgebra.github.io/LinearMaps.jl/stable/">LinearMap</a>.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GaussianMarkovRandomFields.SymmetricBlockTridiagonalMap" href="#GaussianMarkovRandomFields.SymmetricBlockTridiagonalMap"><code>GaussianMarkovRandomFields.SymmetricBlockTridiagonalMap</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SymmetricBlockTridiagonalMap(
    diagonal_blocks::Tuple{LinearMap{T},Vararg{LinearMap{T},ND}},
    off_diagonal_blocks::Tuple{LinearMap{T},Vararg{LinearMap{T},NOD}},
)</code></pre><p>A linear map representing a symmetric block tridiagonal matrix with diagonal blocks <code>diagonal_blocks</code> and lower off-diagonal blocks <code>off_diagonal_blocks</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/4f0745c294abd0f7d3c07ce34e355d9fe9017d1e/src/linear_maps/symmetric_block_tridiagonal.jl#L9-L18">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GaussianMarkovRandomFields.SSMBidiagonalMap" href="#GaussianMarkovRandomFields.SSMBidiagonalMap"><code>GaussianMarkovRandomFields.SSMBidiagonalMap</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SSMBidiagonalMap{T}(
    A::LinearMap{T},
    B::LinearMap{T},
    C::LinearMap{T},
    N_t::Int,
)</code></pre><p>Represents the block-bidiagonal map given by the (N<em>t) x (N</em>t - 1) sized block structure:</p><p class="math-container">\[\begin{bmatrix}
A &amp; 0 &amp; \cdots &amp; 0 \\
B &amp; C &amp; \cdots &amp; 0 \\
0 &amp; B &amp; C &amp; 0 \\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
0 &amp; 0 &amp; \cdots &amp; B
\end{bmatrix}\]</p><p>which occurs as a square root in the discretization of GMRF-based state-space models. <code>N_t</code> is the total number of blocks along the rows.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/4f0745c294abd0f7d3c07ce34e355d9fe9017d1e/src/linear_maps/ssm_bidiagonal.jl#L6-L29">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GaussianMarkovRandomFields.OuterProductMap" href="#GaussianMarkovRandomFields.OuterProductMap"><code>GaussianMarkovRandomFields.OuterProductMap</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">OuterProductMap{T}(
    A::LinearMap{T},
    Q::LinearMap{T},
)</code></pre><p>Represents the outer product A&#39; Q A, without actually forming it in memory.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/4f0745c294abd0f7d3c07ce34e355d9fe9017d1e/src/linear_maps/outer_product.jl#L8-L15">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GaussianMarkovRandomFields.LinearMapWithSqrt" href="#GaussianMarkovRandomFields.LinearMapWithSqrt"><code>GaussianMarkovRandomFields.LinearMapWithSqrt</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">LinearMapWithSqrt{T}(
    A::LinearMap{T},
    A_sqrt::LinearMap{T},
)</code></pre><p>A symmetric positive definite linear map <code>A</code> with known square root <code>A_sqrt</code>, i.e. <code>A = A_sqrt * A_sqrt&#39;</code>. Behaves just like <code>A</code>, but taking the square root directly returns <code>A_sqrt</code>.</p><p><strong>Arguments</strong></p><ul><li><code>A::LinearMap{T}</code>: The linear map <code>A</code>.</li><li><code>A_sqrt::LinearMap{T}</code>: The square root of <code>A</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/4f0745c294abd0f7d3c07ce34e355d9fe9017d1e/src/linear_maps/linear_map_with_sqrt.jl#L6-L19">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GaussianMarkovRandomFields.CholeskySqrt" href="#GaussianMarkovRandomFields.CholeskySqrt"><code>GaussianMarkovRandomFields.CholeskySqrt</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">CholeskySqrt{T}(cho::Union{Cholesky{T},SparseArrays.CHOLMOD.Factor{T}})</code></pre><p>A linear map representing the square root obtained from a Cholesky factorization, i.e. for <code>A = L * L&#39;</code>, this map represents <code>L</code>.</p><p><strong>Arguments</strong></p><ul><li><code>cho::Union{Cholesky{T},SparseArrays.CHOLMOD.Factor{T}}</code>:   The Cholesky factorization of a symmetric positive definite matrix.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/4f0745c294abd0f7d3c07ce34e355d9fe9017d1e/src/linear_maps/cholesky_sqrt.jl#L17-L26">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GaussianMarkovRandomFields.CholeskyFactorizedMap" href="#GaussianMarkovRandomFields.CholeskyFactorizedMap"><code>GaussianMarkovRandomFields.CholeskyFactorizedMap</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">CholeskyFactorizedMap{T}(cho::Union{Cholesky{T},SparseArrays.CHOLMOD.Factor{T}})</code></pre><p>A linear map represented in terms of its Cholesky factorization, i.e. for <code>A = L * L&#39;</code>, this map represents <code>A</code>.</p><p><strong>Arguments</strong></p><ul><li><code>cho::Union{Cholesky{T},SparseArrays.CHOLMOD.Factor{T}}</code>:   The Cholesky factorization of a symmetric positive definite matrix.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/4f0745c294abd0f7d3c07ce34e355d9fe9017d1e/src/linear_maps/cholesky_factorized_map.jl#L9-L18">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GaussianMarkovRandomFields.ZeroMap" href="#GaussianMarkovRandomFields.ZeroMap"><code>GaussianMarkovRandomFields.ZeroMap</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ZeroMap{T}(N::Int, M::Int)</code></pre><p>A linear map that maps all vectors to the zero vector.</p><p><strong>Arguments</strong></p><ul><li><code>N::Int</code>: Output dimension</li><li><code>M::Int</code>: Input dimension</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/4f0745c294abd0f7d3c07ce34e355d9fe9017d1e/src/linear_maps/zero.jl#L5-L13">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GaussianMarkovRandomFields.ADJacobianMap" href="#GaussianMarkovRandomFields.ADJacobianMap"><code>GaussianMarkovRandomFields.ADJacobianMap</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ADJacobianMap(f::Function, x₀::AbstractVector{T}, N_outputs::Int)</code></pre><p>A linear map representing the Jacobian of <code>f</code> at <code>x₀</code>. Uses forward-mode AD in a matrix-free way, i.e. we do not actually store the Jacobian in memory and only compute JVPs.</p><p>Requires ForwardDiff.jl!</p><p><strong>Arguments</strong></p><ul><li><code>f::Function</code>: Function to differentiate.</li><li><code>x₀::AbstractVector{T}</code>: Input vector at which to evaluate the Jacobian.</li><li><code>N_outputs::Int</code>: Output dimension of <code>f</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/4f0745c294abd0f7d3c07ce34e355d9fe9017d1e/src/linear_maps/ad_jacobian.jl#L5-L18">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GaussianMarkovRandomFields.ADJacobianAdjointMap" href="#GaussianMarkovRandomFields.ADJacobianAdjointMap"><code>GaussianMarkovRandomFields.ADJacobianAdjointMap</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ADJacobianAdjointMap{T}(f::Function, x₀::AbstractVector{T}, N_outputs::Int)</code></pre><p>A linear map representing the adjoint of the Jacobian of <code>f</code> at <code>x₀</code>. Uses reverse-mode AD in a matrix-free way, i.e. we do not actually store the Jacobian in memory and only compute VJPs.</p><p>Requires Zygote.jl!</p><p><strong>Arguments</strong></p><ul><li><code>f::Function</code>: Function to differentiate.</li><li><code>x₀::AbstractVector{T}</code>: Input vector at which to evaluate the Jacobian.</li><li><code>N_outputs::Int</code>: Output dimension of <code>f</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/4f0745c294abd0f7d3c07ce34e355d9fe9017d1e/src/linear_maps/ad_jacobian.jl#L37-L50">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../autoregressive/">« Autoregressive Models</a><a class="docs-footer-nextpage" href="../gn_optim/">Gauss-Newton optimization »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.10.1 on <span class="colophon-date" title="Tuesday 22 April 2025 19:17">Tuesday 22 April 2025</span>. Using Julia version 1.11.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
