<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Automatic Differentiation and MCMC · GaussianMarkovRandomFields.jl</title><meta name="title" content="Automatic Differentiation and MCMC · GaussianMarkovRandomFields.jl"/><meta property="og:title" content="Automatic Differentiation and MCMC · GaussianMarkovRandomFields.jl"/><meta property="twitter:title" content="Automatic Differentiation and MCMC · GaussianMarkovRandomFields.jl"/><meta name="description" content="Documentation for GaussianMarkovRandomFields.jl."/><meta property="og:description" content="Documentation for GaussianMarkovRandomFields.jl."/><meta property="twitter:description" content="Documentation for GaussianMarkovRandomFields.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/citations.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.svg" alt="GaussianMarkovRandomFields.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">GaussianMarkovRandomFields.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><input class="collapse-toggle" id="menuitem-2" type="checkbox" checked/><label class="tocitem" for="menuitem-2"><span class="docs-label">Tutorials</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../">Overview</a></li><li><a class="tocitem" href="../autoregressive_models/">Building autoregressive models</a></li><li><a class="tocitem" href="../spatial_modelling_spdes/">Spatial Modelling with SPDEs</a></li><li><a class="tocitem" href="../spatiotemporal_modelling/">Spatiotemporal Modelling with SPDEs</a></li><li class="is-active"><a class="tocitem" href>Automatic Differentiation and MCMC</a><ul class="internal"><li><a class="tocitem" href="#Introduction"><span>Introduction</span></a></li><li><a class="tocitem" href="#MCMC-Parameter-Inference-for-CAR-Models"><span>MCMC Parameter Inference for CAR Models</span></a></li><li><a class="tocitem" href="#Conclusion"><span>Conclusion</span></a></li></ul></li><li><a class="tocitem" href="../boundary_conditions/">Boundary Conditions for SPDEs</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox"/><label class="tocitem" for="menuitem-3"><span class="docs-label">API Reference</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../reference/">Overview</a></li><li><a class="tocitem" href="../../reference/gmrfs/">GMRFs</a></li><li><a class="tocitem" href="../../reference/spdes/">SPDEs</a></li><li><a class="tocitem" href="../../reference/discretizations/">Discretizations</a></li><li><a class="tocitem" href="../../reference/meshes/">Meshes</a></li><li><a class="tocitem" href="../../reference/plotting/">Plotting</a></li><li><a class="tocitem" href="../../reference/solvers/">Solvers</a></li><li><a class="tocitem" href="../../reference/autoregressive/">Autoregressive Models</a></li><li><a class="tocitem" href="../../reference/linear_maps/">Linear maps</a></li><li><a class="tocitem" href="../../reference/gn_optim/">Gauss-Newton optimization</a></li><li><a class="tocitem" href="../../reference/preconditioners/">Preconditioners</a></li></ul></li><li><a class="tocitem" href="../../bibliography/">Bibliography</a></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox"/><label class="tocitem" for="menuitem-5"><span class="docs-label">Developer Documentation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../dev-docs/">Overview</a></li><li><a class="tocitem" href="../../dev-docs/solvers/">Solvers</a></li><li><a class="tocitem" href="../../dev-docs/spdes/">SPDEs</a></li><li><a class="tocitem" href="../../dev-docs/discretizations/">Discretizations</a></li><li><a class="tocitem" href="../../dev-docs/utils/">Utilities</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href>Automatic Differentiation and MCMC</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Automatic Differentiation and MCMC</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/timweiland/GaussianMarkovRandomFields.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/timweiland/GaussianMarkovRandomFields.jl/blob/main/docs/src/literate-tutorials/autodiff_mcmc.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Automatic-Differentiation-and-MCMC"><a class="docs-heading-anchor" href="#Automatic-Differentiation-and-MCMC">Automatic Differentiation and MCMC</a><a id="Automatic-Differentiation-and-MCMC-1"></a><a class="docs-heading-anchor-permalink" href="#Automatic-Differentiation-and-MCMC" title="Permalink"></a></h1><h2 id="Introduction"><a class="docs-heading-anchor" href="#Introduction">Introduction</a><a id="Introduction-1"></a><a class="docs-heading-anchor-permalink" href="#Introduction" title="Permalink"></a></h2><p>Gaussian Markov Random Fields (GMRFs) are powerful tools for Bayesian inference. When the parameters of a GMRF model are unknown, we often want to infer them from observed data. Traditional optimization methods can be limiting, but modern MCMC methods like NUTS (No-U-Turn Sampler) provide a robust approach for full Bayesian inference.</p><p>Automatic differentiation (AD) is crucial for efficient MCMC sampling, as it enables gradient-based samplers to explore complex posterior geometries effectively. This tutorial demonstrates how to leverage AD with GMRFs for Bayesian parameter inference using NUTS in Turing.jl.</p><p>The key to AD support in GaussianMarkovRandomFields.jl is using the <code>:autodiffable</code> solver backend, which uses LDLFactorizations.jl instead of the default sparse Cholesky factorization. This enables ForwardDiff.jl to track derivatives through the linear algebra operations.</p><pre><code class="language-julia hljs">using LDLFactorizations, Distributions
using GaussianMarkovRandomFields
using Random, LinearAlgebra, SparseArrays
using Plots</code></pre><h2 id="MCMC-Parameter-Inference-for-CAR-Models"><a class="docs-heading-anchor" href="#MCMC-Parameter-Inference-for-CAR-Models">MCMC Parameter Inference for CAR Models</a><a id="MCMC-Parameter-Inference-for-CAR-Models-1"></a><a class="docs-heading-anchor-permalink" href="#MCMC-Parameter-Inference-for-CAR-Models" title="Permalink"></a></h2><p>We&#39;ll demonstrate Bayesian inference for the parameters of a conditional autoregressive (CAR) model. Given observations from a CAR process, we&#39;ll infer both the spatial correlation parameter (ρ) and variance parameter (σ) using NUTS sampling.</p><h3 id="Problem-setup:-CAR-model-parameter-inference"><a class="docs-heading-anchor" href="#Problem-setup:-CAR-model-parameter-inference">Problem setup: CAR model parameter inference</a><a id="Problem-setup:-CAR-model-parameter-inference-1"></a><a class="docs-heading-anchor-permalink" href="#Problem-setup:-CAR-model-parameter-inference" title="Permalink"></a></h3><p>We&#39;ll tackle a simple 1D time series problem: given observations sampled from a conditional autoregressive (CAR) process, infer the CAR parameter (ρ).</p><pre><code class="language-julia hljs">using Turing, SparseArrays</code></pre><p>Set up a 1D grid (time points)</p><pre><code class="language-julia hljs">xs = 0:0.1:2  # 21 time points
N = length(xs)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">21</code></pre><p>Create adjacency matrix for second-order CAR (neighbors and next-neighbors)</p><pre><code class="language-julia hljs">W = spzeros(N, N)
for i = 1:N
    for k in [-2, -1, 1, 2]
        j = i + k
        if 1 &lt;= j &lt;= N
            W[i, j] = 1.0 / abs(k)
        end
    end
end</code></pre><p>Generate synthetic observations from true CAR process</p><pre><code class="language-julia hljs">Random.seed!(123)
true_ρ = 0.85  # True CAR parameter
true_σ = 0.01  # True field variance
μ = zeros(N)   # Zero mean</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">21-element Vector{Float64}:
 0.0
 0.0
 0.0
 0.0
 0.0
 0.0
 0.0
 0.0
 0.0
 0.0
 ⋮
 0.0
 0.0
 0.0
 0.0
 0.0
 0.0
 0.0
 0.0
 0.0</code></pre><p>Generate true CAR model and sample from it</p><pre><code class="language-julia hljs">true_car = generate_car_model(W, true_ρ; μ = μ, σ = true_σ,
                             solver_blueprint=CholeskySolverBlueprint{:autodiffable}())</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">GMRF{Float64, LinearMaps.WrappedMap{Float64, SparseArrays.SparseMatrixCSC{Float64, Int64}}, CholeskySolver{:autodiffable, TakahashiStrategy, Float64, LinearMaps.WrappedMap{Float64, SparseArrays.SparseMatrixCSC{Float64, Int64}}, LDLFactorizations.LDLFactorization{Float64, Int64, Int64, Int64}}}(
mean: [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0  …  0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
precision: 21×21 LinearMaps.WrappedMap{Float64} of
  21×21 SparseArrays.SparseMatrixCSC{Float64, Int64} with 99 stored entries
solver: CholeskySolver{:autodiffable, TakahashiStrategy, Float64, LinearMaps.WrappedMap{Float64, SparseArrays.SparseMatrixCSC{Float64, Int64}}, LDLFactorizations.LDLFactorization{Float64, Int64, Int64, Int64}}([0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0  …  0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 21×21 LinearMaps.WrappedMap{Float64} of
  21×21 SparseArrays.SparseMatrixCSC{Float64, Int64} with 99 stored entries, LDLFactorizations.LDLFactorization{Float64, Int64, Int64, Int64}(true, true, false, 21, [2, 3, 4, 5, 6, 7, 8, 9, 10, 11  …  13, 14, 15, 16, 17, 18, 20, 20, 21, -1], [2, 2, 2, 2, 2, 2, 2, 2, 2, 2  …  2, 2, 2, 2, 2, 2, 2, 2, 1, 0], [3, 4, 5, 6, 7, 8, 9, 10, 11, 12  …  14, 15, 16, 17, 18, 20, 21, 21, 21, 21], [21, 20, 19, 18, 17, 16, 15, 14, 13, 12  …  10, 9, 8, 7, 6, 5, 4, 1, 3, 2], [19, 21, 20, 18, 17, 16, 15, 14, 13, 12  …  10, 9, 8, 7, 6, 5, 4, 3, 2, 1], [1, 3, 5, 7, 9, 11, 13, 15, 17, 19  …  25, 27, 29, 31, 33, 35, 37, 39, 40, 40], Int64[], Int64[], [2, 3, 3, 4, 4, 5, 5, 6, 6, 7  …  17, 17, 18, 18, 20, 20, 21, 20, 21, 21], [-0.5666666666666667, -0.2833333333333333, -0.5404624277456647, -0.21056977704376548, -0.47147725121474093, -0.18558717738373193, -0.4373921712696389, -0.17697600536466962, -0.4208036487942443, -0.1726450317492599  …  -0.16924310308829454, -0.40744205480342677, -0.16924258203470016, -0.40744115840424483, -0.1692423531404636, -0.40744076462519874, -0.1692422525895785, -0.2833333333333333, -0.5666666666666667, -0.5286965448138948], [150.0, 201.83333333333334, 229.0028901734104, 240.14554918010617, 246.1698409122172, 248.887820205458, 250.13278555011902, 250.6838947502651, 250.927847503607, 251.0351996989583  …  251.10317683356055, 251.11229565170635, 251.11630175652869, 251.1180616785763, 251.11883480533368, 251.1191744345867, 251.1193236305166, 150.0, 239.07772250412165, 127.81352387802943], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0  …  0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [18, 20, 3, 4, 5, 6, 7, 8, 9, 10  …  12, -1, -1, -1, -1, -1, -1, 18, 19, 20], 0.0, 0.0, 0.0, 21), TakahashiStrategy(), nothing, nothing, nothing)
)
</code></pre><p>Our &quot;observations&quot; are just a sample from the true CAR</p><pre><code class="language-julia hljs">observations = rand(true_car)

println(&quot;Generated observations from CAR process with $(N) time points&quot;)
println(&quot;True CAR parameter ρ: $(true_ρ)&quot;)
println(&quot;True variance parameter σ: $(true_σ)&quot;)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Generated observations from CAR process with 21 time points
True CAR parameter ρ: 0.85
True variance parameter σ: 0.01</code></pre><h3 id="Bayesian-model-in-Turing"><a class="docs-heading-anchor" href="#Bayesian-model-in-Turing">Bayesian model in Turing</a><a id="Bayesian-model-in-Turing-1"></a><a class="docs-heading-anchor-permalink" href="#Bayesian-model-in-Turing" title="Permalink"></a></h3><p>We&#39;ll use a simple model:</p><ul><li>x ~ CAR(W, ρ, σ) where ρ and σ are parameters to infer</li><li>ρ ~ Uniform(0.5, 0.99)</li><li>σ ~ Uniform(0.001, 0.1)</li><li>y = x (direct observation of the CAR process)</li></ul><p>Again, the crucial bit here is using the <code>:autodiffable</code> solver backend.</p><pre><code class="language-julia hljs">@model function car_model(y, W, μ)
    # Prior on CAR parameter
    ρ ~ Uniform(0.5, 0.99)

    # Prior on variance parameter
    σ ~ Uniform(0.001, 0.1)

    # CAR process
    car_dist = generate_car_model(W, ρ; μ = μ, σ = σ,
                                 solver_blueprint=CholeskySolverBlueprint{:autodiffable}())

    # Direct observation
    y ~ car_dist
end</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">car_model (generic function with 2 methods)</code></pre><p>Create the model</p><pre><code class="language-julia hljs">model = car_model(observations, W, μ)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">DynamicPPL.Model{typeof(Main.car_model), (:y, :W, :μ), (), (), Tuple{Vector{Float64}, SparseArrays.SparseMatrixCSC{Float64, Int64}, Vector{Float64}}, Tuple{}, DynamicPPL.DefaultContext}(Main.car_model, (y = [0.07840387299483453, 0.08930313551294565, 0.0568103036193451, 0.08267097408818341, -0.025373176002426064, -0.0525144955980359, -0.16214702025581984, -0.05502378606163386, -0.051828462039471106, -0.011947395381926016  …  0.016379935558217797, 0.021789192443508, -0.07393817365539637, -0.05328451077296106, -0.020084724732943468, 0.000678582049044622, -0.03016630854446354, -0.08709273978627284, -0.13240380240329042, -0.03370866463496189], W = sparse([2, 3, 1, 3, 4, 1, 2, 4, 5, 2  …  20, 17, 18, 20, 21, 18, 19, 21, 19, 20], [1, 1, 2, 2, 2, 3, 3, 3, 3, 4  …  18, 19, 19, 19, 19, 20, 20, 20, 21, 21], [1.0, 0.5, 1.0, 1.0, 0.5, 0.5, 1.0, 1.0, 0.5, 0.5  …  0.5, 0.5, 1.0, 1.0, 0.5, 0.5, 1.0, 1.0, 0.5, 1.0], 21, 21), μ = [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0  …  0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]), NamedTuple(), DynamicPPL.DefaultContext())</code></pre><h3 id="MCMC-Sampling-with-NUTS"><a class="docs-heading-anchor" href="#MCMC-Sampling-with-NUTS">MCMC Sampling with NUTS</a><a id="MCMC-Sampling-with-NUTS-1"></a><a class="docs-heading-anchor-permalink" href="#MCMC-Sampling-with-NUTS" title="Permalink"></a></h3><p>NUTS requires gradients, which are automatically computed via ForwardDiff thanks to our autodifferentiable GMRF implementation.</p><pre><code class="language-julia hljs">println(&quot;Starting MCMC sampling...&quot;)
Random.seed!(456)

sampler = NUTS()
chain = sample(model, sampler, 1000, progress=false)

println(&quot;MCMC sampling completed!&quot;)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Starting MCMC sampling...
┌ Info: Found initial step size
└   ϵ = 1.5812500000000003
MCMC sampling completed!</code></pre><h3 id="Analyze-results"><a class="docs-heading-anchor" href="#Analyze-results">Analyze results</a><a id="Analyze-results-1"></a><a class="docs-heading-anchor-permalink" href="#Analyze-results" title="Permalink"></a></h3><p>Extract CAR parameter samples</p><pre><code class="language-julia hljs">ρ_samples = chain[:ρ].data[:, 1]
ρ_mean = mean(ρ_samples)
ρ_std = std(ρ_samples)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">0.12628870284765983</code></pre><p>Extract variance parameter samples</p><pre><code class="language-julia hljs">σ_samples = chain[:σ].data[:, 1]
σ_mean = mean(σ_samples)
σ_std = std(σ_samples)

println(&quot;Posterior summary for CAR parameter ρ:&quot;)
println(&quot;True value: $(true_ρ)&quot;)
println(&quot;Posterior mean: $(round(ρ_mean, digits=4)) ± $(round(ρ_std, digits=4))&quot;)
println(&quot;95% credible interval: $(round(quantile(ρ_samples, 0.025), digits=4)) - $(round(quantile(ρ_samples, 0.975), digits=4))&quot;)

ρ_in_ci = quantile(ρ_samples, 0.025) &lt;= true_ρ &lt;= quantile(ρ_samples, 0.975)
println(&quot;True ρ value in 95% CI: $(ρ_in_ci)&quot;)

println(&quot;\nPosterior summary for variance parameter σ:&quot;)
println(&quot;True value: $(true_σ)&quot;)
println(&quot;Posterior mean: $(round(σ_mean, digits=4)) ± $(round(σ_std, digits=4))&quot;)
println(&quot;95% credible interval: $(round(quantile(σ_samples, 0.025), digits=4)) - $(round(quantile(σ_samples, 0.975), digits=4))&quot;)

σ_in_ci = quantile(σ_samples, 0.025) &lt;= true_σ &lt;= quantile(σ_samples, 0.975)
println(&quot;True σ value in 95% CI: $(σ_in_ci)&quot;)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Posterior summary for CAR parameter ρ:
True value: 0.85
Posterior mean: 0.7714 ± 0.1263
95% credible interval: 0.515 - 0.9665
True ρ value in 95% CI: true

Posterior summary for variance parameter σ:
True value: 0.01
Posterior mean: 0.0097 ± 0.0039
95% credible interval: 0.0044 - 0.0197
True σ value in 95% CI: true</code></pre><p>Plot posterior for CAR parameter</p><pre><code class="language-julia hljs">p1 = histogram(ρ_samples, bins=20, alpha=0.7, label=&quot;Posterior samples&quot;,
               xlabel=&quot;CAR Parameter ρ&quot;, ylabel=&quot;Density&quot;,
               title=&quot;Posterior Distribution of ρ&quot;)
vline!([true_ρ], label=&quot;True Value&quot;, color=:red, linewidth=2)
vline!([ρ_mean], label=&quot;Posterior Mean&quot;, color=:blue, linewidth=2, linestyle=:dash)</code></pre><img src="6d0b31ab.svg" alt="Example block output"/><p>Plot posterior for variance parameter</p><pre><code class="language-julia hljs">p2 = histogram(σ_samples, bins=20, alpha=0.7, label=&quot;Posterior samples&quot;,
               xlabel=&quot;Variance Parameter σ&quot;, ylabel=&quot;Density&quot;,
               title=&quot;Posterior Distribution of σ&quot;)
vline!([true_σ], label=&quot;True Value&quot;, color=:red, linewidth=2)
vline!([σ_mean], label=&quot;Posterior Mean&quot;, color=:blue, linewidth=2, linestyle=:dash)</code></pre><img src="a26a3ff0.svg" alt="Example block output"/><p>Plot trace of CAR parameter</p><pre><code class="language-julia hljs">p3 = plot(ρ_samples, label=&quot;ρ samples&quot;, xlabel=&quot;Iteration&quot;, ylabel=&quot;CAR Parameter ρ&quot;,
          title=&quot;MCMC Trace for ρ&quot;)
hline!([true_ρ], label=&quot;True Value&quot;, color=:red, linewidth=2)</code></pre><img src="6fea4352.svg" alt="Example block output"/><p>Plot trace of variance parameter</p><pre><code class="language-julia hljs">p4 = plot(σ_samples, label=&quot;σ samples&quot;, xlabel=&quot;Iteration&quot;, ylabel=&quot;Variance Parameter σ&quot;,
          title=&quot;MCMC Trace for σ&quot;)
hline!([true_σ], label=&quot;True Value&quot;, color=:red, linewidth=2)</code></pre><img src="6bcb0dfc.svg" alt="Example block output"/><p>Combine plots</p><pre><code class="language-julia hljs">combined_plot = plot(p1, p2, p3, p4, layout=(2,2), size=(1000, 800))</code></pre><img src="66eb7577.svg" alt="Example block output"/><h2 id="Conclusion"><a class="docs-heading-anchor" href="#Conclusion">Conclusion</a><a id="Conclusion-1"></a><a class="docs-heading-anchor-permalink" href="#Conclusion" title="Permalink"></a></h2><p>This tutorial demonstrated how AD enables advanced sampling methods like NUTS for full Bayesian inference with GMRFs.</p><p>In practice, MCMC still quickly becomes prohibitively expensive, so people instead use Integrated Nested Laplace Approximations (INLA). More on this soon.</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../spatiotemporal_modelling/">« Spatiotemporal Modelling with SPDEs</a><a class="docs-footer-nextpage" href="../boundary_conditions/">Boundary Conditions for SPDEs »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.12.0 on <span class="colophon-date" title="Monday 16 June 2025 17:43">Monday 16 June 2025</span>. Using Julia version 1.10.9.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
